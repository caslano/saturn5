// Copyright (C) Vladimir Prus 2003.
// Distributed under the Boost Software License, Version 1.0. (See
// accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)
//
// See http://www.boost.org/libs/graph/vector_property_map.html for
// documentation.
//

#ifndef BOOST_PROPERTY_MAP_PARALLEL_VECTOR_PROPERTY_MAP_HPP_VP_2003_03_04
#define BOOST_PROPERTY_MAP_PARALLEL_VECTOR_PROPERTY_MAP_HPP_VP_2003_03_04

#include <boost/property_map/property_map.hpp>
#include <boost/shared_ptr.hpp>
#include <vector>
#include <boost/property_map/parallel/distributed_property_map.hpp>
#include <boost/property_map/parallel/local_property_map.hpp>

namespace boost {

/** Distributed vector property map.
 *
 * This specialization of @ref vector_property_map builds a
 * distributed vector property map given the local index maps
 * generated by distributed graph types that automatically have index
 * properties. 
 *
 * This specialization is useful when creating external distributed
 * property maps via the same syntax used to create external
 * sequential property maps.
 */
template<typename T, typename ProcessGroup, typename GlobalMap, 
         typename StorageMap>
class vector_property_map<T, 
                          local_property_map<ProcessGroup, GlobalMap,
                                             StorageMap> >
  : public parallel::distributed_property_map<
             ProcessGroup, GlobalMap, vector_property_map<T, StorageMap> >
{
  typedef vector_property_map<T, StorageMap> local_iterator_map;

  typedef parallel::distributed_property_map<ProcessGroup, GlobalMap, 
                                             local_iterator_map> inherited;

  typedef local_property_map<ProcessGroup, GlobalMap, StorageMap> index_map_type;

public:
  vector_property_map(const index_map_type& index = index_map_type())
    : inherited(index.process_group(), index.global(),
                local_iterator_map(index.base())) { }

  vector_property_map(unsigned inital_size, 
                      const index_map_type& index = index_map_type())
    : inherited(index.process_group(),  index.global(),
                local_iterator_map(inital_size, index.base())) { }
};

/** Distributed vector property map.
 *
 * This specialization of @ref vector_property_map builds a
 * distributed vector property map given the local index maps
 * generated by distributed graph types that automatically have index
 * properties. 
 *
 * This specialization is useful when creating external distributed
 * property maps via the same syntax used to create external
 * sequential property maps.
 */
template<typename T, typename ProcessGroup, typename GlobalMap, 
         typename StorageMap>
class vector_property_map<
        T, 
        parallel::distributed_property_map<
          ProcessGroup,
          GlobalMap,
          StorageMap
        >
      > 
  : public parallel::distributed_property_map<
             ProcessGroup, GlobalMap, vector_property_map<T, StorageMap> >
{
  typedef vector_property_map<T, StorageMap> local_iterator_map;

  typedef parallel::distributed_property_map<ProcessGroup, GlobalMap, 
                                             local_iterator_map> inherited;

  typedef parallel::distributed_property_map<ProcessGroup, GlobalMap, 
                                             StorageMap>
    index_map_type;

public:
  vector_property_map(const index_map_type& index = index_map_type())
    : inherited(index.process_group(), index.global(),
                local_iterator_map(index.base())) { }

  vector_property_map(unsigned inital_size, 
                      const index_map_type& index = index_map_type())
    : inherited(index.process_group(), index.global(),
                local_iterator_map(inital_size, index.base())) { }
};

}

#endif // BOOST_PROPERTY_MAP_PARALLEL_VECTOR_PROPERTY_MAP_HPP_VP_2003_03_04

/* vector_property_map.hpp
wSE1EH/8Xe38nkddaS0MpbRCz/U2VoRD+ocKLJ0PqVKrkg1Nd/irTPkRTXe4Wobi/9s0H/MqTpBXsUEBcrccM5K1M99x2JazQfEuovXeheocpOmdA1EfNCfrXY1bRND1/L2L3fKx12lWS3pLlg2adHzmwxnDiFE1hxTmkFKF0hC4ix7GJHglU/ElUgVs2mCHJ4z7FPNU8XCTeKioBBITUfGXKZje7rNHX6DdK1BOvmAuxT86l+IfQfctcXqXIkrnUigS99wbil/Rs9wwe7ucNlK3dwUy5KfMr9hxgzEabYDy23sUYU+JwRB774+KOWKLoqoSnI0pM1qkZf4WSSwzW6RSf9fiEHctYsv8LNKH/yHKPnuaW6RtP9M6wDJukU6XKWxTeYu0poxbpA/LyCJNP804Ks9gkSxVibLbXTAbgKl7jBYpY48xOCP8Ji7QXAv0Y+X5w5UoO3SPP5b+G1EFxPL9P4xYrvTHcsofZiyT/b2Le7l3MeQPPyxpM6MqYnnbKY7l9aMIQMsLHMsGFxiWKyuP5bk/OJaH/iAsvzupx3BYVQLsZ86bMdywy4jh57uMGBJm37yGu6UzY4b7kjPmVQJs+a955FKE+gppmUNl4+pT58x1iVProjkUTXaxj0OaRpb05VFwnYlL1dQN0G3T/7iB0TXb3OKQIjVxilMxZSc5FckBnYr3f9YchQU86eHJl3hyPE+O/pk5FWyf
*/