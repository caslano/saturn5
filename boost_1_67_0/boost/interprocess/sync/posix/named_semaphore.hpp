//////////////////////////////////////////////////////////////////////////////
//
// (C) Copyright Ion Gaztanaga 2005-2012. Distributed under the Boost
// Software License, Version 1.0. (See accompanying file
// LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
// See http://www.boost.org/libs/interprocess for documentation.
//
//////////////////////////////////////////////////////////////////////////////

#ifndef BOOST_INTERPROCESS_POSIX_NAMED_CONDITION_HPP
#define BOOST_INTERPROCESS_POSIX_NAMED_CONDITION_HPP

#ifndef BOOST_CONFIG_HPP
#  include <boost/config.hpp>
#endif
#
#if defined(BOOST_HAS_PRAGMA_ONCE)
#  pragma once
#endif

#include <boost/interprocess/detail/config_begin.hpp>
#include <boost/interprocess/detail/workaround.hpp>

#include <boost/interprocess/sync/posix/semaphore_wrapper.hpp>

namespace boost {
namespace interprocess {

#if !defined(BOOST_INTERPROCESS_DOXYGEN_INVOKED)
namespace ipcdetail{ class interprocess_tester; }
#endif   //#ifndef BOOST_INTERPROCESS_DOXYGEN_INVOKED

namespace ipcdetail {

class posix_named_semaphore
{
   posix_named_semaphore();
   posix_named_semaphore(const posix_named_semaphore&);
   posix_named_semaphore &operator= (const posix_named_semaphore &);

   public:
   posix_named_semaphore
      (create_only_t, const char *name, unsigned int initialCount, const permissions &perm = permissions())
   {  semaphore_open(mp_sem, DoCreate, name, initialCount, perm);   }

   posix_named_semaphore(open_or_create_t, const char *name, unsigned int initialCount, const permissions &perm = permissions())
   {  semaphore_open(mp_sem, DoOpenOrCreate, name, initialCount, perm);   }

   posix_named_semaphore(open_only_t, const char *name)
   {  semaphore_open(mp_sem, DoOpen, name);   }

   ~posix_named_semaphore()
   {
      if(mp_sem != BOOST_INTERPROCESS_POSIX_SEM_FAILED)
         semaphore_close(mp_sem);
   }

   void post()
   {  semaphore_post(mp_sem); }

   void wait()
   {  semaphore_wait(mp_sem); }

   bool try_wait()
   {  return semaphore_try_wait(mp_sem); }

   bool timed_wait(const boost::posix_time::ptime &abs_time)
   {  return semaphore_timed_wait(mp_sem, abs_time); }

   static bool remove(const char *name)
   {  return semaphore_unlink(name);   }

   private:
   friend class ipcdetail::interprocess_tester;
   void dont_close_on_destruction()
   {  mp_sem = BOOST_INTERPROCESS_POSIX_SEM_FAILED; }

   sem_t      *mp_sem;
};

}  //namespace ipcdetail {
}  //namespace interprocess {
}  //namespace boost {

#include <boost/interprocess/detail/config_end.hpp>

#endif   //#ifndef BOOST_INTERPROCESS_POSIX_NAMED_CONDITION_HPP

/* named_semaphore.hpp
d/SenwdrKUxdXxM7iMoDFSVPM4lDrqsSg9RwmcPRSzGBbU8tOCcx5EqJSoiunUEpWpgbdM/SR0T4AJR5k515KtUZBbTuDumG2enK4lswOx3LPVFt37VDV0gCJBshgBNwWO7ZrM8DB7xRWcjEmJuHCM5nKpq78oZgfV2F93IcKRmA/vseuDhwoYdA8MV39BG5il0U8D8BMqcgy1LE0MQACr5kTGXGjBHl5FU7EVdwDwx4cJV3M02QKKcmABQrR4bEN7J9hjK2fJlf/PgQOlf1iV0PNtI/cwCDJDRknCGsUXKLtNJn8Dv037SuADzUXYC7kwuX1RpxdzZvwljEzb7qyx01ghAAcdguKWhX5CkY2zr8+AhQ/Q2olZITE2BpBpBQKAg7bgI6nBkhSRR/osx19ZmkvRH1BYjjdh0ZocSEzZMZl2G9OaMRYoGYZ8jwrvnArKBizpoSUsbHiSCJWHzk6GWFc8HNIYXb1a0h/ntei5IWQikBvFiPGApz0wN46BYjLD4kHMXLYyXJq+WVa6QMBM+zlBz/cuiZeVeLr+8jD5Cy1He6YoAk3s//oaIteNhMOUCOhIiia0vkGJqEOJV+MlZKSM+QKDdnsYATXb5RWzmYakmjBbdpe5zdofDZ0mhUGMIkbiniAnie4GDYwEVQWEdMvbWHOIH0fArCoxQTUBJBB4wp3e88a84yDIo7YyFnkBZbTjlvPyvl71GG6Bj4RnwtxKsgMhLN8/g1rr1VHVvB3GyrKLWJEMzigEL8Yx9+B6Gb59yzJq0A69vNef7pLED9QtNG7vK0fE/5rxFF/2xMTbUVfAq9EC+UQfAHIrmaHwZC3g87zRb5wh7BlhNpAhknwvCMFxQ7MsUEZpTClOW0BA8XJqHcaHqZdFplKB7w4NGvwRQejLAkyGZUPqj8pYaRDvk51X5SfJ359IZV0caXs2SZY0NAlI+RX6INJDzhNI87iFc7FYco5XgKggcp2T015AaL+YEfVmsmzjTAD81Ukx9f5jm31uvyWdf7NgKH2c+3B0viIBtXktRUWyPaxHH5yV2wick2G4KbC51uySwgV7ZacA/clvyO+kgqSFDyP32TxAMMwxDDABTa+iZvKqCS0xTbX8N//o8xZIeW7NB64e2oPHjy/16tXoaKNkXjy5Q4jO3rAp/0zAELPmZIAxzUChEVZbpbY52KxLA/YDYJopQL6p3hhPP3VHuhrk7lTbB1zHmEcaxgdyOz+KC3IcjtfUixp8jJlQCprt8w6ctfQiKYjbL57C0vYG0aogTK/oUAnTjwXw3DPsHyhYABZgPVQ+kGSe5C7m7ezwryWaUHWeI5b6Blm6A1BYj46D4Ck/3XReoVRgbG5NMCILp9zIuS2GMHQBLDCFQtCiNkeB1gs/VRpLor0029QITOqaGAlYdCkuCEaOGes/lmIdgD1hwQH/gDc1xp9nvsmIH/8sl0Hb7+n63r6nTKt0NEAGWMeHF7ZTQrlnGY2eD3iM0CAFRug+8ERaJ7cMk2T41Es6OYgEqy3R7VCaiRQSfKoat/7B4qzYg7AgFqtlPU+eDMmT+R0GUQ6IoUYJEJ0RoqHDG/6bfhEVpVwR24TUb2t/Aa/beJEcEhJYIxZDhk7Y5Bv4+Xby+J/fQ0uKAAuPWJ+vPiMzu1xMfxE7acBxiWG9Hcwt4TW6pwRQa+7EaJII9fJLBgI/iNUUElw0f3oeVYV5rlMeXwi+3Hzn+V4jMrzZt5sObQwGMB+Z7pvuf+/Juoz6LCL1/Y5NR+Vh1lcVj/xfpmNeuHxIKzC7lQRHYJfEYbBcuWI8C8RwiS56WVRYD6BxRhjAvQSYlBkjpHhBniamUwcFl4z+7l23xcb0NTmXnX+9sV6TJKEVGXANuUnUbPfScLDESY7cm974Rdko57xZ4YXFOaAmKEPx5t6Bpnch1kBhiKhe1lv3c4cBo1p8G/2uusNq0TVR/dSBl5m7kEd4D0K1m/Gt/RQEuwP+j1ruLktLB9qkz8bIyc9Y4BifiaYJwNlj3tBS3Es45Fb83PxnDv7FScn8F3nrYpEwh5WNiK+Fsf+16fuh16l1EqOz4bWGvOpktDX0MPb+U6nqk5R2p34AuK4ARQ0NcJaZQdbDNVnOb8OBctr2Fcj/QKWw08tfgKrwwtDmszXuKbSTm6FynRkVtnOWfurnCKbDkWwkjw3RW08I99ioCvVd0G3u/zB8s3MBwkEoIUlEPiOrcJy9FVcD6mlJ1ET+PYdZ+463l7v0W9D+ZdL4W0luEv69CFNF9RNuQzBLigsc8i1GslaoM2q3QaZzuZCdquefF7P01N9m7fwotHeUc++yEMaW44UfyQ3Thdjxjpk6UHERRt/7rxs59RxWkEdJM2OYjnGYgEameuBwWgNayWQZC4SjzJQg7uBsnmSeJSXEyChuhErAMe6mnV4VfVPw4pL697yP8wrIzpvElZkp/lcBVMGcNKKeOSAc1LY2e+ncWiZO4tadRyV6/4z+vKDzneWpRCkSDsbtqh54/zSiPVFlgE+CR0Cy255ze0sS0g9mn5fobfIJ864xSdYG5pKa3hiPYkJgQCjGlmwZPFEUcptZmVPOhddtwyTkexL7lcNHLTYQPcOAXRLgIWHTO1tzP6OH8zoQCCS4pgx93t21h/SzFjdP27dZixnWiSc2yl1+p9fiZRBXQn4KqDuOcK8IUhfYc9U0tRhoCHOw+IiSCwtjfiNVVtWFYmHu6EhXQt2nqFt+cKnMm9HgSaDA5nlyIoY+k/CxeRTu7JdZv+Lvw5X9tKma+9bYRhGqHPoEFGubpXbhYiw2objLtrll0MyI4I9etThWn/kF75/KV4g5mii2j9b0uGxa8t+ezz6qpLWGj6ONQljXB4vWexMMewWDvN33IijkWjRImd7t928fyr0f53tg0uKkQ8ko5JzXd+Soio6QSM22Nf0IllaDEfOjB8VsHuISjJ9W2V/2hyAdCyy6bzR1BHJ9UaQdjcFFtZWEKxxHsfw/oapiiHHrT5CcsoUgyVR4Q6nRQEhmI7jrE96TivDQhwgq15QqMhfg/YO0/oAIHsXPtjo6ApWtn7g0eoEJRVio4NJYrd02oXL2IAVORqyyg+iij4kK5D1u/5wnEgj/bDzHoyoZnB7YviKLv6WuGLXGOmKuUpyuQoZMiFX09diCTH2AcKGRGgiGIMZaWMByYH/EcAM/zPYW9vvT+lmNAD2VubZVM8eQcGnlyhvzp5AF6gCQl+QTYijdX44oqVRIcPBJFIx4cR+aSMFd2kMyuJVe2YwYfCxjoqbbiR5vZMZpQsXF4xeYhLMyzxPY9mv4F9BKs5KSND1K8f6eJISHET3NDAsSjHIHUxh5dr706T9E7p7zlOmnDxAwpreTY9DyYIny2dBkIMrlZCAn+uTx1GcaEHUJnXJC+oo7qBN5VAEns7odAOp6q8RutWwnQnQ3rFaoDBIQfMUSiujHxg6YzAuaQ0L3eFZtF1BEZlm7XjgZP2OPPpwl0vgNSgysXOVyxcgTXRMYaALaK+gowpAbDkraEPkouIkI42SYuWpzNN/qVNd70tS159wqhyfVP3dI/4pxkWsYKMbh4+AuWi6RhYMIHRFJFQOKae8QfDKRqebBkSLycJNLQFrxHR+PQqkCtErIIu9SehV2KriJfXB66Oepqz0IDCIFjpfVwcWJibg9Hc7nVzw+aNFBmX87XScZtjsACqMwAR4S5wZVkFwkpNMNKXtYjQSb3t5W8oGX0k35ZNSNFqVu32lDZEzadSUQvz7kgMgVpoQKOLFdWetXWHibtYLaijNyMPKnoFjA5RY085Syp2rncVM4OcDZ8KSq3aPyFccz4oagrqQ5W3kx8fexI+ijrpVLfltJb6RTtcgLX3gUjM7x/BqP4A/cGAt3B4334fCN+IB+H2D/CApvxcH/LiwNf8caeS+lrDb6D7uVlZHeXd1P88WHxzfPX/g0++rdJuTgFhTIuEio0bRKJWDrJc27r9FzM8fOc43/0Sfz1VB16Lygu9H3XgEtrWWifrCuRSP+kALHZaNeCGhLyP+Z9oVZOvn9UrqaDkoqRgdgLx0KGzVUUkGjk2kztIAlKkxmptDgIVFU9SOnpE9kkjY30RFg7YmFCNVy9cYtPbjXJNsHo0xK8s2KX5MI3TIoCHU/M+rlLtkpgmP8LHyU7YbNNR6lpRgVy9joonqCboP3QGO/KRiYSGHhEajKcLZu29aJzPgWSLdzcgxr1a2wdxsDTokaU4Yo0hfptLCdi8kQPFrVr2E4YVC5aEr6njM1uCZ4EGKVoheXI1QVtBQTihojev6x7shmLZ9SrW285ON5paPKL1aDinOWpG+1Rw3i43jS6kA9Sa/EJRRqMNSZ50LDl4Dw5kUDiKR5JND4pWTACbjIUVu4KVtFIQMBJJTpGScsoMyGB090OWN7fhfbZKw/ZdxxMy9uDEQuQYnhuvKD5loZYgIhddeYHt7Z4fWOhc53oHp18weQmtoam+OgCD3zBJfV6VaYF4xcAUZdnhhn9VlMij+t0Mm1QVLLPXuhVhgcz8LVCbhWjFNnnTYXY8qQTD5pnFgkn2+g8zIqef4/9svcTSVzm2IufnKG0bdvxmzjBHx6qP5W5GsRwmpFygN6TGD/xkMimEtVbYQi6W9o+ZdnlIMcmJwTmX1I4rHSQHt6Vc6IMvMQf/zRDtGZoPrddAeewnUTnd+LRVFrXytW1VICN6sC29T818KO3LBpwbTs+yXTnB2Z/bchjByz3l0AwAvDXsnAzjuO/yy1Pye46Ei06jhkVLe5snVRmGz2KiXfMEN6SZEbhDWoNPk4pr2M8Z7/5nhcx4Lpt31vqw7YMofFoeMjQ1bv8W6YYQixgPSacSRURefbepLd2dL4Il1XEIZl5t2tm5qnQjZFtNLJxO6Vg4O0JnexWgZNjCW1WANLWo0iKhScp3eXL+wEZn2n3sZul7nKrGBtMO1p+6uPW9PG6T6HtmdTotCyFnla9M4iAeqleTSXopRph8XpAhBRusnZmHh6Ly3L7VQbn+31tu2JV9fqaHUV0IqP/JdbbHasOe6MuNX7AAh907Tiz9uEaL/zOY+w60HMGAcLPhXVtlnLv7BcKv4S/5tIX1w/WdWxl6OO9NRyCfqOSGdFyFDnmCrzYg/XsI5nvw/Lz6zAPctuy5tTi0NTDQ+6LZmfQD+1cNO9RDjcp/AyBmUt0U4qvkcJwweTQHNNy17LUv3BgWJElUhUQyzoKNi3zV9h93g7XfTrlhZlQelrUObmvKJbrHvWnFGpRWOZ0+pdKyqKa0Wtc3Uo9sOmWzFRh8ZSRZGh3euw8JUjfNslNXtLkXrCD+J/C7jgLsca7wsuTOCZxBtFjSPOGeZYHmCXHu4kqrezAPsrfVx9fLZ7OnlCgUAbSpvnPjpdbUrUSWUgsqT//c1eLz+1+2KgOEF20vO4sCUFAh1o1W7TWnFQt2TFZErBRyS3Qkojow5ZIdho/BLsmT/ercPyg1zA3M3wher71tQup8rUs7eXjJi9oOHuViln0Gmi0AT7lauvqiJBes2pVHHIuJ2I9aKZF326MD0ujYLeC43d3HIb7r9IgbqjW5s7326XE9vo+t33HtK/YOqtBgcsBtJf1AqKJEQsr5rjp9oOYVxXB8w9Uh6EKdgCCoRCug/BDZvtQHjcBhFLYQKMxdD+fxoe0vTjr/WbNYLI03D2Wxpm1vXI4/wvtdBBQZ9Va1CPiQPozV7vaL1R7Kvfpe8z7HVm9Wt6+gcrKV3fzE7W8L27ZQbambLHGRlTQp/ezufhoGfacivYXHxfij3+CXdzx27VDV/hQxEI4e2Xwnkd4FWjyI0z26dCOkxvB4PwSLOwEZ9ZOv5D+6zdtBeJ+tfaAkgHH/QytnqS/XJDoYnBSm/FXSJc4UxfRqHb96IffKVzxB29ZB07ve/Rsjnuer6WDz1jCYbkySJ5X1S0ONlNdKrhavNDM8UvJMJDvtU8BtbdnC9m9XZn+3NDAUj97VAkrchSmVdCPvd1kqpU0Hgei1026YiyWv0WA+P3xfxmrLcz1ElY2alBH4qAI1NU2Wg3Zfvg0/+vvwsx1TWFVw6RE5H3e052y36+fXKTm7oH3qZdChdis3lJv4hFeLiHaslIXjvHDRjk9b764jPQNj1Gcu3OCZvgr0k3MHmUvf/cg52iu+62UMyJx01t/k3A+dymCT6SpEQKYA+o4CPupLC+7OfffLMzRNV6pfpoP463DhBGpr59yCAKBgH8719Y3ZnQdo1VXykconFOFnbdHBlhS+5KULeIXnHeSSXEfsQnaH029ONCazW43xxRhxitM7qZy1/+FdegPAKpwaeQcHgBkx32yYNQOAXbC3Z/XI92FyS16gdHZKfuLVL9TKkXg09/cl0LbdV6TH0BoEu/fnJO0FIzDHdmndzEVHRIFnjEwgcYYtuj+i01HsaTjAiIR1RYVbtglp3ODvYK7PTrncjlETJhQErBmpWk32L4aziPn2tFC+TKrv19lvMZMkdyY2rc0FwT+bbJkYieDrAhq7NjqwUavHWyBTumte10G8nMW51my+uckZpTmK6T7yeulO4jokZFZj5N1K3YLof1CctLFkPyfoRkucdrC6UUi6eORBX/vSk9XxWQFzR8d3xp9qdgeSDAT2A0TPFevxBgGAThxISCTETDjQiGRQ0JTwhLg07VP854V4O1LyozMAwdUPKc1WoS05i29/Qi6o2m9rleB+JBNmh2WRRmXxnxS16EHn9MAmSbuM8IU5dAWcY0vczFdbzHsJiALEVFMznmkHU+ZdBSHUz5pe+gM4TK0N3Fy9dXwdCwpkShAgn1QKIqdrL6ebizzMaDsn+CybEP1ZmzxHcePt+4v0VdpTvNITVKWTUf8mRPWOKr4dT6K128SP5QViL6W0IEJqj9IMNMMYZxL+46oqPpccyu5FzwwCjYE8t0VJavsIFi4wZ28CvpS66Ks9CVzZ5UPllleWB6gmY4hWF1YcMTCkmIK3ekOjymCrMzZk3tt8NGdp5u5v+FjpLEEHFWO/VFhDU1DvOjZwkQqH4N52pC1OdvM7ajQUJwyyCJzRspDtzXMfsJbqdkYK0CAUmAAbx6gdzNDnpMse7MMCPUpJnxbp1xCBrK+E7O+q5RO4ydyXcVp2ZSTTOSo4BlDsdxGwq/DGah17CJnXVMGMszBhnMH2Sd6LMVCU0iLM6UG4OUFmVJV2sTiDNbsQ2ED5sdT57lvckT4sJvENGFrkJunQP4uOy9RUaMSdHmfNRH29Bb4UuIDgJbc32Imgq5wGyNaOfz6aTQtdIUSyu6gu35JsrG7STP5GNUsXqEHUtRirWHe1KT8duFqGgjia5XorOBo/mhHAKkUmw1Iaw8QaKDPb6XRgCVxWkCoc64njrvSG08uVxlUug5ZHrLlcw9JlYWv3uZAVi7ejSa5vwOHHcwfoTTrQhtnNogD0REmbTGcW8ofnqYJLXjzNIqv/HXxXad7dERjGmB40BA6Oqm3l/Ls2Hc5mfHILKSZsU9HAVY2/5GL3QOyXSZsKpWgsj1ui8cpWbBpqt2jCH8LM+GVLtaY+duUTQ3jsSQuz1NQoDRa5qo1SZLrNwJyW6lPYoSNaCrQ2mkwA111aROJizB/Lwm2VxB1CEPFJE9HMivGT2UIl534AAEs2rpws+2TZLkjabQJbHds0JpRs/obtmYomkTRyh5md+Kengf6Cwu2PimuZsLDZDyGDKae/r/NF1YTZIIjPz1lsL1UG2qfXP64pRq+Dcr90ReIOhFZUVAbUdKSD6KRnys1V8pAKj8bW76xjclXxNBmTw1EkAaWI7LOuUTzAE5yWb8JuSLPn1We5L3S1YvbWZorM8Xb3i0q2eAwG0hKpX2JnKP6Rvu6R21zyvBjlYj+3uytv55PayXippxa0B4skBVlVNtUU4vhhUCSNu64JFTffN8CwjtfCXvoThHb1gZx3YkqQtdPZT7jh7R1CFlnYxKmL88lIexQhImUql1/meTWDT1wwZWLdd8kIKee4IMqo3VLWuioYLfE3TDqO8xuFLFvF+qozVGmY/2bQT22WeNfDliGvRFX00Gni0Hgy5vByhCMel6YEfGqP1ThbGHtVhOyVcRBBVwHbKgUQkMrRZQBETfT8Z/MtBPqRXbhmi5nbUzbf6BREgBbCkeE3IkTxXwAzWEr1fcoqzLQhXger00zlZciZFEyotYc00d0LGqDTDago7T+DJYjcNk4/v+ZMiDPUHRTrSmqaLf0zoawNG6iB53oSLyXB7q/8bUrZEbTAjYlOMvgTwzqaEh1ZON7jj55hdgovtIgX+NTZG+ekhK9W8xCZkpIU0eKyQXY6TuQ+vTofz74eOsPCyHyBBTxLO768hcQQC0pmtVQUNtU0UkBqB7jhdiNtbmAZrcgq9IXGdO6DctcFmdedzcS8EY5O/BCozaay27xrbAZr9T1201IYgUxoCr/DUbFFvvAUxoukVFsMaERYTWbyjRObYgnwKxTpU/ermzPBQ4+OAF420XUMCc1m+dYf/Qt1B7nDh2Knq7TZ4GkPYEpVb+F9NEOT31lFJivETR05pk2ZKB/jz5gWjEWnTkq5JDgm2riZkzw6ZWA1M5mYhAS3wkx07G2v4Wdy6GpOi6FbyZ+qlizlmta9Hcm88dT9EZrFJIcNBUdQ/iGYOHnBWiQCT+arfXFTd0e4gS7FiQdNd24xevJIDM7y2l57Mxt26NhSTUmxAsfsokTwJKqOxhUpm41+W/UzBDuDAmxW3V6vjDzis1nUS2pB3xXucDV4a25uDYnVbNRqDJbjhF4h87savhzOiM0MARgi15vhOWLtGPG0uF8hTqCdtpQAvaz9tK2F8t2Ydt96PKsFP1CT27gpgv9WoXzXlJiMqXgO5xFGlP2GgD41P6KS9Dz48G7AGqdq+T92fL1dtWZiXJO6pJ9lT2YPb3uYgFBrKzuc0SaCMsQ4ke4IwMXrOPzuY5DzheNW+CTJUnyNWqIvTxIzsiFIwLTSFU7Rb1Cmt/7d6VUCXjlWEuJ442TnmRZdiAo2f3QJOcriiBr3LPgtofcboExsHtyC6+XukjtKvE6ihIkyeyR0DB46wLcCalILf3VYmg5RF2oNRgcMRotVuCsuS7JEOa9xeI5JKtuNwLd4Y2KgJ4unJJ/IzD5D5FSLCmLtIKFjzPyLwK0ACCz301nsBvQGPUk=
*/