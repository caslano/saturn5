/*
 * async_handler.hpp
 *
 *  Created on: 12.06.2016
 *      Author: Klemens
 */

#ifndef BOOST_PROCESS_DETAIL_ASYNC_HANDLER_HPP_
#define BOOST_PROCESS_DETAIL_ASYNC_HANDLER_HPP_

#include <type_traits>

#if defined(BOOST_POSIX_API)
#include <boost/process/posix.hpp>
#include <boost/process/detail/posix/async_handler.hpp>
#include <boost/process/detail/posix/asio_fwd.hpp>
#else
#include <boost/process/detail/windows/async_handler.hpp>
#include <boost/process/detail/windows/asio_fwd.hpp>
#endif

namespace boost {

namespace process {

namespace detail {

#if defined(BOOST_POSIX_API)
using ::boost::process::detail::posix::is_async_handler;
using ::boost::process::detail::posix::does_require_io_context;
#else
using ::boost::process::detail::windows::is_async_handler;
using ::boost::process::detail::windows::does_require_io_context;
#endif

template<typename ...Args>
struct has_io_context;

template<typename T, typename ...Args>
struct has_io_context<T, Args...>
{
    typedef typename has_io_context<Args...>::type next;
    typedef typename std::is_same<
                typename std::remove_reference<T>::type,
                boost::asio::io_context>::type is_ios;
    typedef typename std::conditional<is_ios::value,
            std::true_type,
            next>::type type;
};

template<typename T>
struct has_io_context<T>
{
    typedef typename std::is_same<
            typename std::remove_reference<T>::type,
            boost::asio::io_context>::type type;
};

template<typename ...Args>
using has_io_context_t = typename has_io_context<Args...>::type;

template<typename ...Args>
struct has_async_handler;

template<typename T, typename ...Args>
struct has_async_handler<T, Args...>
{
    typedef typename has_async_handler<Args...>::type next;
    typedef typename is_async_handler<T>::type is_ios;
    typedef typename std::conditional<is_ios::value,
            std::true_type,
            next>::type type;
};

template<typename T>
struct has_async_handler<T>
{
    typedef typename is_async_handler<T>::type type;
};

template<typename ...Args>
struct needs_io_context;

template<typename T, typename ...Args>
struct needs_io_context<T, Args...>
{
    typedef typename needs_io_context<Args...>::type next;
    typedef typename does_require_io_context<T>::type is_ios;
    typedef typename std::conditional<is_ios::value,
            std::true_type,
            next>::type type;
};

template<typename T>
struct needs_io_context<T>
{
    typedef typename does_require_io_context<T>::type type;
};

template<typename ...Args>
boost::asio::io_context &get_io_context_var(boost::asio::io_context & f, Args&...)
{
    return f;
}

template<typename First, typename ...Args>
boost::asio::io_context &get_io_context_var(First&, Args&...args)
{
    return get_io_context_var(args...);
}

}
}
}


#endif /* BOOST_PROCESS_DETAIL_ASYNC_HANDLER_HPP_ */

/* async_handler.hpp
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
*/