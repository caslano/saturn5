// Copyright (c) 2006, 2007 Julio M. Merino Vidal
// Copyright (c) 2008 Ilya Sokolov, Boris Schaeling
// Copyright (c) 2009 Boris Schaeling
// Copyright (c) 2010 Felipe Tanus, Boris Schaeling
// Copyright (c) 2011, 2012 Jeff Flinn, Boris Schaeling
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_PROCESS_WINDOWS_SHELL_PATH_HPP
#define BOOST_PROCESS_WINDOWS_SHELL_PATH_HPP

#include <boost/process/detail/config.hpp>
#include <system_error>
#include <boost/filesystem/path.hpp>
#include <boost/winapi/basic_types.hpp>
#include <boost/winapi/get_system_directory.hpp>

namespace boost { namespace process { namespace detail { namespace windows {

inline boost::filesystem::path shell_path()
{
    ::boost::winapi::WCHAR_ sysdir[260];
    unsigned int size = ::boost::winapi::get_system_directory(sysdir, sizeof(sysdir));
    if (!size)
        throw_last_error("GetSystemDirectory() failed");

    boost::filesystem::path p = sysdir;
    return p / "cmd.exe";
}

inline boost::filesystem::path shell_path(std::error_code &ec) noexcept
{

    ::boost::winapi::WCHAR_ sysdir[260];
    unsigned int size = ::boost::winapi::get_system_directory(sysdir, sizeof(sysdir));
    boost::filesystem::path p;
    if (!size)
        ec = std::error_code(
                ::boost::winapi::GetLastError(),
                std::system_category());
    else
    {
        ec.clear();
        p = sysdir;
        p /= "cmd.exe";
    }
    return p;
}

}}}}

#endif

/* shell_path.hpp
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
*/