// Copyright (c) 2016 Klemens D. Morgenstern
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_PROCESS_WINDOWS_ON_EXIT_HPP_
#define BOOST_PROCESS_WINDOWS_ON_EXIT_HPP_

#include <boost/process/detail/config.hpp>
#include <boost/process/detail/handler_base.hpp>
#include <boost/process/detail/windows/async_handler.hpp>
#include <system_error>
#include <functional>

namespace boost { namespace process { namespace detail { namespace windows {

struct on_exit_ : boost::process::detail::windows::async_handler
{
    std::function<void(int, const std::error_code&)> handler;
    on_exit_(const std::function<void(int, const std::error_code&)> & handler) : handler(handler)
    {

    }

    template<typename Executor>
    std::function<void(int, const std::error_code&)> on_exit_handler(Executor&)
    {
        auto handler_ = this->handler;
        return [handler_](int exit_code, const std::error_code & ec)
               {
                    handler_(static_cast<int>(exit_code), ec);
               };

    }
};


}}}}
#endif /* INCLUDE_BOOST_PROCESS_WINDOWS_ON_EXIT_HPP_ */

/* on_exit.hpp
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
*/