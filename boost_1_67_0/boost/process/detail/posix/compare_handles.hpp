// Copyright (c) 2016 Klemens D. Morgenstern
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_PROCESS_DETAIL_POSIX_COMPARE_HANDLES_HPP_
#define BOOST_PROCESS_DETAIL_POSIX_COMPARE_HANDLES_HPP_


#include <boost/process/detail/config.hpp>
#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>

namespace boost { namespace process { namespace detail { namespace posix {


inline bool compare_handles(int lhs, int rhs)
{

    if ((lhs == -1) || (rhs == -1))
        return false;

    if (lhs == rhs)
        return true;

    struct stat stat1, stat2;
    if(fstat(lhs, &stat1) < 0) ::boost::process::detail::throw_last_error("fstat() failed");
    if(fstat(rhs, &stat2) < 0) ::boost::process::detail::throw_last_error("fstat() failed");
    
    return (stat1.st_dev == stat2.st_dev) && (stat1.st_ino == stat2.st_ino);   
}





}}}}



#endif /* BOOST_PROCESS_DETAIL_POSIX_COMPARE_HANDLES_HPP_ */

/* compare_handles.hpp
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
*/