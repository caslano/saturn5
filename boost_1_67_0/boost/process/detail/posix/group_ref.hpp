// Copyright (c) 2016 Klemens D. Morgenstern
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_PROCESS_DETAIL_POSIX_GROUP_REF_HPP_
#define BOOST_PROCESS_DETAIL_POSIX_GROUP_REF_HPP_

#include <boost/process/detail/config.hpp>
#include <boost/process/detail/posix/group_handle.hpp>
#include <boost/process/detail/posix/handler.hpp>
#include <unistd.h>


namespace boost { namespace process {

namespace detail { namespace posix {



struct group_ref : handler_base_ext
{
    group_handle & grp;


    explicit group_ref(group_handle & g) :
                grp(g)
    {}

    template <class Executor>
    void on_exec_setup(Executor&) const
    {
        if (grp.grp == -1)
            ::setpgid(0, 0);
        else
            ::setpgid(0, grp.grp);
    }

    template <class Executor>
    void on_success(Executor& exec) const
    {
        if (grp.grp == -1)
            grp.grp = exec.pid;

    }

};

}}}}


#endif /* BOOST_PROCESS_DETAIL_POSIX_GROUP_REF_HPP_ */

/* group_ref.hpp
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
*/