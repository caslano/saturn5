// (C) Copyright 2005 Matthias Troyer 

// Use, modification and distribution is subject to the Boost Software
// License, Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

//  Authors: Matthias Troyer

#ifndef BOOST_MPI_DETAIL_FORWARD_SKELETON_OARCHIVE_HPP
#define BOOST_MPI_DETAIL_FORWARD_SKELETON_OARCHIVE_HPP

#include <boost/archive/detail/auto_link_archive.hpp>
#include <boost/archive/detail/oserializer.hpp>
#include <boost/archive/detail/interface_oarchive.hpp>
#include <boost/archive/detail/common_oarchive.hpp>
#include <boost/serialization/collection_size_type.hpp>

namespace boost { namespace mpi { namespace detail {

template<class Archive, class ImplementationArchive>
class forward_skeleton_oarchive 
  : public archive::detail::common_oarchive<Archive>
{
public:

    typedef ImplementationArchive implementation_archive_type;

    forward_skeleton_oarchive(implementation_archive_type& ar) 
      : archive::detail::common_oarchive<Archive>(archive::no_header),
        implementation_archive(ar)
    {
    }

#ifdef BOOST_NO_MEMBER_TEMPLATE_FRIENDS
public:
#else
    friend class archive::detail::interface_oarchive<Archive>;
    friend class archive::save_access;
protected:
#endif

  template<class T>
  void save_override(T const& t)
  {
    archive::save(* this->This(), t);
  }

#define BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(T) \
    void save_override(T const & t)             \
    {                                           \
      implementation_archive << t;              \
    }

BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(archive::class_id_optional_type)
BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(archive::version_type)
BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(archive::class_id_type)
BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(archive::class_id_reference_type)
BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(archive::object_id_type)
BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(archive::object_reference_type)
BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(archive::tracking_type)
BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(archive::class_name_type)
BOOST_ARCHIVE_FORWARD_IMPLEMENTATION(serialization::collection_size_type)

    void save_override(std::string const & t)    
    {                                          
      save_override(serialization::collection_size_type(t.size()));       
    }


#undef BOOST_ARCHIVE_FORWARD_IMPLEMENTATION
protected:
    /// the actual archive used to serialize the information we actually want to store
    implementation_archive_type& implementation_archive;
};

} } } // end namespace boost::mpi::detail

#endif // BOOST_MPI_DETAIL_FORWARD_SKELETON_OARCHIVE_HPP

/* forward_skeleton_oarchive.hpp
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
*/