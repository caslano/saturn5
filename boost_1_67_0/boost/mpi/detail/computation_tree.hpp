// Copyright (C) 2005 Douglas Gregor.

// Use, modification and distribution is subject to the Boost Software
// License, Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

// Compute parents, children, levels, etc. to effect a parallel
// computation tree.
#ifndef BOOST_MPI_COMPUTATION_TREE_HPP
#define BOOST_MPI_COMPUTATION_TREE_HPP

namespace boost { namespace mpi { namespace detail {

/**
 * @brief Aids tree-based parallel collective algorithms.
 *
 * Objects of this type
 */
class computation_tree
{
 public:
  computation_tree(int rank, int size, int root, int branching_factor = -1);

  /// Returns the branching factor of the tree.
  int branching_factor() const { return branching_factor_; }

  /// Returns the level in the tree on which this process resides.
  int level() const { return level_; }

  /**
   * Returns the index corresponding to the n^th level of the tree.
   *
   * @param n The level in the tree whose index will be returned.
   */
  int level_index(int n) const;

  /**
   *  @brief Returns the parent of this process.
   *
   *  @returns If this process is the root, returns itself. Otherwise,
   *  returns the process number that is the parent in the computation
   *  tree.
   */
  int parent() const;

  /// Returns the index for the first child of this process.
  int child_begin() const;

  /**
   * @brief The default branching factor within the computation tree.
   *
   * This is the default branching factor for the computation tree, to
   * be used by any computation tree that does not fix the branching
   * factor itself. The default is initialized to 3, but may be
   * changed by the application so long as all processes have the same
   * branching factor.
   */
  static int default_branching_factor;

 protected:
  /// The rank of this process in the computation tree.
  int rank;

  /// The number of processes participating in the computation tree.
  int size;

  /// The process number that is acting as the root in the computation
  /// tree.
  int root;

  /**
   * @brief The branching factor within the computation tree.
   *
   * This is the default number of children that each node in a
   * computation tree will have. This value will be used for
   * collective operations that use tree-based algorithms.
   */
  int branching_factor_;

  /// The level in the tree at which this process resides.
  int level_;
};

} } } // end namespace boost::mpi::detail

#endif // BOOST_MPI_COMPUTATION_TREE_HPP

/* computation_tree.hpp
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
*/