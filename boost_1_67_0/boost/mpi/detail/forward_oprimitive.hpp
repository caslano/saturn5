// (C) Copyright 2005 Matthias Troyer 

// Use, modification and distribution is subject to the Boost Software
// License, Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

//  Authors: Matthias Troyer

#ifndef BOOST_MPI_DETAIL_FORWARD_OPRIMITIVE_HPP
#define BOOST_MPI_DETAIL_FORWARD_OPRIMITIVE_HPP

#include <boost/config.hpp>
#include <boost/serialization/array.hpp>

namespace boost { namespace mpi { namespace detail {

/// @brief a minimal output archive, which forwards saving to another archive
///
/// This class template is designed to use the saving facilities of another
/// output archive (the "implementation archive", whose type is specified by 
/// the template argument, to handle serialization of primitive types, 
/// while serialization for specific types can be overriden independently 
/// of that archive.

template <class ImplementationArchive>
class forward_oprimitive
{
public:

    /// the type of the archive to which the saving of primitive types will be forwarded
    typedef ImplementationArchive implementation_archive_type;
    
    /// the constructor takes a reference to the implementation archive used for saving primitve types
    forward_oprimitive(implementation_archive_type& ar)
     : implementation_archive(ar)
    {}

    /// binary saving is forwarded to the implementation archive
    void save_binary(const void * address, std::size_t count)
    {
      implementation_archive.save_binary(address,count);
    }
    
    /// saving of arrays is forwarded to the implementation archive
    template<class T>
    void save_array(serialization::array_wrapper<T> const& x, unsigned int file_version )
    {
      implementation_archive.save_array(x,file_version);
    }

    typedef typename ImplementationArchive::use_array_optimization use_array_optimization;

#ifndef BOOST_NO_MEMBER_TEMPLATE_FRIENDS
    friend class archive::save_access;
protected:
#else
public:
#endif

    ///  saving of primitives is forwarded to the implementation archive
    template<class T>
    void save(const T & t)
    {
      implementation_archive << t;
    }

private:
    implementation_archive_type& implementation_archive;
};

} } } // end namespace boost::mpi::detail

#endif // BOOST_MPI_DETAIL_FORWARD_OPRIMITIVE_HPP

/* forward_oprimitive.hpp
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
*/