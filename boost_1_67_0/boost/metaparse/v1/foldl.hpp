#ifndef BOOST_METAPARSE_V1_FOLDL_HPP
#define BOOST_METAPARSE_V1_FOLDL_HPP

// Copyright Abel Sinkovics (abel@sinkovics.hu)  2011.
// Distributed under the Boost Software License, Version 1.0.
//    (See accompanying file LICENSE_1_0.txt or copy at
//          http://www.boost.org/LICENSE_1_0.txt)

#include <boost/metaparse/v1/accept.hpp>
#include <boost/metaparse/v1/is_error.hpp>
#include <boost/metaparse/v1/get_position.hpp>
#include <boost/metaparse/v1/get_result.hpp>
#include <boost/metaparse/v1/get_remaining.hpp>

#include <boost/mpl/eval_if.hpp>

namespace boost
{
  namespace metaparse
  {
    namespace v1
    {
      template <class P, class State, class ForwardOp>
      struct foldl
      {
      private:
        template <class Res>
        struct apply_unchecked :
          // foldl never returns error
          // I need to use apply_wrap, and not apply, because apply would
          // build a metafunction class from foldl<P, State, ForwardOp>
          // when ForwardOp is a lambda expression.
          foldl<
            P,
            typename ForwardOp::template apply<
              typename State::type,
              typename get_result<Res>::type
            >,
            ForwardOp
          >::template apply<
            typename get_remaining<Res>::type,
            typename get_position<Res>::type
          >
        {};

        template <class S, class Pos>
        struct next_iteration : accept<typename State::type, S, Pos> {};
      public:
        typedef foldl type;
      
        template <class S, class Pos>
        struct apply :
          boost::mpl::eval_if<
            typename is_error<typename P::template apply<S, Pos> >::type,
            next_iteration<S, Pos>,
            apply_unchecked<typename P::template apply<S, Pos> >
          >
        {};
      };
    }
  }
}

#endif


/* foldl.hpp
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
*/