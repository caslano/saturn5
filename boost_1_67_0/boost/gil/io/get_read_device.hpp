//
// Copyright 2012 Christian Henning
//
// Distributed under the Boost Software License, Version 1.0
// See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt
//
#ifndef BOOST_GIL_IO_GET_READ_DEVICE_HPP
#define BOOST_GIL_IO_GET_READ_DEVICE_HPP

#include <boost/gil/detail/mp11.hpp>
#include <boost/gil/io/device.hpp>
#include <boost/gil/io/path_spec.hpp>

#include <type_traits>

namespace boost { namespace gil {

template< typename T
        , typename FormatTag
        , class Enable = void
        >
struct get_read_device
{};

template <typename Device, typename FormatTag>
struct get_read_device
<
    Device,
    FormatTag,
    typename std::enable_if
    <
        mp11::mp_and
        <
            detail::is_adaptable_input_device<FormatTag, Device>,
            is_format_tag<FormatTag>
        >::value
    >::type
>
{
    using type = typename detail::is_adaptable_input_device
        <
            FormatTag,
            Device
        >::device_type;
};

template <typename String, typename FormatTag>
struct get_read_device
<
    String,
    FormatTag,
    typename std::enable_if
    <
        mp11::mp_and
        <
            detail::is_supported_path_spec<String>,
            is_format_tag<FormatTag>
        >::value
    >::type
>
{
    using type = detail::file_stream_device<FormatTag>;
};

} // namespace gil
} // namespace boost

#endif

/* get_read_device.hpp
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
*/