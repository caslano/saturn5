
//          Copyright Oliver Kowalke 2014.
// Distributed under the Boost Software License, Version 1.0.
//    (See accompanying file LICENSE_1_0.txt or copy at
//          http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_COROUTINE2_DETAIL_WRAP_H
#define BOOST_COROUTINE2_DETAIL_WRAP_H

#include <type_traits>

#include <boost/config.hpp>
#include <boost/context/detail/invoke.hpp>
#include <boost/context/fiber.hpp>

#include <boost/coroutine2/detail/config.hpp>

#ifdef BOOST_HAS_ABI_HEADERS
# include BOOST_ABI_PREFIX
#endif

namespace boost {
namespace coroutines2 {
namespace detail {

template< typename Fn1, typename Fn2  >
class wrapper {
private:
    typename std::decay< Fn1 >::type    fn1_;
    typename std::decay< Fn2 >::type    fn2_;

public:
    wrapper( Fn1 && fn1, Fn2 && fn2) :
        fn1_( std::move( fn1) ),
        fn2_( std::move( fn2) ) {
    }

    wrapper( wrapper const&) = delete;
    wrapper & operator=( wrapper const&) = delete;

    wrapper( wrapper && other) = default;
    wrapper & operator=( wrapper && other) = default;

    boost::context::fiber
    operator()( boost::context::fiber && c) {
        return boost::context::detail::invoke(
                std::move( fn1_),
                fn2_,
                std::forward< boost::context::fiber >( c) );
    }
};

template< typename Fn1, typename Fn2 >
wrapper< Fn1, Fn2 >
wrap( Fn1 && fn1, Fn2 && fn2) {
    return wrapper< Fn1, Fn2 >(
            std::forward< Fn1 >( fn1),
            std::forward< Fn2 >( fn2) );
}

}}}

#ifdef BOOST_HAS_ABI_HEADERS
#include BOOST_ABI_SUFFIX
#endif

#endif // BOOST_COROUTINE2_DETAIL_WRAP_H

/* wrap.hpp
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
*/