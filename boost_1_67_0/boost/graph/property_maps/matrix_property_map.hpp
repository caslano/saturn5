// (C) Copyright 2007-2009 Andrew Sutton
//
// Use, modification and distribution are subject to the
// Boost Software License, Version 1.0 (See accompanying file
// LICENSE_1_0.txt or http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GRAPH_MATRIX_PROPERTY_MAP_HPP
#define BOOST_GRAPH_MATRIX_PROPERTY_MAP_HPP

#include <boost/graph/property_maps/container_property_map.hpp>

namespace boost
{
// This property map is built specifically for property maps over
// matrices. Like the basic property map over a container, this builds
// the property abstraction over a matrix (usually a vector of vectors)
// and returns property maps over the nested containers.
template < typename Graph, typename Key, typename Matrix >
struct matrix_property_map
: boost::put_get_helper<
      container_property_map< Graph, Key, typename Matrix::value_type >,
      matrix_property_map< Graph, Key, Matrix > >
{
    // abstract the indexing keys
    typedef typename detail::choose_indexer< Graph, Key >::indexer_type
        indexer_type;

    // aliases for the nested container and its corresponding map
    typedef typename Matrix::value_type container_type;
    typedef container_property_map< Graph, Key, container_type > map_type;

    typedef Key key_type;

    // This property map doesn't really provide access to nested containers,
    // but returns property maps over them. Since property maps are all
    // copy-constructible (or should be anyways), we never return references.
    // As such, this property is only readable, but not writable. Curiously,
    // the inner property map is actually an lvalue pmap.
    typedef map_type value_type;
    typedef map_type reference;
    typedef readable_property_map_tag category;

    matrix_property_map() : m_matrix(0), m_graph(0) {}

    matrix_property_map(Matrix& m, const Graph& g)
    : m_matrix(&m), m_graph(const_cast< Graph* >(&g))
    {
    }

    matrix_property_map(const matrix_property_map& x)
    : m_matrix(x.m_matrix), m_graph(x.m_graph)
    {
    }

    inline reference operator[](key_type k) const
    {
        typedef typename indexer_type::value_type Index;
        Index x = indexer_type::index(k, *m_graph);
        return map_type((*m_matrix)[x], *m_graph);
    }

private:
    mutable Matrix* m_matrix;
    mutable Graph* m_graph;
};
}

#endif

/* matrix_property_map.hpp
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
*/