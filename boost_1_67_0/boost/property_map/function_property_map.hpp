//
//=======================================================================
// Author: Philipp Moeller
//
// Copyright 2012, Philipp Moeller
//
// Distributed under the Boost Software License, Version 1.0. (See
// accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)
//=======================================================================
//

#ifndef BOOST_PROPERTY_MAP_FUNCTION_PROPERTY_MAP_HPP
#define BOOST_PROPERTY_MAP_FUNCTION_PROPERTY_MAP_HPP

#include <boost/config.hpp>
#include <boost/property_map/property_map.hpp>
#include <boost/type_traits.hpp>
#include <boost/utility/result_of.hpp>
#include <boost/mpl/and.hpp>
#include <boost/mpl/not.hpp>
#include <utility>

namespace boost {

template<typename Func, typename Key, typename Ret = typename boost::result_of<const Func(const Key&)>::type>
class function_property_map: public put_get_helper<Ret, function_property_map<Func, Key, Ret> > {
  public:
  typedef Key key_type;
  typedef Ret reference;
  typedef typename boost::remove_cv<typename boost::remove_reference<Ret>::type>::type value_type;

  typedef typename boost::mpl::if_<
                     boost::mpl::and_<
                       boost::is_reference<Ret>,
                       boost::mpl::not_<boost::is_const<Ret> >
                     >,
                     boost::lvalue_property_map_tag,
                     boost::readable_property_map_tag>::type
    category;

  function_property_map(Func f = Func()) : f(f) {}

  reference operator[](const Key& k) const {
    return f(k);
  }

  private:
  Func f;
};

template<typename Key, typename Func>
function_property_map<Func, Key>
make_function_property_map(const Func& f) {
  return function_property_map<Func, Key>(f);
}

template<typename Key, typename Ret, typename Func>
function_property_map<Func, Key, Ret>
make_function_property_map(const Func& f) {
  return function_property_map<Func, Key, Ret>(f);
}

} // boost

#endif /* BOOST_PROPERTY_MAP_FUNCTION_PROPERTY_MAP_HPP */

/* function_property_map.hpp
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
*/