/* Boost interval/detail/sparc_rounding_control.hpp file
 *
 * Copyright 2000 Jens Maurer
 * Copyright 2002 Hervé Brönnimann, Guillaume Melquiond, Sylvain Pion
 *
 * Distributed under the Boost Software License, Version 1.0.
 * (See accompanying file LICENSE_1_0.txt or
 * copy at http://www.boost.org/LICENSE_1_0.txt)
 *
 * The basic code in this file was kindly provided by Jeremy Siek.
 */

#ifndef BOOST_NUMERIC_INTERVAL_DETAIL_SPARC_ROUNDING_CONTROL_HPP
#define BOOST_NUMERIC_INTERVAL_DETAIL_SPARC_ROUNDING_CONTROL_HPP

#if !defined(sparc) && !defined(__sparc__)
#  error This header is only intended for SPARC CPUs.
#endif

#ifdef __SUNPRO_CC
#  include <ieeefp.h>
#endif


namespace boost {
namespace numeric {
namespace interval_lib {
namespace detail {

struct sparc_rounding_control
{
  typedef unsigned int rounding_mode;

  static void set_rounding_mode(const rounding_mode& mode)
  {
#   if defined(__GNUC__)
    __asm__ __volatile__("ld %0, %%fsr" : : "m"(mode));
#   elif defined (__SUNPRO_CC)
    fpsetround(fp_rnd(mode));
#   elif defined(__KCC)
    asm("sethi %hi(mode), %o1");
    asm("ld [%o1+%lo(mode)], %fsr");
#   else
#     error Unsupported compiler for Sparc rounding control.
#   endif
  }

  static void get_rounding_mode(rounding_mode& mode)
  {
#   if defined(__GNUC__)
    __asm__ __volatile__("st %%fsr, %0" : "=m"(mode));
#   elif defined (__SUNPRO_CC)
    mode = fpgetround();
#   elif defined(__KCC)
#     error KCC on Sun SPARC get_round_mode: please fix me
    asm("st %fsr, [mode]");
#   else
#     error Unsupported compiler for Sparc rounding control.
#   endif
  }

#if defined(__SUNPRO_CC)
  static void downward()    { set_rounding_mode(FP_RM); }
  static void upward()      { set_rounding_mode(FP_RP); }
  static void to_nearest()  { set_rounding_mode(FP_RN); }
  static void toward_zero() { set_rounding_mode(FP_RZ); }
#else
  static void downward()    { set_rounding_mode(0xc0000000); }
  static void upward()      { set_rounding_mode(0x80000000); }
  static void to_nearest()  { set_rounding_mode(0x00000000); }
  static void toward_zero() { set_rounding_mode(0x40000000); }
#endif
};

} // namespace detail

extern "C" {
  float rintf(float);
  double rint(double);
}

template<>
struct rounding_control<float>:
  detail::sparc_rounding_control
{
  static const float& force_rounding(const float& x) { return x; }
  static float to_int(const float& x) { return rintf(x); }
};

template<>
struct rounding_control<double>:
  detail::sparc_rounding_control
{
  static const double& force_rounding(const double& x) { return x; }
  static double to_int(const double& x) { return rint(x); }
};

template<>
struct rounding_control<long double>:
  detail::sparc_rounding_control
{
  static const long double& force_rounding(const long double& x) { return x; }
  static long double to_int(const long double& x) { return rint(x); }
};

} // namespace interval_lib
} // namespace numeric
} // namespace boost

#undef BOOST_NUMERIC_INTERVAL_NO_HARDWARE

#endif /* BOOST_NUMERIC_INTERVAL_DETAIL_SPARC_ROUNDING_CONTROL_HPP */

/* sparc_rounding_control.hpp
cdUOt+1MpAEqVrcrJrxHCJtwOs4cAfnFBwmrVGcImboMWv6kQ+5wXpuK5hcOR+1K4xw23JS2Fyl9aae+2xNp/VEaikZpb++t9qDWEdUTue2D7GfLMJi077n8+Hk8wASOvpX5u7LyMDI+Pl6mmsiMTHFJDPF1Y939uTznhvzL3Oplg31X8tF9GZZfSSDdAgjWCRjAucCW8mC3FZtUOe65WwgajpIK5u1T2DYiyd9vxRnVksh/fYDvCJEYa3iZKdCGiZH74zeK2iAxmXV10tt/OCjasqfdtEysk23ppXp2a9pi4aMSrQ181pyuz2VYd7eVRxbprFmQXxPrS1CcnncnAFGnUHF/TAeyLnNIVr4+jU/ieA306Wfd+zER23TbZdyWYH9jxH1cE5c7SImZZNM/glK2USq5RvXgFaXTAN7xO7twJInwURDhFcjIKldo1pYNbgdD2MUJqdQYCZraWK1qw3h4baFxk9bCxlfxpRChvN165s80N9xqs+xcRjjxUH5x10AaGvY3F/SrQS9hLgFYb+XuJsSglo6O5TfZYgG/5jNbf+3bwJyoJR9IoUHwVWFS6aD76yY/yx0YcWrR/gYIybGY2e5iFJmEkyt/1kBFoOAtTtVO804X4WH+OZFoVcE2kzGJBUg7wJWl471E93OkuvWXPyUxzcrU1xEKF4POv8lHYaePLGBPALSt9PKkj+sF/kstByFkGjORVuVCpjkeYsuMIyDWH8xRxXjWmNmXMPg1DVPMGZ82tS3SqJI67GPzBeAwmeWljNcQ1UNZ/lo1C1NfyRivZEvz3IHhjGgemxKhkSy56epa8HNPkPLgB7E2+7Xcs/qkAMLqWLLjFmNDHkPBWeee5zYFU6EXuISLLUlBPBFOfLSVzXngf6FrXwkl1ccdeETyhea//+bleMVPp5NVrOoaQ/JOxYJx6ZaZ/US2O34gOs0a+gm+PHlkamr6wMnJubuHyTK5x8YFifvYxE6tqlAA4oTlRIISHlZ69R3PPHXDgNzndEXl46CQ7wnqSRY4UHvucQgCSNAFNxCnbict6YVzSCwxf/GITMr3KcIj4ZDbwH+v1Z7HO0X1ccT1OhiPnt+/QGIaz2VTOlZa7pryvrBGnAznswJtOb6VDFnM1KHO3COr9MrEJGGhAefOxV8OfrAJU5M4aRy3fL2scB7Y/OAUDr2/vFEi1xoESs8K30QGJibcdNJ7rkremZ6teT7Etsq8hw2Ast5kb5tu3/0x50HLEDoFJV/xjd99wm1z44LHZXzi8QR9tAKPjHa6fV6znzEaAUgvJtpDWBJD3vP4j1Xuv2rKqxoOLZYWrv6cqZPx5e3BE5zLyaPkjNKI5Wrwz9wdnbG2NNCbTUDtyckGBD3175915s5N8yn6C1gqEGhtzZ46f73IjLNsznEB2PPyla9UduKVxgPLgPvJ/bszREMgORZqpIykDUNl+AFFpYzJxRJxRGEU9Xz8w3K7MT/0VDGXN/olvpvG7TT0rwP/Bi5i6hdVe3OsdkKcKYNn/9XazPh/8Hp3GFcu2vHncHS/qqx9SxFH8H86zacJONhb+injHWuG6SIem4xxAa8jofk/fbaEwJorCdhn7mMovcwAkH9BbHjJXBA8Y/Oz7q/mbkflD2QbCc8V6OexySJLf00dC3jwfz2yljjkYPYoAPWYaBYftjVlQJ5YXfGpkcbkr6mlglkC3ayRnemEILvcRLDznD65a6bHeaxPstPSGAQ24FQvB2IelZJbHpdcE/A6e0Bn79yo+OcVFGyuXlx4WJjv+dX9Up951IvTS7ApAam4Dj4fjf3earHMI7zRcmYgrkGKT+Pb8Oavr+vgiBpeVsLXIryspGovleKRJ4ufDCgZfZRGvpCmvvAruMzCRK/YQXWAw+TTPLxHfz+SaZB+/4uTvw+mT8gfxScyULasVBkfjCvG668cN/SXD8+wa1rRFoDNQpqcDCkc6CTbUN6/7gI7dQfaobWDoF70qijKLT6r9/tCynx5rcDXrnVAnVSOAmoEZWovjTa52JY1/yo3/R420mULFsoRBT5yAvQAHi3KNQ8CHuGWUzxHrI4jT15cOLxsLGCDxPzmsUs1e53PvRp17ImbNePbi7ryIbdHe8IM1aFXdGDDUxp4yD5N2q9fOQuLi1UBeydrOWL/cKxdLvb3S4dGR0e/7z9xdopVTmSd81uAMaFrmQ2V3YJkexMrIzkQhhuParJZlHbq6EoKSLc04ig+bGZ5KJzFaDQwfH22ouveS/Eneo1bG6Yw6yfn381CnBHiMPJUBQFs8jmt0822p99LPHFEf1Hn11Sbdu5Y/mT8g9P5hyZ18+p3eVaaD3nyOHz9tAxbUoM00p7Vng02QzTHdTI5dMs2iUPMiW5bdTJbPT7OccSDxbiKigW7idzRPyo/ffzz07up4pM/LAhyW6vf4Rx1pPhnPNmcmPzTOCMCLg1BZJ8hB5OjaoUJlIhHxE/e5YNYn9iA9DUaS5JJdJ68HvYUfodXr4Y3DA4barprv9KXdhKjkA55d4+Q+Idth85mALHwxAflDJzsyUinXomelhWo3Ltx3IF0bdC9efJ0YbfzCzT7CHzxeZ513rRBkPxxbDo7jOsR+6DU27hmgpmr2KhmfPyAx9/p4/Y96Kd0DfDdPrLR8zxd5+aT/yNBISUmEyfDcNY3HoVAd7VY9MtCri6FOe7b0NUdHQGQ3zVzdCCLd0zuHasWXEy+N6M/eZRygai7eDocGFaO6KaX5SROy9i546xDKR1dQG7PWBFO5RME4FLwNUyXmZW41vZU0WOSOXXnROnjBkSX5zRSXUZe8ly9kZpFcdnELa/wQbBd+0VBDScBm+rrg27dtwx6angf3uH9E5z7rSWZVJadKUQ1/JxJXIv30pQPvGtZLoVnw1REjDN27ER1hfQZhgsINMgt59bsBNjlyACt1FghXLC+XmIYBE64jegPYklTa1ec5fkHZ9vtyAiIDrRo70EZZtLaQHnYV3iT4IT7XoT44kTni4RT+kb49ovvZn5Rrp87aVshUuBJsBOLi665K2b0sRFOcXHx7802NE9L2n4NJlE08/Hx3QBhi/bgeXsiX+L0+bDrK/bTRhINkiY2ezRnVctO04lZ5hyby1lD0rRPz48umgEuWH7nutdCPJ4OFzL02zrrb2e3vJuJx41pL9h1PB7LzI7sV8jEAFSf4pqV0TpqcDCpDakR5qb9fCeZFD6S4JxFwDj0VpVkEEeC1nWvS8qv1XvuAXwLls5fdxaMXBD4a2hfYxEniO6X9aipq/ED0drIPf8AZHU8zrU5DXhxCH9xGYR57cVnPLq7adxX6ql3L4ha3kU1v49qjKI9j8J/hsi+ebTkGOdQ/brbzDyq/V+KYNHpYDMYjPdEChjlU21mdiGzm8uXuzWwCLSy2ri/vznasvcLUvaSJ/sOZmRm3jUq1MoR+gunvsphzxFtN5EUDLDDCo8W2HzxD3suNNfVNLKwI4eTaYFYfRKi+6PFAiEd67jByjjK1jpBcL5A0mfy9TGq/vm3HMkY5oCnB91CRDMl7Me7wq+FBVeyosndqFVMEp1EV35rgjKjM3RAzZFn9B5ATftcxy+mnLA7Iyy5vsQ6MBl5WXpQcivNyFUZ7nNrC3bYi03zAnMLdgjXaYCtht6XFR9yePbrLwkaIAEKxGuVUi2ELZHfZyL/59eiUftfY87nCc6X4h0qRfJQVYqpL+mKIkktz4oRHhemaJYB2TOqnVzhPUAupCVIM7CZKwfvvTqa/Vm0dEdr68LtxRALugQAkDh7smNUODuDbe7TuWqczhR+sEDi0hXbZDnUAO1NztZWYGeqzREPFrsCRn/tU9CPdevO5+x20fxecotvrJ6yUaOmYP/x1YE8vaLXAa27nWUtG2HyIO/bzHryC8aSyuyQgzVTFxbIcj96efrXZ2JL2CLc8yUN5Ydmrlz7XVGY8r9HXzKCNlG4iNd1mNdXRNelL/PUT7ZO2yuiNZeIO/UuI+iJDSB8wcC9/WN0HZSXY4Y7f+hFfqH59xqV4L1U8uqvHH5gbLxmufdtaPPH2RktnQYW36B3e0MWJZBrPRYHCwq5PjHAahFOIOCuu7tbj0bAvJLtFG0mB86yJ76lSwYwH2fPhajTlOhmNWnbBDetz9qfqvY6MVhqoOmc7/B0v16SjcYTlP4iLZxMjcI1eXYg/9p4LCG/kJ0qe/Zgv3pEvpafMOhGP9A7Qpgpxcyv9X0Xctk+Cv3SkxcnCffBMTVIzi0jyBrAPfgwEFXU9RpOg/vZ2qLYPLeVCwa5eTlzNIZZ7DJ1cgOzf5LOeLYRo6/RrwYl9S8B4V/Bim0WCq3KCqXvinMsilcE8qs+KXo2BUe8x054zaH1HBRaxXAacn+PW+VmQYCQRHeqpsqBw76id3xPEy1a/mFXu4s/LDw8BC5GsgBuTYIGgz2x91SRcXkCfeeOMz//+C2E27oQa8yHKtWg8AcbV2uzNbozI/pKySisDH6sC3L1maWG7v6wOf/1J7/qNRNKL+PcQHdxeiTsyj3jEkl1eFaj8btRRqYSO01luOElxXjErYR5HPyJnRxvCrUO8atUONVlYLi0xZQ0UMUm97L3NWJ69dUd6P1xRZGQfvarO9m6M4MR+EdrixcwzO5PjoVyrYJCmnoElK3HhCP/IBXfvi34gxDVck4naQ36FmAKEunaRAzK8axRTEpq3SNZ+NOcbKThQzXLU6GWgrdhhDT86XK362HAWYjAHirZPv4auWUxB0EvbO6t3ThKmgPuAS6acTfrNMvzfUntFAPh0dzkCXmKWhGrqaGSR0KtMdN/DX8kDP775js6TeYy0vNnmh0gym71RYOTiZU4XdCK7dWzBr/+et2x63H0Q95kJ+NWjmPCQu7sggH3WcX1jX7Xq4uaZ2hJBGc8gsBOzrK3NLd8ldIGal+w4tYr3/B+raZgqOrDqcF6xc+Nsl8b1WS68F/YATkI2QugQISUJg/IoHL23plUbouOhWWvoXPT/nawRuAPTnZ2NpSNKWnf50APM3y5DLU1K3xMvntLVCLGnrVbLCy9sf9lrBq3OzYtZuTL93Ej3D8TCkzfKfyUoJr9pT9D/acA6me6nDmEfLDW7/1jlXEpe6EpgzJUrW4Ws6/W7r+THb1FmgrtNs2TBYDKZ51z32dA3x5nRgVQeLixn9pQ2UDf+kHfgtwK0DUZC2Ip8Ez3JftBnQqCMD7OeOQaLlW21pMTr6fGx6/ptd5tI5/9I3Ue/DU0X8B+00YFNUD65cpOa7cBAZrOxXI5iK35mG/BEIHczMyxP9AaiysU25p2KYR+AIaoySE5XytaLoNXg2NhrwhqXPxpBVwNK7705OyhqdtUzfN5k0KfCT35XIQj472G0Mub2DClFXSAnFJHPHdxW4sSYKEA4Ex6EaYfUQmpdj34jcI8g8YkgBl+AJmWYziwG5AoMRiUliEt92kL2zMuSK7BjfPMHjaRipjYRto9ZpjYZz+DS+k3zr1yKP+xUZ5kxSMeyqet43a1Etbq7bWBDoS0ZCLaoHsg9OFsBdquZTk3ag9120Qvue7dcfbfW08vdqGz9kSGeLdwzfkQkyoD5Mi39a6jfW8qK7gckMZkRKpFto66BjnNMay1EAFreS14AhlYnAw8qYxvAym6JK5lYEEWdm1mTKKET1Q0fPDTD9g19395VEf6Bxzu+WmemZ6hbR8yPu+WRN8duHrGIV13oYogNzZY2SPqTajisadRdBDhDoCQ3ZwQ15h33+m13qlYYd+X0Bot5QazF2cGOiYf1CRh88ancgxVbTsBXUywm0Vm1P3UlG7f71sN4IPxZyZ3yWz45Pg4YzGz5btcofVNuaOjyQf/DqIalS40KmDfrap/jQaUOJEIxOEy98eaCAdG6szyazTnduuzsth3aFkXvSBVUOVnP30U50+Ufk4vtMi5HmfRn0ESDdIa1OeiqdnRc4PcmY/d2VVZjwt4AikQW9gVn2yYPsUjk715tFqMyL80fThtYZ1xVnArfJLNT7jExOnrpC/yqcz94yu1+0XOzvPCJvdYKYMH1B3AU3vwSER6Wg7zaOIE/DJ4uJ/eDanR1ta+2svI2iHqBvVJdgtHPkj5+XxbD/qOQ2L4jHmorBAagbjlcBhFY9+/8mY9HlbMe43HFsDMfsMltKITlczJoZL5JC5AOQ7xPK5lZIbC/WX6vo4Q3XpT4NVXJNsVRfanqkGcN3FfjpcF34v+c+WAuaQiqvADqvbdmtkXbJVbdpF2o0g733JN9+wP+YxyUROJVQN1J9C+Gx+o+QViN6AKaM61g4LSEkWAjShyDxItfOTxbh++/sNGSaeQmzNsiyqeEvtWBc/n34DWtY66+5PwqDIgedIHbJRMvmRPagAMsDgacl7IYF62P5YqW4Qp7ttVlbeZj4kC3hK1qNHCXtHe6DaV0Trt2fvW5QB43VMgR+NXPAGynmfziwKY8FP4v00pdygiB5fn0TbShQQzX4TpyzVK+fm71bWrpmESE9o+Vbddl/65sst9/gzxKtNbbXKA1S9M610Denp60k6UqOtpbWBNrsVkrtsgJP+THp6hgWvFvlOJamDtnmtIuydTatp8T+eWVKn6ctxaPS/RDL2gjn1/np78wgv2f9xsm8nkLp/Ibi6FAygigjhdmNzS56/KWlg2As/A0XcJ7P58BeDEjzMGb9vAUV+B5Ir9ALfCn1/BVCc31L4jiMzyCXeDDI/zn1wjCDAB8PMlHxpp8Y3l+k4WNM8SdE0OtLMQ+S+8rM6EHB8f18THxZ3HKaynaMveZYNa0nPZLmVnOgpw9NVphqZ0MYE/gDn0+p8kvv7Pd3Ih6Ilvj52eXM9G48+q47fZEolw0zp/ENrXJf/yJjntShLgLCNw2MD+/g51XT+f65r4MRUlvc3DCYsdgWcg2a2hEfwtxIASKpAkj/RveKZuejspRO5ec/sUkFo/ekNVV7MHmDOYNC7qQP/IzESo/Zes5PD+69NUZTHz9m9lP7+tg78x/bUnuWmb+V9Knv1D9+3jaZgXXIl7Acb6tUUW36RXpdEwMb9D5a129vccfzqFtFDZlhiQCsW9zMPDZEHVDrF/W01JIPT9gDn4GG61Cfhr8vaYhmNG41iMKr8iP8ofwBBIwvPbqdKhsjnv34/YKgZQeBp6w9zUPMvwArGOGApoXETcyUb0bShdrLCAUSvfgnkwpWFXa+t+p99gMJzWE+rf8m196Sfhvs+LPo0gBdgvvCTQHXYUIjdCT1MxT0XFPju02p9qVYvCn+F2setJDyfhzdWnzeUIshsY0ngg/Wy+VUAlKQhcJj4IqvivOcaOGUEVu8gAC8PEPRYT9d9slbfQ6rOWv/b3kFw5KGZNR5zx1aBx3Qm3NWXw/vvcyImZi3PKR0p+es2HfCVbrWhLSvz1hygyIbW9oce9BlEObyrbLVnpfowrvC4kMg2posiwS/YiscJZ/MD5Nzyu1z21W2Ws1mm++sSYjqO17g/n4LnSc1yqr9KQjlVbtmeWuSfi2l+vvAmPT5av/U49ITJ7pndB3/axILrT0szaCgEBiM8fbYIZvSrNPoI38+dCcpVkYbd0xoGs2aKWyh+kq/x4kkFG4CzeXUZmlfIHbw5kbVBKM7AFaM/PZGnhxrfVJEN63hWw7dQpp/NbG+F97Q5+ngij3NNdbJaOR9N9IXz5xZGRDprpN3SUxrAH8DIvgZ6daWhqav59l5DLqtKY197uX798Mgl23+h9cWy0augkwitJRqJzsqbt0FcwJELcvTh0QFj89xcvzs/M5IaG6L1LTdtFUAYMkKb+s7MaDyIEsTnuW0iGgMUu/OVyZcDRe0EUJ6+sT4XR4AfpsL2g6zdRJTp/VwVObRJZcmmAWvOVn46eZV+fU/XnkZz7+ATa2HBMCkezJvxxjD9HMjswdTP3n8TNzQlmly6pSajnFokgDU8qs+HQLDUGOa18s+W466ALu1cCk39ifpi6AFqcVQMh/fOnurrWBZfMp2lUGY1tYEGx2N0J31BzoLdItvT1jeZZUIW9ztHzj9PQv391qlPMzUNp57GvBeyZblNlPDrKheRNCUUjD01jpTbO5eOaPav0gcNvB31y2PuO65bapNRTOB1k8JNaOpbjvGQSrX0DKU6sJrfaTTKvOvwsmifePpHIaLTcffxb5kXCU2Ea2B3SgTlcDq9fO8ltAIRO2962PdjgoRWSDF6xThsLv9KYLKPH2W7K+6W500rSRtKYzaGqib1TrFWQapToEIRP3SWdUP+Jv/hHzZyTZG1F5FWX6tQvr8YlwbQfxTKVHnKeF88dZZb/7cFD7FUnqG4ha/sWsQM/KlOWmHvwZ7AbFqV/d508RU0ipsCMfgPlcw6t39Yf7t58zeb+I/DvWZNn4lQhnqgqC+9vLadfArYWSe9zq7Tyrz+76Rxm7b2TE024Hg/oR8j+Fgvp5cuRhTIw4wNYcrEB3pLZdtnXl8/i3JnkXYWA8x45I9pdTkR5BAvoUBLWBNlGSfeclRLeRq8dQmOgVuVBcl9iYI5B7sFuB8h+HPiF6GQ4p+ZE6HoPsC63GTRcA7sLZDvYedGa+Q0LOcZEgucYf6gfH1IuSq/FdC4O19uZa3np6froz4sBvVEem4O++c2XNlqPTngC037Tl98HsUgzwO50piGSvk2Njd8ibgE9q6U4w3zVNTUWZES4LpU48+Qc+nuZIei+fBza4Q0ZBtfiYHiRt/K4JSuKfzfo+rOBKPLh+IkkpgVkTK011dX8i2dwA2X2ZKfzwfJdsiPbjxbB83WS6wLrLjMAbgSARQ4Rtol4EurKtO6RuOqay4T/+FVHeztKhT+/XFQxXoH3CGtN6poI0gtCxyw6A7QCwfLnYEnB8uLi3YHd3d1sJiYmYNmK9TZ1r1wFyLauP2j7LcckNtK6pkGLq0nmUQ+fV7ddwwv/rjX2uRCeqAzs1gItTupv8rOwUMTf4OLiYj1JzPwhW0kmYZQN9H3tWRI8j52mj/56+yjLjXpCMhiOC310xvI0nJ8hfnDkv3aCvoTMOjLtXfi654y4lQ9iSXwrzcabT9Km1FxRrSQVkjvJ+tYho4Rp5V8gU2lpqe/Mibebpdvqn6+xdW5YIOUwku7E0iXmfl7DhuP/9RFRKQlrS7oXa+zd3FMmeWbyXZNtqrIG4TofwRkcuHLWozbZDfdb+PGx838=
*/