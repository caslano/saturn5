/* Boost interval/detail/x86_rounding_control.hpp file
 *
 * Copyright 2000 Jens Maurer
 * Copyright 2002 Hervé Brönnimann, Guillaume Melquiond, Sylvain Pion
 *
 * Distributed under the Boost Software License, Version 1.0.
 * (See accompanying file LICENSE_1_0.txt or
 * copy at http://www.boost.org/LICENSE_1_0.txt)
 */

#ifndef BOOST_NUMERIC_INTERVAL_DETAIL_X86_ROUNDING_CONTROL_HPP
#define BOOST_NUMERIC_INTERVAL_DETAIL_X86_ROUNDING_CONTROL_HPP

#ifdef __GNUC__
#  include <boost/numeric/interval/detail/x86gcc_rounding_control.hpp>
#elif defined(__BORLANDC__)
#  include <boost/numeric/interval/detail/bcc_rounding_control.hpp>
#elif defined(_MSC_VER)
#  include <boost/numeric/interval/detail/msvc_rounding_control.hpp>
#elif defined(__MWERKS__) || defined(__ICC) || defined (__SUNPRO_CC)
#  define BOOST_NUMERIC_INTERVAL_USE_C99_SUBSYSTEM
#  include <boost/numeric/interval/detail/c99sub_rounding_control.hpp>
#else
#  error Unsupported C++ compiler.
#endif

namespace boost {
namespace numeric {
namespace interval_lib {

namespace detail {

#ifdef BOOST_NUMERIC_INTERVAL_USE_C99_SUBSYSTEM
typedef c99_rounding_control x86_rounding_control;
#undef BOOST_NUMERIC_INTERVAL_USE_C99_SUBSYSTEM
#else
struct fpu_rounding_modes
{
  unsigned short to_nearest;
  unsigned short downward;
  unsigned short upward;
  unsigned short toward_zero;
};

// exceptions masked, extended precision
// hardware default is 0x037f (0x1000 only has a meaning on 287)
static const fpu_rounding_modes rnd_mode = { 0x137f, 0x177f, 0x1b7f, 0x1f7f };

struct x86_rounding_control: x86_rounding
{
  static void to_nearest()  { set_rounding_mode(rnd_mode.to_nearest);  }
  static void downward()    { set_rounding_mode(rnd_mode.downward);    }
  static void upward()      { set_rounding_mode(rnd_mode.upward);      }
  static void toward_zero() { set_rounding_mode(rnd_mode.toward_zero); }
};
#endif // BOOST_NUMERIC_INTERVAL_USE_C99_SUBSYSTEM

} // namespace detail

template<>
struct rounding_control<float>: detail::x86_rounding_control
{
  static float force_rounding(const float& r) 
  { volatile float r_ = r; return r_; }
};

template<>
struct rounding_control<double>: detail::x86_rounding_control
{
  /*static double force_rounding(double r) 
  { asm volatile ("" : "+m"(r) : ); return r; }*/
  static double force_rounding(const double& r) 
  { volatile double r_ = r; return r_; }
};

namespace detail {

template<bool>
struct x86_rounding_control_long_double;

template<>
struct x86_rounding_control_long_double<false>: x86_rounding_control
{
  static long double force_rounding(long double const &r)
  { volatile long double r_ = r; return r_; }
};

template<>
struct x86_rounding_control_long_double<true>: x86_rounding_control
{
  static long double const &force_rounding(long double const &r)
  { return r; }
};

} // namespace detail

template<>
struct rounding_control<long double>:
  detail::x86_rounding_control_long_double< (sizeof(long double) >= 10) >
{};

} // namespace interval_lib
} // namespace numeric
} // namespace boost

#undef BOOST_NUMERIC_INTERVAL_NO_HARDWARE

#endif /* BOOST_NUMERIC_INTERVAL_DETAIL_X86_ROUNDING_CONTROL_HPP */

/* x86_rounding_control.hpp
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
*/