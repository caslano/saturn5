/*
  [auto_generated]
  boost/numeric/odeint/external/vexcl/vexcl_norm_inf.hpp

  [begin_description]
  vector_space_norm_inf specialization for vexcl
  [end_description]

  Copyright 2009-2013 Karsten Ahnert
  Copyright 2009-2013 Mario Mulansky

  Distributed under the Boost Software License, Version 1.0.
  (See accompanying file LICENSE_1_0.txt or
  copy at http://www.boost.org/LICENSE_1_0.txt)
*/


#ifndef BOOST_NUMERIC_ODEINT_EXTERNAL_VEXCL_VEXCL_NORM_INF_HPP_DEFINED
#define BOOST_NUMERIC_ODEINT_EXTERNAL_VEXCL_VEXCL_NORM_INF_HPP_DEFINED

#include <map>
#include <algorithm>

#include <vexcl/vector.hpp>
#include <vexcl/multivector.hpp>
#include <vexcl/reductor.hpp>

#include <boost/numeric/odeint/algebra/vector_space_algebra.hpp>

namespace boost {
namespace numeric {
namespace odeint {

// specialization for vexcl vector
template <typename T>
struct vector_space_norm_inf< vex::vector<T> > {
    typedef T result_type;

    T operator()( const vex::vector<T> &x ) const {
        const auto &max = vex::get_reductor<T, vex::MAX>(x.queue_list());

        return max( fabs(x) );
    }
};

// specialization for vexcl multivector
template <typename T, size_t N>
struct vector_space_norm_inf< vex::multivector<T, N> > {
    typedef T result_type;

    T operator()( const vex::multivector<T, N> &x ) const {
        const auto &max = vex::get_reductor<T, vex::MAX>(x.queue_list());

        // Reducing a multivector results in std::array<T, N>:
        auto m = max( fabs(x) );

        // We will need to reduce it even further:
        return *std::max_element(m.begin(), m.end());
    }
};


} // namespace odeint
} // namespace numeric
} // namespace boost


#endif // BOOST_NUMERIC_ODEINT_EXTERNAL_VEXCL_VEXCL_NORM_INF_HPP_DEFINED

/* vexcl_norm_inf.hpp
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
*/