//  boost lockfree: copy_payload helper
//
//  Copyright (C) 2011, 2016 Tim Blechmann
//
//  Distributed under the Boost Software License, Version 1.0. (See
//  accompanying file LICENSE_1_0.txt or copy at
//  http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_LOCKFREE_DETAIL_COPY_PAYLOAD_HPP_INCLUDED
#define BOOST_LOCKFREE_DETAIL_COPY_PAYLOAD_HPP_INCLUDED

#include <boost/mpl/if.hpp>
#include <boost/type_traits/is_convertible.hpp>

#if defined(_MSC_VER)
#pragma warning(push)
#pragma warning(disable: 4512) // assignment operator could not be generated
#endif

namespace boost    {
namespace lockfree {
namespace detail   {

struct copy_convertible
{
    template <typename T, typename U>
    static void copy(T & t, U & u)
    {
        u = t;
    }
};

struct copy_constructible_and_copyable
{
    template <typename T, typename U>
    static void copy(T & t, U & u)
    {
        u = U(t);
    }
};

template <typename T, typename U>
void copy_payload(T & t, U & u)
{
    typedef typename boost::mpl::if_<typename boost::is_convertible<T, U>::type,
                                     copy_convertible,
                                     copy_constructible_and_copyable
                                    >::type copy_type;
    copy_type::copy(t, u);
}

template <typename T>
struct consume_via_copy
{
    consume_via_copy(T & out):
        out_(out)
    {}

    template <typename U>
    void operator()(U & element)
    {
        copy_payload(element, out_);
    }

    T & out_;
};

struct consume_noop
{
    template <typename U>
    void operator()(const U &)
    {
    }
};


}}}

#if defined(_MSC_VER)
#pragma warning(pop)
#endif

#endif  /* BOOST_LOCKFREE_DETAIL_COPY_PAYLOAD_HPP_INCLUDED */

/* copy_payload.hpp
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
*/