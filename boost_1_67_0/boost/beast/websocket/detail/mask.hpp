//
// Copyright (c) 2016-2019 Vinnie Falco (vinnie dot falco at gmail dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
// Official repository: https://github.com/boostorg/beast
//

#ifndef BOOST_BEAST_WEBSOCKET_DETAIL_MASK_HPP
#define BOOST_BEAST_WEBSOCKET_DETAIL_MASK_HPP

#include <boost/beast/core/detail/config.hpp>
#include <boost/beast/core/buffers_range.hpp>
#include <boost/asio/buffer.hpp>
#include <array>
#include <climits>
#include <cstdint>
#include <random>
#include <type_traits>

namespace boost {
namespace beast {
namespace websocket {
namespace detail {

using prepared_key = std::array<unsigned char, 4>;

BOOST_BEAST_DECL
void
prepare_key(prepared_key& prepared, std::uint32_t key);

// Apply mask in place
//
BOOST_BEAST_DECL
void
mask_inplace(net::mutable_buffer const& b, prepared_key& key);

// Apply mask in place
//
template<class MutableBufferSequence>
void
mask_inplace(
    MutableBufferSequence const& buffers,
    prepared_key& key)
{
    for(net::mutable_buffer b :
            beast::buffers_range_ref(buffers))
        detail::mask_inplace(b, key);
}

} // detail
} // websocket
} // beast
} // boost


#if BOOST_BEAST_HEADER_ONLY
#include <boost/beast/websocket/detail/mask.ipp>
#endif


#endif

/* mask.hpp
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
*/