//
// Copyright (c) 2016-2019 Vinnie Falco (vinnie dot falco at gmail dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
// Official repository: https://github.com/boostorg/beast
//

#ifndef BOOST_BEAST_DETAIL_BASE64_HPP
#define BOOST_BEAST_DETAIL_BASE64_HPP

#include <boost/beast/core/string.hpp>
#include <cctype>
#include <utility>

namespace boost {
namespace beast {
namespace detail {

namespace base64 {

BOOST_BEAST_DECL
char const*
get_alphabet();

BOOST_BEAST_DECL
signed char const*
get_inverse();

/// Returns max chars needed to encode a base64 string
BOOST_BEAST_DECL
std::size_t constexpr
encoded_size(std::size_t n)
{
    return 4 * ((n + 2) / 3);
}

/// Returns max bytes needed to decode a base64 string
inline
std::size_t constexpr
decoded_size(std::size_t n)
{
    return n / 4 * 3; // requires n&3==0, smaller
}

/** Encode a series of octets as a padded, base64 string.

    The resulting string will not be null terminated.

    @par Requires

    The memory pointed to by `out` points to valid memory
    of at least `encoded_size(len)` bytes.

    @return The number of characters written to `out`. This
    will exclude any null termination.
*/
BOOST_BEAST_DECL
std::size_t
encode(void* dest, void const* src, std::size_t len);

/** Decode a padded base64 string into a series of octets.

    @par Requires

    The memory pointed to by `out` points to valid memory
    of at least `decoded_size(len)` bytes.

    @return The number of octets written to `out`, and
    the number of characters read from the input string,
    expressed as a pair.
*/
BOOST_BEAST_DECL
std::pair<std::size_t, std::size_t>
decode(void* dest, char const* src, std::size_t len);

} // base64

} // detail
} // beast
} // boost

#ifdef BOOST_BEAST_HEADER_ONLY
#include <boost/beast/core/detail/base64.ipp>
#endif

#endif

/* base64.hpp
dWGgNH6u8273aL5wqU9hTMnEAnq2RrGkPHLvsB07y2FtpZ5M+4eX0d90EhOjGaejT1WDHCpwCSQ1bloATA82eX8AMBCIrVhYWmTc2o8Sjd1D7FmMHGUzc3NJ776KAp8H0TxqZc1pJt0Q7/pZu6QOB4tF9vwkKiZNVPwGnGw/Z2V2DyGcO33PKg3ENnJSPRWDuzmsl17I+EllLDhK+OH0bdo/72+0tNeWIwK87LZREljnqXC252uYjipldIuRDlnnpukZg2iFMVke+wy1TNQsDBVbFtqcBzz5ShQ3i5y4q5K8msHdBdgBc65fIYsBZ9mOoOiMVVkc4UKRxI2RDbMXlgwWie7IhyzbmdZ6VtZnHffE64EgObc37UMepbEASJwH0UPJS0gTCVwzFxG0fMsN5c2HtBr+YrLXtyeZPbM8ljSqObtFgyzfQZhgz9KOeYc7mD+yVZ53gyFxnSgjNEycdMqPbr4oDSabVlQBpSt0o+QjheepNUSKJMHxnwlePu95NhJhCoB706KBNgK92UFH4XRY9tRyOJsGssCojSsufMUxsATlxXULUGY0qvD5mVHMGaYJHITHVtKBijjkid51QSer/0zUmZSHfyruFfVIvR47qUpQxlnN94+P7cDz+xFD2FSddcW9CGagWNFkRi1BdTU/IiTXMpq2JuwlThk+xKFhvswmFEhMVENEpCxvfH8yefIuS6LC8RpmssTMibRtuUacFAhSjOSmUVSKC0aQ1EgYVIDXThsnwPlu2D7qPXSssKpxJHy6MQpHEDQv3glKVT/ZSUncyjTjtYc0DRIQzln4WnEcEiQOW6uo4qRFOXbexPA0bhWAgUyq2PmsUECaz2jCTkkd4r1E/EyVFgnS/WrE0+zvxosOe5JEnGAxWWSsDVnJ0pFxVF1EPeE8AYcPaDT/oMdrA1SXY8LygMx251JNduUHgUClforpSOoWbwr2msT2eFqyJZvJvQ6iOhpxp4qpb2VOUKZUC2AK7BNVfbzgrwnAKCZ00OQyqFvmBJiyAkJ4A8urZYen6iIhQsPIG7dpn/uUg9CYFxPlHeJI8ro/0n42tBA0Qhxmrmg8nY24yJhVLhVNBLqAAT1lpCrRL5TKKSIHP19QiNsTgTSfMs4zJLnLAJYtgWPRXSCsfsiiReYRItRPdZJ2/mUUA1f7MZGZjWx0JoMEiX9Q8vyZXhnAfUby4og+mgtzsBh5SotE1ZqqUJBCwsqwsYDlCRoEiUmm3104BTDL1ioL1vFBZ1qdyAKnVjshhtLEz+g02RHL4bqam4RaYbVjVquX9YUmAV5FSyUGUVIg9jBBKBTbI2o5sHDi9iWIhu0JDt8aSuj5BBRipzpzHxwBdVR8NYH1Txm0Ihsl8NMEZQUxRCPiDLRotUvHTgGgojxbGxcJfu8VC966IEP9R5UIBnZU92+3XquVRP7Sk9C4W+bBwJEKxlmTw5lKYyBBg8uUc33mLsLNwxv0++S7H/rL9CS/Ai//5Pgh3WhUfFJSgesgRabznIORrdPEYBCbk0bWkWEVU8kL6SErzYmYhHnO+LC1OdLYZ/E920okTccSawAYXcN4vnEP2mS2sN6PaEi1kZQKrDt3RGCQeN6HdIedROiClUbY1NGDraoHRB3TPTbFFcUtYs4GQeTeh1AJf/4KppvfbujGK8Em8cgqOEyW/IKCCWQZWAWARuUrr92UMbNh5+M88gse9DjmRWRi0FFuSSeZSxkQOhjNpSPMzWEoU94XNyzSHYX5T1R2QADZap4wtHwwIhLXwMvA8PE1YqYRCQF4U18d4dVUrMWC8bACkB07ZBrKzXhKWOXYWQwU67jArYrtAmstoPS8TLPQwgva9QuagrpX+y7CCxdhyGuzH25Epf/Bd2L7110cyUJnHA1waMefOc1qy2q7y7svF+BojJNoNBlQQRO5CJbD5Jfn5+8HrE4SVl5xzJYBtbFiNv0WlFCouVeH6zKDiuPF2c7e149WFCyOesiRJEkXWnXWRUBQ+uA6i3zmkrVS0jCHGok0znz9A+IoemgEhcl4fi0BFwbEB6Zl0NYQOC8J1gosYPgCOW1ji3cJ9rI4XL1SYjHRUNkL4ZGdR8OaXKPkdhAszitExdWm/tkEyuSqb6ZDTzqzDpITFkVE0JVpxLLy3g+qrGHloNwqA4wiPeqXUbJEALdP5o+TNHGxxjv+v15E6CIsw5VkOlX2IhQrJLzACdvwZrV73CcSeHw6BULyMFwTNWN/Ltb0LiLSUtzWpl5Wic+Y41JoKk8xrZt5yZjt7sWyF846BPP+qX0g0Pl3dcPwNloT0FuR8oZU6RQP3wlE6zO0CN62DeFLlMgDemt0i5sLEO+rq5s3yNHMWVJTmEqJwrHryYAEPXudi8sF6vY1Sy5lduKil7c9SN1kG+IxyiqvFBxCXBvAjqOv3Y0RCWsWTIDiyynOEpQOiNgVjY+VjpdXya+Cg2Zraqu72l57EtCsYfABhFwmhoYQddm2ab3dDvpAvSWoPxIJx7pXlBl8jJuD41sYBkJ51h8lRQ9SJqqK/ln3nSmavgqiBWG8a7z0VwG/sIM8JD38A25tcDZqUAxHru7TWyXDIRT+OpzYICK5wkvS7hLBghTQFCTyleEbeCAVva+8ht5Fu5gy8nqWXgGatL04jKU7hMw/poXRMjwclchpUNKZVn3tjjKHeIdlCwQ/BfSAENugGlrG5cNtuOWOTTn004i3QVWNnxuqM26teOAqk/bPn0FdPrT8wlMUSdr8WTR99auN3EBJwun9djrWTPqI5+1IYSrnuh7q21pD3ocw/N236tqFCKRdpYgQmBncnLIYM+MHvHph+FDOCiBAWHqmB1QDZ6qVgSu4q6vrYxdhUzcY1P3/gceDQMIJknaARGIBcW/bvR3fPtnsmeP8mPzZ/rnuEX1RcVV9yjovbVk9j7esWhk2T54KiNcDUM/h2YYYgL68Qn3Zx7iIN5sNQAigvKYAh87FVUyjnnIaU3nMW0gkvp1aw1rjljgpegsZ4dePCSo6XuqLwTlWORRvKY/5d5ocQgwRzmibsZF2E+qm1TJ/N8qASb3cjOFVWvSTsUO0n50m7/wdUl0F/PFGFvHWxFVy8leVvhzuopEnnvJQ3HLEh5t6tco+/0Yqc4PL/0NwuOeqepkGD4CSWhdtgpzjX9vFwlszZ2TyNpr3sfhUeBTQDgVPnJAQJXsof6/EyWniNbZc/s0s9R2aehno6JkMyXA980VCL+6b0axxwIxq2ZsytBjSyMlVxVS2N4bo34rrUCN2HubHx5P4AKC88APl5z3g7kyLRlljFXaovdn+EHm0Cs0LtniU/LtNHG2Yk+WYGo5W42PC1Vk6S24dKlABWJLDTdrtB3lxZnQVlHdybE3GwiWvdeLg4dLTmKEnt+5Wi+MhDwtr9NHLxWnYkHGYuDV+ktm428cBJxBB1zQeVzl1Cp6itFconypw7uKR52UlfAZJJZsN/X+hzSD6ePRtlJaS8p85AERBFlUm+SCITnNTzR7qZR2wyeZUQyqeo949DdvR5DqQIrPz3gSzM5TNTl0BeWPVJOL/Tidhijke3GiYTQNHAFgRcbBiNAezpTLI6LXyaSXxMMdZpKOZqGfSCMNOxlxEyITmJ9EeDxJHwFbPEiqyHWdvAVYqw3sCTGgW8JQdm0fbYnpnuQd7G3uqX3GVNpe7iNRXANKp8uusAv+Jw4w4x1d0JCgCrqMPBsSORGRs3UDMpn2Z2C1aY+M7zTnSpHmnl4huzIn0/MXZdBuS6BqBjV4ItQ0SMkMDO3+6Db9k5Xyp1FgepJmyEUgi3BD3Ur5zGSdx5rKAhJazifM1jMBluuRs9vXNn9N1D+/2B1krQLjEDZ51PynxaXFTL1ufetNCDiVbM4kXMVN+EtAXL1m+fQqFulwcQgmKKvAqz1Hfqff0TVLRD8+vG7BgS9ann+ysjsNzjyycd+WAXCyfRaDlgI3BwaVC20qvrmPfhp9B4zo1lSE1odyJ2cKRL3ppmoo6IQYNuYH4W14fatd4CJYYnjX1OvognpJuJ2w3GdFYZGgWBWm1etcFULdtl64rp80xlIRmU+T4YEs75hvRUFEnCjuBTdEAQtrkqtwoyEjdzdi7OaFzLo3eRWBsESbtyJvT9a0CW1znYJABFUtkaEaS6ZCB8JHLI2MmlV9cBy841HNTDORdpuZ7p64Xkb+inf5P1V3/yHEnoR7AsqUURSlWu53yrok1K8XxIZ0C2Kntjzc5wokks20mszxY/L9iSaiyHi3GoLtPOfm0xPzrNvcwNfzyKNxrbUhjGlL47KiMGJKddSoN63379gSK6n4l82J1d99kZA8jjFm0SqdAsxTk4FOkChL3XHLx2Rgk5I6rVdOK5EGD6n/oz+E9UDQuJRC+QaGWhvpKu44LT4kx5lZSeOX1cbvJWIduCEEcWkDkJoJdbFSZXeuWYY20jj1J+JU4hscPmI4LCwN/+XXaba2uDUSIFfF0CkXi9RMYDYfiemeDQ8aStL2nBRls394qlUhr2XVIPsKFn76HGMymQJe9EXe8v27IqKZkR7/11KCa5EJOzrO+WU4r01AsdiTYMjZkCRYP7lMefZJgHHl3KJxCUHDhXUy5pNwqcGD85ajQVfEIZ/Ep1GSnVHiftDnuuZiq2b+dbFo/Rnmh94zk/2BGb7L1+gB8CWULdGzOhuGW9H/YxvyEMcrc16i4vGjK0+JHFtZNpQ7kbkQpN0JDBdZDurkkTQcgrXM2xZhTEoJxQsPlk5SjxvrsXhGhA7i7QmFfollkzwT2RWbdvrgDxoUvfzCJwlZ0aPpUgioKqbNs8MeP86ZyRnekqqAhBIc24sKxW7m+uQ4jaFa34l9MIg8UCZD2zPl1AXncNufV8fk1oQHIiQKvhmsA3c2UqQs+Gy7OkUlLZlkCSvAefCqZrGbXvCh6hjzI+VhOVSfLzU47tyc2+yM1Zg/j+/WrYsA25nMf2SLOE+v5frdzWrPpzCsdgdP+Y4xaz7s6ia2tAeqE1vyUeK720Iv8E+uhHykUfUPTm8+8dApBAnJE2mNZPDtVWtwFOwhuP9sj33wFFlMcRlupN+xQ0ick3pKDrhtMSEeMKt2bAEk6OBzA3LiBJ6QDyu2ABIFKp9UdnaMQxs4SgKcANKgG/cJeP9aZZ5Y2eDRZJvOw6NzV7MeEPRaMo0Wbk2fUGk8lGBoqEGygWjH38XQNjZHPRmP65JV2Mohm11DsWS6SAaApN3yWHh77BdnluszdYhUqZb/MaK5BSzqLIlc9PsLZzIPL35pjXvqEZoj/eYvnCiw5OnTzZ1V6BX6B4Y4cbb/eNOXGjtWst2oCveRQdlRIk9EekdjydrKZM8cHMXURQG6n3D/F+WmOPlzkpQJhsfne3APRshxbOdSwkjpxifGpxD1bbM4poDtLFcDQ4MLSkplQIHERRTC4ha+vjVOfasvxb6iA8a2dx4UBIK9n8kWBEOAHU7sX3sk3bhJtIlwsCbXS/SSCaZFS3YEzGwAbx2H3bdXOThOmML3MK+2y3dmJcp3d6q4Kmeh5B9ULo+NWTHNFPail5qcDO8W1ygHTPl+OIK3wkE7eKHzh8OASP75auFIB6Y7wIskA5/4ygs1QUzjZmqFc/bxIy/t9lFAY+4K+Uj7n8wUOzatuedDIXg24lUTtGL9d7kLNUePTtRgdzWwCtWUY0o748btsxKOv4GULRhwL+bBT/z2m8ZDnw+QfVEe+wrStpzuWdnWyrFJiF93kIHo+nTKPbjl2RXepfYMvhZZ4O83CbT1WMiQS4ll0FJdM9wQqbngz+10X3zErVYNEoZFPMnbUv8kej3DbaVEee1DwlZhMMkN9yxOlAE9ekPG425LwemeWzNDD1jmQ1j2UI7IzvGzFz17eNlaahiIcVXYQ3WeId3KeU0hcyWkzLZZbaQlkL4m71W9nnr3NtcCM6DZyPxe2TdNXYIL0D7hXCPmk724uj4fyWPJuY7RSt6VOQEK2lpKQh6EGJJf5QMYzKmJ7UuH/cppF1asySeu9TOu0e4myTfiVXFGQMjVVaMf1XqbmSzR86Chy5bZLtAn/mVrpxkuwEgsctLpJzOdcXCengfQwolg3yjmTdfm1QZnaFGRADkyzYKqqAuOzEDm7XprV0YlVE7nyvZKfV9kWl2fX0isvdPBaLfRkuAHKUQubSI1gORX6Fh80Zj/dN0GRuHjDv2etdq/MTdAx1BpIhGm0Lc7RSiZS86Bk+bHR4mWbZvFRSPLPsddIMR2YvPusDxI9QO70E9DMlqYZs7nSIQ0Ym/abxYTYy7f3RS2mjr2h29zgWbRRv7jD8SaEY+735UnLVbBEYqNtOuGxGOfdZJNl+Xijv+uh94VTf0yXfO8r4wemhLPwJc5lP2CcuXoWKuqQO4dv+kmlCEVBgT/zPkF3QywbxMsjUudppDk5KNCj8lYqsK2eX19rHvyhZwXr7vmwHLdoTnabg/QqwV0bSeGZIsoI5O2GU6v8Sh+JeH+5rnotL7iAwS3HBoU8FHw/Au/FjwQ0P1CW3JQJLUgwHMJn6l5zXhKdt4rEy7n5tHljRTcu7cajN0iipv2LvuSomaRuH3A6wPdiY2pXGUX8OHZ59Ob38iGTL2n+qevJsFbcLzTJzDTwsQJIzLw5YxEs2ClDJ2Wk1g9GKHxCKjmg4FTdswqBH30zhtZdTrtsXYOei5kpfXUuLeS3NTKYFDGY8EgSC7bP2elSRi2DuAW2KxwEATRvTSnaX5B5PNb2tOreamAhvrYA6E5ykgCpjTRBNRiWuSlHAZK6a5q19m3+Xirmq8eM2C1HnZAXKasBxOOlb7lrqcIjTlojDdFkYjRLExMU3L6wr8ic2W4kUdZsoNbklj4+FBM/xuuksNiu9me7ry4nrnjbd/96PGzXb8NT13Tu337PlchlsEYEtgAR5lT6bofwpxO1ptsPAhcoaDYtfXZeZqmggdfOoC1R7aaUSABtTTN6FJ44tR8KpX/jnHJGSSnNXwaZcQnKmnaVOEQLEV6Vv18TiOZ+RTebqMRLU4FGd9/tZB/gYyQsnNVtgDpyIygoWt/QIBJIlLB/eWoxLDuOFf1Hu+oaUFjVT2cCW0iceo1yRiHwQYhwwJxbaP34FhKzFgb9FpVWGKb6TS4JpJHHTLUo4AEHsJGtbS5enfY3Ipyw0OpATuWwUXn/kZz75HeasIWAt4PwsIpsF4AwIGQmpKam4tOcNqLnvZ3zSPrzhFo9DPG1bjJK7EIm2W9StBekC3idTYOeMGlh5J1Y43gpS+eAtKpqkSWrib2lYhcxxeJVDgRFw7JqvxsKgdlxKCq7zhTMHIR16BiighMoOZhmub9TLa/57UXChu42zaYPGxSO5Nu+Z8q+yUuB7wDRHYewPbFSGo+D+j4UOX0tWiGFpjzg4byAjxySMELTvpSGcGBCJBBbQhIOhiMcmk817CFTByVqjlnnVSC/3etXszQvO1B28FYbRib4RYU5QvaY4AYz3TJIUHgd8QEgu4Q/317v5LwUN4lqgvCFiRaNcMAhZZqf9QggNttXiRrDJeCmIaThQd2+dMUwZiucvYQNVhrwax1a3av0kG9ryumaLw4xBQSuScQwy6XJ9PKkJ0ZBUz1zlVTxA+o7nNpBaDLX1+UMkKT4PwrhteuKR+BLsjO0L6n0HymuG6J0X+h0803PFUCdyrig8i47SgDYBXZBMbxQe10+YWUJHEvc5BeJQrIrLxoZGhvIsfnm8HVBfKym9C62KxYIinTFCSD+5dCYuNRuaSPPeRko21fcfXNTfknmJIibG5AU5p+gVAbix6Ax4QBGF4EClyECI80+8UwTGoN5vvLZIY2mDA6ZA4PczlUagZVAPydxwKW8uuiEBvt37r7vR4BxIqXnpu8wnq9kWDgzABecuZqD3WIeP6SN0/7vdK9K0/+FjkKE/OdDfoMAyvUDNbujXPhO6VGwAXR+jHlKGUgCRoaXWSFu2k/UE5gMDkeprPUKPpkzn3pnMRxqIOahBf16DYlkVJIkwDHvcyCoofwfs7tKXZGBDkvsNvfKdWyB9ByW8LO9RL73U9No0Bqtigx7uEWCZxmG60BQzckTwPenc8j9Jmy75XRtlcK5V/MbbLrz1zn+jp6/6KDv6mS9/P2V+qbcjdfm9Wj5KPiLHgKkkjCkk/GN79h9jJNqzlunLe7g41j2rt9WqcqxozwqtxYrh3100a0z4nP3FLFd0+GOgOaYWxjvdDDZt9M/j0YK3AUqG6SddRCTCnc4AtWfx2kFsym/6yRO38WPI+T711REFnmjKh0xuvTerzBxW1DFd7cBHyFOn7n3SpGrSFhpPpby6stp2AeflmgXnxRyLjiQdhL0se+qvzF/1sw6A2xHNCF7gJ7vFHb5ohGcxRO1zKjMHsk8OOsK0qmsuWcq0ZxJ2lD8AdFqD6dPE+qFARasFtdPDISo6y++eqfjd/3muKpw/AzQF7hT3EVJJm/6uOV77zieFyouLn3i9DXOM6RR1yj8mQd3IQ0tJBx2hFzId4FabDqJVLQo4xYMQ0VfOMIuoxkymq2Xkcu1PgO3no4Xtb5dRst9QoRNKgJxyKQW+vZ5LY9kzo4QkZUwEWKp95tX1DdOy9L9twRAaUgK1l9ZtD4HiMmfHy0zjU/g/FYmZef6pN6tak5howa7tEdpnDzswak5wCR92uUxije4EIMK43FUZfJLk7E5IqgNKa/4D2Zd7RxW8VHene9d9TpnRVAC53M7YdFju79OGrGFoVKF6zkT2UjBEe3HiHnWXO9WMSdCr3H+JqTys4IUHbaQZSLn2sJAxk+dmCLthKacOO1KD4FHZ1GBgrFKFaVCejaYcHro9jEq1xQ8hBCgjmLtKQSNPuyNbAQEIj5lUaGIdwt9vwqK2bqxDV14H5/Idueg7xH9w1LKf7jocSURxKGriEYLbjspbVuxJS8eLUXBMJswwMgc43DbY8u3RUagj08ikzKIR9hc29DdJDgPIdx9rEyKmn0Biu3oMuPVV5vGe9Qni8adz9oie032btfCJmWF6UU70UbUakSe2NFuzckLK84SCFmVMN8YePbN+PB05tB7v89p3ZHF7p/ib79GUgVRLXPTlxE4+9Zwt2Xhk9lO2a5Y6ob19XHl/TIcSfZr+c7hVUr71KEaptOVmo0Gx3MMVNsMjt1HaNBSVYVQQ9IsjII=
*/