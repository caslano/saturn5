//
// ssl/host_name_verification.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_SSL_HOST_NAME_VERIFICATION_HPP
#define BOOST_ASIO_SSL_HOST_NAME_VERIFICATION_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>

#include <string>
#include <boost/asio/ssl/detail/openssl_types.hpp>
#include <boost/asio/ssl/verify_context.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace ssl {

/// Verifies a certificate against a host_name according to the rules described
/// in RFC 6125.
/**
 * @par Example
 * The following example shows how to synchronously open a secure connection to
 * a given host name:
 * @code
 * using boost::asio::ip::tcp;
 * namespace ssl = boost::asio::ssl;
 * typedef ssl::stream<tcp::socket> ssl_socket;
 *
 * // Create a context that uses the default paths for finding CA certificates.
 * ssl::context ctx(ssl::context::sslv23);
 * ctx.set_default_verify_paths();
 *
 * // Open a socket and connect it to the remote host.
 * boost::asio::io_context io_context;
 * ssl_socket sock(io_context, ctx);
 * tcp::resolver resolver(io_context);
 * tcp::resolver::query query("host.name", "https");
 * boost::asio::connect(sock.lowest_layer(), resolver.resolve(query));
 * sock.lowest_layer().set_option(tcp::no_delay(true));
 *
 * // Perform SSL handshake and verify the remote host's certificate.
 * sock.set_verify_mode(ssl::verify_peer);
 * sock.set_verify_callback(ssl::host_name_verification("host.name"));
 * sock.handshake(ssl_socket::client);
 *
 * // ... read and write as normal ...
 * @endcode
 */
class host_name_verification
{
public:
  /// The type of the function object's result.
  typedef bool result_type;

  /// Constructor.
  explicit host_name_verification(const std::string& host)
    : host_(host)
  {
  }

  /// Perform certificate verification.
  BOOST_ASIO_DECL bool operator()(bool preverified, verify_context& ctx) const;

private:
  // Helper function to check a host name against an IPv4 address
  // The host name to be checked.
  std::string host_;
};

} // namespace ssl
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#if defined(BOOST_ASIO_HEADER_ONLY)
# include <boost/asio/ssl/impl/host_name_verification.ipp>
#endif // defined(BOOST_ASIO_HEADER_ONLY)

#endif // BOOST_ASIO_SSL_HOST_NAME_VERIFICATION_HPP

/* host_name_verification.hpp
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
*/