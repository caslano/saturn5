//
// detail/work_dispatcher.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_WORK_DISPATCHER_HPP
#define BOOST_ASIO_DETAIL_WORK_DISPATCHER_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>
#include <boost/asio/associated_executor.hpp>
#include <boost/asio/associated_allocator.hpp>
#include <boost/asio/executor_work_guard.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

template <typename Handler>
class work_dispatcher
{
public:
  template <typename CompletionHandler>
  explicit work_dispatcher(BOOST_ASIO_MOVE_ARG(CompletionHandler) handler)
    : work_((get_associated_executor)(handler)),
      handler_(BOOST_ASIO_MOVE_CAST(CompletionHandler)(handler))
  {
  }

#if defined(BOOST_ASIO_HAS_MOVE)
  work_dispatcher(const work_dispatcher& other)
    : work_(other.work_),
      handler_(other.handler_)
  {
  }

  work_dispatcher(work_dispatcher&& other)
    : work_(BOOST_ASIO_MOVE_CAST(executor_work_guard<
        typename associated_executor<Handler>::type>)(other.work_)),
      handler_(BOOST_ASIO_MOVE_CAST(Handler)(other.handler_))
  {
  }
#endif // defined(BOOST_ASIO_HAS_MOVE)

  void operator()()
  {
    typename associated_allocator<Handler>::type alloc(
        (get_associated_allocator)(handler_));
    work_.get_executor().dispatch(
        BOOST_ASIO_MOVE_CAST(Handler)(handler_), alloc);
    work_.reset();
  }

private:
  executor_work_guard<typename associated_executor<Handler>::type> work_;
  Handler handler_;
};

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // BOOST_ASIO_DETAIL_WORK_DISPATCHER_HPP

/* work_dispatcher.hpp
7hWOpsmcTWYMwd2ztaYS1leT4jHKFhBJ0FDwQA7YY14q3+NxqqH92hC8cOB7Lg1fPnJPz0QLowWiSpRf3UlNB8e0VAVkUAAwk45PnyBV8Y2xQno6e3d+PK+x8xcGLMh59PhkCuH0XnMthf/JM4sSp4yG6CRPPtEeWN21Tks1nFSfItfVB86/7el77wX/rvAAjxIC3oA4mWs0obfBUD0FlSfHBtl6QboNATugdqdiCUHEchSKm5zEkcwuhl04H35MEkYFiNpzS8Wj5z4wnG+QwrESWJGF0CIEpYkUu8r7d3DuKq7rM3m39yttiBT75bcS5K8kPQ31hr2hvGw0YLFyZJGRBLg7/LxVImy1eV6ZHj7ChVZOKHTwsphOhjmi+fGeohd4xLEsoFfYNFf5QpK+7HAvsDdt9Cpaer5PaYQFPIZRmC2pqnIHhvXwsN9dXX8jmqK8EGLc6H8wLLX9ATgI8QWefQHBaRElfDcocap8+oF32JLpmhQLl6NxvJYX9xOPeoBeIVbhHMCPHWQ8qSlDwdrQ7nKAmFH9grUOduvp90BWamHpzg6vLblj08nFiymhy+FgRZQtR4apizKyR7r7takNUQiIGGtl8xHzu6hSk8co65ksStojfmAjNhHOq9X7PO1b9C5qlYF8JUB9i+9FfRzPPgJelsU30/+6jSqy24F4AqcYm3dGMLH0diSMXkLmRKyo9HB8lKRDdz1AVQp1xfAtQLwEJHSZsqB6024/N5/6HLJq/LNakpmCuvgcLsqSZGHZjXjRLWxmS73AdpPVA/5jz0GtjIFJFwZS8j2rqytC4dDko9y7CvABNvHkFIRstQf7WVfm6kjEuMv3w/9sZ4/7r1vxJQNYjxzRsWNsJ9+JJJL4C1arh/UZDbEfrZncttqTWo/XULVUC2ztWGuoX7zUNmukj6hj9pOxrMlHqcPcJfuoGrcnGiRt3hcGJnp0wSUSv23W5b+hePp/W0TaCTMJn4oBJgjFueKRd51ax1qdmaB+dqLnP/86DhrBmkb57kJLEua6rqmEg/FL7UNS7wXfUWQbsVZUYs5y+LeJ6nJ4Cdd37BSOsjWZ6am735u/qjIPnj6cHIWPUu3NP3TjjjiU1SKhYJFm645CQgV8QjzmNughB47Dfi9H2AwVa8DccVd7WfuF3fhFg+9TjZN2YzbWKOfT+Clbc6+SUeb0Sgl0oDMku3C2/FQzveTcehNXlbKetiN9wdRrKoTF85jTKEWJH8Sim418GHY7XeSVf7OuHhcg3r13f06AX9TgKqMR1SfGSEAvzKScqoAI62HSMzG8qXR+vwuWq7Frlw60Y0YkPSGcUl6VvEEw0aUWAv+l7O5sd3ygwMRz7gII05WO3pJsbU6gBJvfDhietEoN1q5VplH66L3gNA/jNSiKKv9sfuCs6SCxa80m33NWqh/uMqtR796s3t6E2Rs7haLeP2saP5XNYQw/Zcmzfs8aY8il5fBM4DQ2qFB69ssP8j3bLk7f2kYs1vKaUHX5MgDt15AQ6RYnIhAoFXaPdHX17cgvARrA0kiAUCwGnrM0eeu4wlZnj95F782SlgdvyAfPxtvjvD1R6K7S3RoBecfYPoplQgRPua8fKSmJo7ImA7nHRmuZ4PfztNNTIDcBnUTU5Xw7kWRnVArJu88au+I3vApt7Vd4L4UsokM/GbbhyNtmrO+4jwTsiHJUuKRTJc5tgGK0NMCFGIn6Z9NJUviHgG4Mv5Hc7GElE4KSWQIGeZbPBO/IL5N8ddR59b7v1uiargBEqdNXIvV3gen2W+SBH7aVhdhTfFzzyMjech8FuJzzDv2nDbWzyU6KBRFqKqu+mosUbyXLaFblRQZmYWTOJVVQfZNDnh7MTU51JzF8v6+aDxqpTQSrF5CKKouwJxiPEQOBdvyTxfnGRQTORMBFbsq8vay6+R3pgbKBXcSi7Rx3KE2DWwVE3IwokkCx3vbOMjLaeeoPpRsbahbl4V67QWOHUTFulsKqo5wf4svx4vBaq9k1Ihd0R9dCeyNphIq0gVw3vDikI+fLsx1wUtcy70CNHM1jgCdXppWe9Kq0CAWoB6dPFc2GrKnX5eNWm213y2B+l8sh6LZMJyVrlk+W5xUb/DDiFYYjIJxQEnh1sQ0ktI3NfqAF3KcJ6Ueu+eDQYGbTcGR2ZSbsoEPnlt+DIvrz5I6wS4fDjxOsjH6ZJT0n8TLk8UEtcQBOP9HZNd/wX6GbWmmWw9vtN7tzfPllGz2fKzyQMDj06lGKSKgeJYqtHMPRsfZOCMn7W7ITI3dExuO6aiTLKMwHxn9ZQ4PbQrzXdlY9aGtOC09ULREdOOD75AxCQMpj7izKiGdFWQ0VeFnICMh2QVYh6jwo9tYLAikP211AQJMQzhMFpTu+PLQsor/qCKZWiXb9SuwH18VtGE3j5pfNld1YE9ijVg4qEslu/hJ3TZ9ndDz416V8MCH9fD734vXyKOR8/5QAZWEPyD8OqudSRrOahquVwZ5/oArjEobwQDPjkUuS5Ue3ZVAVe//NG5AsDicqSeiiBcgf2b55b1vjTFQ2vQEcBiE549Z4injLhWCHQnxDt/JI7kK5dNm4p417Zd1tXwJ0iUAHAnrQ8na87etPia61QScE1LVw6bZjfSl22/YA/NjCuuya8ZZ7H3QvNAJ2ntf/d2y+/5S1OpwaCUr3LmkCc+N0LIZrBnkABCz705dOv9QIAxWsBAHI1JPzKuV0leJA6LGD6zxOzobxvnozI0pYt92gxKdAPK2Ah6iGk0mhTc02VjJziIPfeyks0lEvy27NOCBNcsStXiREYRj0gUTsONBUnmqmZzb7HJGWRwFWi6F9WK/oQZFl6dykbLQPPOwTlNWB6Dfzrkr0oF8rOQqmDt0/ectahaEfCTqAIrtmcG9wygq/ZQE5YhAXSpO6YZJF3X78IwrnLgAt2VPeeRDP17ezDWMbDvpg1BEG2x8UZy5wXR6pHMFceHk7/JmAhK+wqi30XpYwGLfpGY1jDsnTHAyJWoCAGDWYL2lOWysCNapduJunz+DAPZSw9jGFXOMr3qiUiXXeAQ0j10sQfBHrcH5lalJ2TOLWFmHGYd7df/FwaWhoiOcE6Epzf+n/MzC5usNVi7f+5QHTC+1l/juzjkbFGVHzj9r3jU6Le2YEGJTL2ZzwK9hweuqTUtgurJmlvVMJuw0wpLKIwgm46MY9KKfOUUT7FprNfBs8FJNGJYyz2T0EKnDDfa7iwKUp2/oTH/C7b4Exw0wgTgpvQhywgvOclt34RmYB6ka3S0j7Hoq6EOWcJWC2wsAQBGJy6yzfycs3vAPeW05nQXy5uVX8N4VRlJt3KwHgNwjABU2BDRmDikpyAwWFb3pbya+Unfu7KDaNn+ALATHwwBYRiBAFcy/FYMDCzGPF4SJ/N5PLiPAz7XRaEMtSfyOg5hEdQDaslU0q/XCY7gq2tBoIC6VnNjF2cBwytDmW3pb1rffM12AC4DjKloJgGN0eJNAbGmyIkIOiWa0nZPNMCLfyPGs3i7Xn3Js9KHUBHuDocUcSk9lsQHukzBaff9rCXCHaRFsJqvfsY8Q5U+SfEn9NYF7tCMnoMYnEG/Y4Eu6RI6X8RYeoS2svaDWFsRHC1z/ygGnZ+fnQMJ1CZqEJ8I++0H9BxqLxCW8VmSFMGq8ynUw1L6TEcbhbpBKjHYbIRSffyZVel9DEA9Uw1sFX1hfWc50VA70IqOvsBPyOdIDFjuRAR1PkywoMSOT86RLyyEvaAA1XvPF90zWLcrn4SIlziG3y+SdxdiaS9ZtjWdSGeP7kpAJbODOjCBHq7Y5PcQB9AGHqnnrmVLh6wbROX+EByWOdqlMFrkP+Hfw4hC9rlnjKja53+JnFqE4PD9BwwA4F9AyCwSYyzjzMPI3hNj2NilSgqmWVaYaJx9HeMG0tJXFH8sxRI/1lFgNhUdVgbAgt1o2P+sSaQyai0FV0n//JvPlyxClT30UBAUUdayDC8XvQc1ZETAJX+ug0oqLDF9zuPAv7WdZE4S9pO3NlkSN0hYBGF868RKUPo3Roq1OHYFkFODgj6Lph6guFIC8qUvaME5CF8mk5NlJP8IpVLrBUNcLgmd9uABFjdXo6yDYP+8p/ExYt56N8vQmQQCHDIz1vRzxh+M8WxGgH1KLDqhoiRfChYTZhxTqBBnkIuthpa6OVclWSU4A2Qk0JtZ5BVLvbhBICgeeo+c2qJoZshPlgGnmARFrDRj12TZO8YKIgBga7qYEdU+k/ihwIEdrKmAFX4FPTrKRUuqSqd7EJ92GWn/wHAjNT+XByJHGt+enEra8dsuPuTdttq0oWrLYlmE0Ld1XWWA0ZK6efFO3yGBToiLT17/5MrxAA2LASyhADNzoH7KGI15STiWfsEwJJwM0lA4ukpFfQfHCv2HH+FG0IYzpXxc9FDqszGt0bNOT2aH6waKHkK0qw7goZ5FJ1nMuWfXog/J+pEy8pcGSEgu6g0Fzqk2eRUBjExz8Cffv3fytu01ahmp0aGXfxGWERvkKnv8PT7sJ8jAneKeOV1btyJh0t9f4nglt307mWHb5KXsrEJ/ZbBseeVSy8cyAxM+ijymsYWbExPCmaUOmGIPK88fYgtGYSjsfcjcS+hZFngq+c8u9KtcTRIantRBeG+DHw9nkIiUmgWGbLA2+XvOXG9/7guqOcgZsuEq76Hids1D+Q9LxQTJn5mXl+x1EKcUxEmLFrM/S9qhpFzvUnx2X9xcjBhDMYpEjB/EMBfcA9uZOHgYZJAglI8uRT5ASSAMd1m2IvRoZHr6zzeIXElQYcoODINAGCLE/Lp3O5bVklYZl2xGt/dwgeyKAbybwvPPOXu+j9omIRB2AiSTEHG/1VaB08lvRRXwrEv3uAAEIRuo+isHKFyKgzrp9qIdfgsBR2Y7EiG0x+YlkBNtqurM+slG/B1N5/AGzat/KdDWdtk90m613jRG5diN0i84e3O+1ut3cBxmtT4C7q/znTSkwyHXPP5aPYfdJmsmDUEgQnqUh3EncNLyZDx+tvY3O/7gg4EMt/SpR4sJL+lMqD82oBZUGu7p/BcDuIKEPT08ra8rZGEf93ja0HPJE7TfF0NYz1RD1yV0yGS1o1GNNex4PHmBQ6McXTae8DoTYIURxaKD4uXltfs0ukabVhpP5y9bq4TqhX/14iEpoJLKToIfZQ9nhJRchuXJVdyotmvyAocHUX2xMvjYwC9FHBvycnzI8Il0CwpTPngk41gYaEld52O+7LJn6+982ORw+pqd05AaQ/VFj4u22ho32UmJsWBV3suIpwEPeRfpLyPdobFyomZEc7pu0JiKhaeWoNDld0skv3XjWJM/o5pzpN1XJIQn0Fy/sz0ICPKYI3CD71GMH5oVq10wZuGnar8/ae6eHN4D559n1GjejUH+zI80m7kCM+t5vXtsSW//Zqi5qijy9vd/Mfq5r/XlqMhLgSBsHefMXtSYy9LIQ3As5wGIaKDul/gfzpwhXAglhSvqObn0eGe9YHMpEFfWE7imy+0vgjrB6jaIgeD+7XZ8ND2YIEs8kC04jSccAxucSJ39xZfsvs9JdZENg7L9+P9qg4IgqN0gcC0noFbQGPKr/luKAt8CLM2JTd0xIN44OhFt62sk07lQ1Fl+L+E55cGm/RvQp2mZw4wUAbETb7Z2bn/0QbBxrrkkSqMl62heKQkqxGTLWoPuYDwhtF/1XYgV3q+S/USB928gOJO9hQ1Z5d3463XZjzPPd3ANqnj3L14SQU/oglzEwMJ28SabJyFrK2xazS3+Z9C6gza8HoYclhQPHQiK/etwLWVmrH4wbQT9bLDd1SrnG3kG2IGePg18cbg6GUVKowz909jKfuYl26BpuJhU8Mp8dcxvAiVrfAzWkENAHao91aWKf7XL+hxapviXAi7EcirHChXB2IZc3oNc24XbN9tZAnB7Kr94IZvr9WSXk5ky4XPM2tpZ15Cy7VQy+KkSJvWdmetDzU053sZ6UXmwxJhjhIDihDIE8wo301g1sgq1G/SC7rI3w+KQR/CL9ptQs5/hcF9LHtvqgOmf0yRqS+qWQx07XyMrcKlxB0gH5vV0y/jklWz3eyOAXDwHAtMQ4uuxctLI3mPPnb6ZxSd9Aq0lwZisyyY+I8XLWYlCMQdifIVLlaxMDKlJ7/DjJkopxNf2ZwY0iC8Gl+CgZkhsjkXVQvIKzkEMedXbx/2a/c8TZz3qZr41nGFrko8g+QtstxpAMmwvdsaLeCo8fPSmMDdMdeYUAE6Hoqs/q17d+FOibqGme4eCMbtkE1yZoZm8lEG7RvPGWDfSEje0HI9VcyX9KA9kGyf0ykJcUWLM6/+Re68tdEi+XPme18g1G5g9HAbRF08q6Lgu8TeUCUlzQKIrB24H5Dd1zw0Od225NkAv7Yu0iBeBw8gXNTMaAOSvQpiDOZ+Nf5GWZ2JMAZRK7ovg/cySWdf9JoaYHznM/mgp4H3LASmE5cwMfqjIzh2XiTrap3Q+AH7TsV84jzBRIGsnjYMA4g2fQUm00LCDJ7YEEQvq30YTXlQrOZkI8/KK8fIdtBodg5EIzgwUgY4niJ3yLviHBy/9IjKX3GANJYVyMoUB6fuywUWnEiNZ/hm+FTUqQ04PqkyyqM/YkRw6i6YSSXdBEfp8I4v1fMTaQ/edKnRbConYRMOOeozspE4T/7W8N1wmfI46MVdV9HhQQM3hnGXMB2VQTyXZ4VY7OiDWlk00NlRTIYcLGONG0A8Pr3M5eoIgHxtFPdxuZpLE1SNS8r07KvYBAqRgKj1J/bK6/0Ii1fZ1I1MB3QXvbO3UFFXh7OLMuPfHxq1AkKbQX7GBj8sOqZhkISiL/WhvL0TMYOwqxPTrieck7oOxmOnprTNnr/UXL6rsfrUG4dE9/v7qZOsyxW5NGNMcr9Url6R3PbkjH5y6Nnc3tSHQ3dd3se/QtZkD5pD1Lc58uynU2zVN0V7hSztTheeSESQKyW9Rp/9losSigpqV7sQl515NA0mge4b5BHmPdt0QH9yeF0yDcAG3woX5T2dfhtrIBs46YisQwlnIlvs07e8UAD9Fbxi+MAdKO5kz89RUzIxaChAxjWWwKtXtLL5Ltay4uuOhHZa31jT7hjURW6S1ZAjbaW8a3mcwaE+o8o1t5c8tyP8jaRwdrWimGUh9Jo9PoxQPPM72EIHSxbQC7mCzAtSXTR06Rqq/Y2zPvIGVoQ4GtPRm09E+w1UPs05I6QZo09k5VDRYIyLYDPr9je111zpRjblk1HEefBePJ6h2/LR3MoSlyVTch8DZus+nyzHoecWjuPnz0ftj9eXdMniYTeC5k7O6ftjd7jfkvZhTvWu/+18WFhPnfSEAN+nC2+kmNoytvd3HxsHUBf4PoRMD1GVFg4OEWUEF2yWQOy7k6BiWhbk1wmgkeHu9X9t8NBMaSbpIMZHWqYfyOikOqpnh9r1ZU1m7G9Uc/7tvhrzufDsLhWKufA1N1doa7wlFMsYuIydksrG1k07xQwbCaWL/OaNPOBmPOebmrg+utgl4n8qG0AZE5bC8MCTxjvBmhhNcrUehA4FibLOau3L1gxe0Z7LZwKsMprnwrfYOuuz7Cc9txqzUPaWOM/yigroLCpgPeAF1veoDJNwIGRrWgSNaiG1+epoHmLyjWDDZWz5PlJZR8Xt2oFZHwbZ1dNrdjgj5DhNNZvpQs16x9GlVnt2FpRm9Fq459qZLyFu3mHH2Dg2Rvg+XG6V0hIO/Z3BsZPcok0nU3nlqleJjMH6dpYqUUculPwhu5gTDdnO6CHJkrq6UMWdSZ+ytjLXWc4x6Na005mTmf9PLz5/W3/KwM/5+WDMcaM9A01E0jJZCUfWSCVKYAN7yV2pTNUGrXLIoXXq2I+ZRvDmdkabGxYUmtkEq3qRoQ1JyWu8euA9jBevqD3az3SgFLsWOwbmDFeC6RSfnXbRQk9DEQ7rI9xvkLhwxzkTbEVq+jAVjgzmUajs1ikkbduYTSsvHr6f3RJiZ/8ycLraw6HNUdFtt7IKzykuSqiUIWFO4Nfe+qcYDWnISwgVhl1O0KQVrdvT0FDT3yV0qim9WnNHBSU5eNtWa6sjKHmIDAnuNvlQ/XxgGVBCwdzbfg1I9JtQY+y6enn8sXaxT0e/R3dCcl8SgTDadEQmSHKMaK0/pw2617hmUU3+jMbG1hZp1WF7ob563r7EVgMxfcaZ70tpCymExdYl7pKyeBvd3U5tV2yQlIaACaWiR3rWFM7aYm+yqFWmrwskjFbaPCGQlnfI0MhOs9999KGLjS+ItDN6V7OvPdIi7CN1KH0QSySNXo2bRaIEVGRfB6/gdaPiHcwIN/X0cHPBOWMkmAuykLtVMRDgMD/At0jVETV/QfzF94QBTCcX26MbnPR5WqU/wcVgOp/sYd0oaVl+7kt9vC5guohn61wEZde/RTSQBPn2Kv1WQKZbTOqAEbYJbMsGZXZ2yJELcU7JPllRT75NBm85W25/gNa72bkyz+6ivzLy7g6Y7Z9HXmRtN4ejN0Vqc1VLHp4uahWiuRH3Dw71tApKlcMEZ1I2Sn68hAgAtg9Ea1+GUsLCw7osHiQd6I0sESeTqFiaVeYC6dXanF5J+OiG05iRSkDg/shOzrBCkEhl6eSBN5EBk0UJtmqjTS7kKy4zNX18BMxw6ob4fqUlxe29dX9Xv/4ENaMQCIhtEECjCu1xxmHvBvWekMWi1t7n+60FVuKywanLIFcBq1pXoSx33OJVRafpWpmfirOoq8vWvdFEwLolq0/E40D3uhBCoOf6xpuT61Sz8UovzzeFS9AY97Xd+Iv1FgXi3iyWEeei3YxmXNUzKbcgannmKqDI3R30MCSPgm3t61ZfIBrJHYsWRxR0lXnP4fBbivhdvecv3fFSoYI7gwOBUvkfUdjHO3MzoIs3T+Q8pZea5MeTY9q3O592N6W7f4CfTTvs9Ml58nsABH8eVhkkhB7WNt0U5d6YHvDdXyC91XJ/7zhgEu6TenLAds1CEDhnARDSncm936fAI9gsehoB8AhNeSe2xGUtyzaXKQ35Gn1peG9Wm1sBOfGnNv0Fb0tZ3Qf4Fu1sziOk90WyM6PVFpa4WeqOPJaFzPaf+jLYF98yMBQZeBuBYY5p9TPbCtv2e3aq8vPjdRoUeybFqKSorpGe+i5UihMZloUhkgbdnQ=
*/