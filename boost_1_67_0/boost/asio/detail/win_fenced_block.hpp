//
// detail/win_fenced_block.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_WIN_FENCED_BLOCK_HPP
#define BOOST_ASIO_DETAIL_WIN_FENCED_BLOCK_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>

#if defined(BOOST_ASIO_WINDOWS) && !defined(UNDER_CE)

#include <boost/asio/detail/socket_types.hpp>
#include <boost/asio/detail/noncopyable.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

class win_fenced_block
  : private noncopyable
{
public:
  enum half_t { half };
  enum full_t { full };

  // Constructor for a half fenced block.
  explicit win_fenced_block(half_t)
  {
  }

  // Constructor for a full fenced block.
  explicit win_fenced_block(full_t)
  {
#if defined(__BORLANDC__)
    LONG barrier = 0;
    ::InterlockedExchange(&barrier, 1);
#elif defined(BOOST_ASIO_MSVC) \
  && ((BOOST_ASIO_MSVC < 1400) || !defined(MemoryBarrier))
# if defined(_M_IX86)
#  pragma warning(push)
#  pragma warning(disable:4793)
    LONG barrier;
    __asm { xchg barrier, eax }
#  pragma warning(pop)
# endif // defined(_M_IX86)
#else
    MemoryBarrier();
#endif
  }

  // Destructor.
  ~win_fenced_block()
  {
#if defined(__BORLANDC__)
    LONG barrier = 0;
    ::InterlockedExchange(&barrier, 1);
#elif defined(BOOST_ASIO_MSVC) \
  && ((BOOST_ASIO_MSVC < 1400) || !defined(MemoryBarrier))
# if defined(_M_IX86)
#  pragma warning(push)
#  pragma warning(disable:4793)
    LONG barrier;
    __asm { xchg barrier, eax }
#  pragma warning(pop)
# endif // defined(_M_IX86)
#else
    MemoryBarrier();
#endif
  }
};

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // defined(BOOST_ASIO_WINDOWS) && !defined(UNDER_CE)

#endif // BOOST_ASIO_DETAIL_WIN_FENCED_BLOCK_HPP

/* win_fenced_block.hpp
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
*/