//
// detail/impl/winrt_timer_scheduler.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_IMPL_WINRT_TIMER_SCHEDULER_HPP
#define BOOST_ASIO_DETAIL_IMPL_WINRT_TIMER_SCHEDULER_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>

#if defined(BOOST_ASIO_WINDOWS_RUNTIME)

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

template <typename Time_Traits>
void winrt_timer_scheduler::add_timer_queue(timer_queue<Time_Traits>& queue)
{
  do_add_timer_queue(queue);
}

// Remove a timer queue from the reactor.
template <typename Time_Traits>
void winrt_timer_scheduler::remove_timer_queue(timer_queue<Time_Traits>& queue)
{
  do_remove_timer_queue(queue);
}

template <typename Time_Traits>
void winrt_timer_scheduler::schedule_timer(timer_queue<Time_Traits>& queue,
    const typename Time_Traits::time_type& time,
    typename timer_queue<Time_Traits>::per_timer_data& timer, wait_op* op)
{
  boost::asio::detail::mutex::scoped_lock lock(mutex_);

  if (shutdown_)
  {
    scheduler_.post_immediate_completion(op, false);
    return;
  }

  bool earliest = queue.enqueue_timer(time, timer, op);
  scheduler_.work_started();
  if (earliest)
    event_.signal(lock);
}

template <typename Time_Traits>
std::size_t winrt_timer_scheduler::cancel_timer(timer_queue<Time_Traits>& queue,
    typename timer_queue<Time_Traits>::per_timer_data& timer,
    std::size_t max_cancelled)
{
  boost::asio::detail::mutex::scoped_lock lock(mutex_);
  op_queue<operation> ops;
  std::size_t n = queue.cancel_timer(timer, ops, max_cancelled);
  lock.unlock();
  scheduler_.post_deferred_completions(ops);
  return n;
}

template <typename Time_Traits>
void winrt_timer_scheduler::move_timer(timer_queue<Time_Traits>& queue,
    typename timer_queue<Time_Traits>::per_timer_data& to,
    typename timer_queue<Time_Traits>::per_timer_data& from)
{
  boost::asio::detail::mutex::scoped_lock lock(mutex_);
  op_queue<operation> ops;
  queue.cancel_timer(to, ops);
  queue.move_timer(to, from);
  lock.unlock();
  scheduler_.post_deferred_completions(ops);
}

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // defined(BOOST_ASIO_WINDOWS_RUNTIME)

#endif // BOOST_ASIO_DETAIL_IMPL_WINRT_TIMER_SCHEDULER_HPP

/* winrt_timer_scheduler.hpp
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
*/