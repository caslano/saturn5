//
// detail/impl/epoll_reactor.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_IMPL_EPOLL_REACTOR_HPP
#define BOOST_ASIO_DETAIL_IMPL_EPOLL_REACTOR_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#if defined(BOOST_ASIO_HAS_EPOLL)

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

template <typename Time_Traits>
void epoll_reactor::add_timer_queue(timer_queue<Time_Traits>& queue)
{
  do_add_timer_queue(queue);
}

template <typename Time_Traits>
void epoll_reactor::remove_timer_queue(timer_queue<Time_Traits>& queue)
{
  do_remove_timer_queue(queue);
}

template <typename Time_Traits>
void epoll_reactor::schedule_timer(timer_queue<Time_Traits>& queue,
    const typename Time_Traits::time_type& time,
    typename timer_queue<Time_Traits>::per_timer_data& timer, wait_op* op)
{
  mutex::scoped_lock lock(mutex_);

  if (shutdown_)
  {
    scheduler_.post_immediate_completion(op, false);
    return;
  }

  bool earliest = queue.enqueue_timer(time, timer, op);
  scheduler_.work_started();
  if (earliest)
    update_timeout();
}

template <typename Time_Traits>
std::size_t epoll_reactor::cancel_timer(timer_queue<Time_Traits>& queue,
    typename timer_queue<Time_Traits>::per_timer_data& timer,
    std::size_t max_cancelled)
{
  mutex::scoped_lock lock(mutex_);
  op_queue<operation> ops;
  std::size_t n = queue.cancel_timer(timer, ops, max_cancelled);
  lock.unlock();
  scheduler_.post_deferred_completions(ops);
  return n;
}

template <typename Time_Traits>
void epoll_reactor::move_timer(timer_queue<Time_Traits>& queue,
    typename timer_queue<Time_Traits>::per_timer_data& target,
    typename timer_queue<Time_Traits>::per_timer_data& source)
{
  mutex::scoped_lock lock(mutex_);
  op_queue<operation> ops;
  queue.cancel_timer(target, ops);
  queue.move_timer(target, source);
  lock.unlock();
  scheduler_.post_deferred_completions(ops);
}

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // defined(BOOST_ASIO_HAS_EPOLL)

#endif // BOOST_ASIO_DETAIL_IMPL_EPOLL_REACTOR_HPP

/* epoll_reactor.hpp
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
*/