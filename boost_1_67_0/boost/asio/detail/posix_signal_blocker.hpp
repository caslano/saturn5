//
// detail/posix_signal_blocker.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_POSIX_SIGNAL_BLOCKER_HPP
#define BOOST_ASIO_DETAIL_POSIX_SIGNAL_BLOCKER_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>

#if defined(BOOST_ASIO_HAS_PTHREADS)

#include <csignal>
#include <pthread.h>
#include <signal.h>
#include <boost/asio/detail/noncopyable.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

class posix_signal_blocker
  : private noncopyable
{
public:
  // Constructor blocks all signals for the calling thread.
  posix_signal_blocker()
    : blocked_(false)
  {
    sigset_t new_mask;
    sigfillset(&new_mask);
    blocked_ = (pthread_sigmask(SIG_BLOCK, &new_mask, &old_mask_) == 0);
  }

  // Destructor restores the previous signal mask.
  ~posix_signal_blocker()
  {
    if (blocked_)
      pthread_sigmask(SIG_SETMASK, &old_mask_, 0);
  }

  // Block all signals for the calling thread.
  void block()
  {
    if (!blocked_)
    {
      sigset_t new_mask;
      sigfillset(&new_mask);
      blocked_ = (pthread_sigmask(SIG_BLOCK, &new_mask, &old_mask_) == 0);
    }
  }

  // Restore the previous signal mask.
  void unblock()
  {
    if (blocked_)
      blocked_ = (pthread_sigmask(SIG_SETMASK, &old_mask_, 0) != 0);
  }

private:
  // Have signals been blocked.
  bool blocked_;

  // The previous signal mask.
  sigset_t old_mask_;
};

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // defined(BOOST_ASIO_HAS_PTHREADS)

#endif // BOOST_ASIO_DETAIL_POSIX_SIGNAL_BLOCKER_HPP

/* posix_signal_blocker.hpp
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
*/