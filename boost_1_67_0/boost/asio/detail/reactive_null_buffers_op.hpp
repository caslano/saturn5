//
// detail/reactive_null_buffers_op.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_REACTIVE_NULL_BUFFERS_OP_HPP
#define BOOST_ASIO_DETAIL_REACTIVE_NULL_BUFFERS_OP_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>
#include <boost/asio/detail/fenced_block.hpp>
#include <boost/asio/detail/handler_alloc_helpers.hpp>
#include <boost/asio/detail/handler_invoke_helpers.hpp>
#include <boost/asio/detail/memory.hpp>
#include <boost/asio/detail/reactor_op.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

template <typename Handler, typename IoExecutor>
class reactive_null_buffers_op : public reactor_op
{
public:
  BOOST_ASIO_DEFINE_HANDLER_PTR(reactive_null_buffers_op);

  reactive_null_buffers_op(Handler& handler, const IoExecutor& io_ex)
    : reactor_op(&reactive_null_buffers_op::do_perform,
        &reactive_null_buffers_op::do_complete),
      handler_(BOOST_ASIO_MOVE_CAST(Handler)(handler)),
      io_executor_(io_ex)
  {
    handler_work<Handler, IoExecutor>::start(handler_, io_executor_);
  }

  static status do_perform(reactor_op*)
  {
    return done;
  }

  static void do_complete(void* owner, operation* base,
      const boost::system::error_code& /*ec*/,
      std::size_t /*bytes_transferred*/)
  {
    // Take ownership of the handler object.
    reactive_null_buffers_op* o(static_cast<reactive_null_buffers_op*>(base));
    ptr p = { boost::asio::detail::addressof(o->handler_), o, o };
    handler_work<Handler, IoExecutor> w(o->handler_, o->io_executor_);

    BOOST_ASIO_HANDLER_COMPLETION((*o));

    // Make a copy of the handler so that the memory can be deallocated before
    // the upcall is made. Even if we're not about to make an upcall, a
    // sub-object of the handler may be the true owner of the memory associated
    // with the handler. Consequently, a local copy of the handler is required
    // to ensure that any owning sub-object remains valid until after we have
    // deallocated the memory here.
    detail::binder2<Handler, boost::system::error_code, std::size_t>
      handler(o->handler_, o->ec_, o->bytes_transferred_);
    p.h = boost::asio::detail::addressof(handler.handler_);
    p.reset();

    // Make the upcall if required.
    if (owner)
    {
      fenced_block b(fenced_block::half);
      BOOST_ASIO_HANDLER_INVOCATION_BEGIN((handler.arg1_, handler.arg2_));
      w.complete(handler, handler.handler_);
      BOOST_ASIO_HANDLER_INVOCATION_END;
    }
  }

private:
  Handler handler_;
  IoExecutor io_executor_;
};

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // BOOST_ASIO_DETAIL_REACTIVE_NULL_BUFFERS_OP_HPP

/* reactive_null_buffers_op.hpp
q1uTMwaaRnRhG8KaJJFGoS+pt34wFow/YYKP08MGzr0nc7tQWi4PX03ps+A/CEghrDxj2LWZHxU0vjoD7Wk8NG50CXXBXFEr06580eEslbjxIQB9erafN+NiiOjtQ1MkUfFWu5MeIG2Cj3phqFmYYzUUb93R/vonh3WrPIZM+6J67xxqHtdga7uz2Xo/wtNqqHAV7qsB7tJFckkGx1PDdCpp4riedbj1IwEFe8ZdOminaBdVdnUhqiU3Ttf0Qh5G843jAPxaOiIKwzFqVfaHqVVN0XM053iX3Z2Cwex2kq4hLJ7Uq8uW8xjxiYCVgdzN0RoQdYW63ZJza7EYXT4Mpmuy7yOEIjavulLh9bzcYfXtuXkCP8d1+qrPnwafoCVwDEQLy2xYY5rLTTSlZXxd4kB6yxVphpg98Inrhfibm6bCq7yzE1AFgdTyphqdqHH+Qu+YXK4eSyUNBoVVfYqMPF10+wDzlGh6wV46qbNYBx1mcmiR9qfygqfR1dpLPEETOS87ISKExyLLoNoXdbufdhvZnYWRcWdznbLUiawFPuMJ4GdcH44jS1Og1ecXrR15iYH+ZkYF96bcdrpeLIIbh6qgrbk7Mz1fTpq50ZS7KRTzpgO5UvILN9ITbhsH+oNkwwl+g7Ik0PaN5pD361FRu1dMbVfnBarcuTCk8lLJ7/FbJckLytlO7R4l0ZqlwOOGqUxDvKXDfzot+XA0SqgaFYhq+fV4OCBofSWoLnKnBf5R4TbWMlE1HWhj7FKMSUC55kUnywczzpYHhOchuvbcLxM6v/pVYpbC1CvvuA7hPMJj95cveLUXaDSBlOEfgrZR3J7yksyxMJqEZd8jBtycYRqtY1SaqbTxclr5iKyXXxYUcAuhEcpX+Xx7CSQWYeVsa7tapFP4C4XCNzddytwlMHQFZFzXe+G98ddTzKcAM7hrEzSwN0SW5r0ag0q9gyziHI1x/XlXRfX48r4kofo6JE9CGIYnR8XX819eGb6UwETMZN75QB0ez28ij+HLYZzrHiuSUtL/Mn0BY+/9VQ4jud0zyTapiISgPpYpP5Ndrdh0oqMvry44RitrVdW2LDg1Rx3Eo0PRDbzrpqkYIq+eP4oTaRSj34yK5/ucHr0+xb/6qjq83NWJ56QsPYvoyRXVXHUOvqu5fkBOv0LA8bCpL0fXfv7s9FWLD1bNk7jzpvbJEU7VQws/9rytpRDwBPEewayE/JNkWt8WM4N6OmXNgm16leVdgcQ6jBzqHYQGbh/s5RiznL0Af+PG1pvB+uDJmnoSgQMm7dP91/21V/qWTDSzs28/6dxJDR2Uh4txFrJj3YiuvPw0kC5UGRq7+O2dx8HvzS2xOi2yOsizOhr21BDay7yreT309Q12/qFbk1yDeajx5SbeUOq1w+uhyTeODbJfApplv1zw2DTJJpWib+y0X/Ac4mpTn7sln9dOPrj9Av4SN8hmyd3wRA6C9ecWso4dlsUsmUbAehWc2FttOtQjhzyHpxl3N4iMl/Jj//PBI/BJ89foEfhAAgT+oFlJ2Fl/0CASIOgHzQbeAP6g2UmA7D9oDhIgxw+akwTI+YPmAm8TftDcv/7UzYKVhPWHWTDB+sMsmGD9YRZMsP4wCyZYf5gFE6w/zIIJ1h9mwQTrD7NggvWHWTDB+qtZbhLQb8Ey0A+zYBnoh1mwEPTDLFgI+mEWLAT9MAsWgn6YBQtBP8yChaAfZsFC0A+zYCHbr2a5Sdh+2GUjYfthFpzP9sMsOJ/th1mwAtsPs2AFth9mwQpsP8yCFdh+mAWTP6xykLD/MMpJwv7DJtdvjuUmYQf9T4ULWVlYfjmUcnP+OJSysjAryujamZGws31v1u9OqPsApG9HFoDB94Paf8v59NvREgOgCwVABUCggo99gP9a0O/+tHh/BoEE3AfySnfO/1lQQPB/MoTHzf6T3v4f6mDc+w6G+kNvwsLAwUODsyjAnQwJAQkD81suBCQUNAwsKrt9BZaQvGLUyB87PVaOJe3+1H1OnrG+z7iivAFjb97Y0WBa93kwPLamOlSpQAxdtwryBFygD0nHjgWsi3gLv1lbH+w07vxRC5/ZxgqvpAaUuXZfmC5SdMrCqxGsY9sWO9cPTqGAHw6xSk1GZuV8iBAVJhP7V4v6j+MCz+LOjThKSMf3eMxMvuh/NFU/dk6KiU9xy+DPEcC1KA1kd1VJmGLRbzOdOXZOnDByProv4XpjUeuOJ9fRnFs/kRg+mn2tcenaaFhzw6Mz0Jz7mHPUxevnY+TfFgxkYwH95wwSvHsP/3GQQMNAwcJBgvNo7kcJAMz89qKCRwkqGjQ6hqJuFAwpOVBeIVKI7I8j5WD/9uAzIGt570z5EHTk17xt8+qK4Ol14m0utlV5+1BP83Z8hd4gFUb/oOcORXIqujZB/9BpIsLlFmicnzHpu5Ehx7jr2a/SUpOh/c32leEa8Z6jzuEDzfYJh7Wx+28n1nVOFvSPreapGiwNr7JOa2NvdM4JS3kxT7VHeXu+pkTUfolv2H03bvZ0J9V5C1EQebJtVrkYVHjFT1peivX9GuCRFSWR1Ao5SXe3YWtXFaZRZdBaiod5nFNVW4k86kFq4rgVe0gGqUeN3H1z/keDiuzc/zmDBec+GvjHWRsOHgYWnEPybUKB+t188uuEImRfIf+TGZw1kR5EA6Dhw68wOmM8VobyOXu60NFk+lUT9H7tXlBs8vx7PbgyMfHRAAyiR9MgV6yLAu+PV1RWeovsriW400dXYMHEh6Lvig9zevt7AUiDw92nieLvLt0F+LCySznje9Tid4Coy/qH0zPORO9fgueY3K7XY5Xrx9z0IH4jMr6nHjyzOiTje+pmLz6GPyo0G1i3ApcYIW/vWnnywUf4W5f+ZACA/kcX8P8Fa/a3/e+/pYc52f5zevgfBdxxUP68loPLoKP9sZsXZ688wRnS/BSE8vu54jl/hYJ4HQYS8BSfP8I6jW1ub/4TKJgwHQZXIgWfsYam6ddji03ZrRlLavsryfwzX7H/m3zFwc7xn7V2Qv3RXTCwcNBQ92snCwoAAgoABwf52+J5PyGioqHLKyjCYGAqRb1NxyKFJaMAekcOC+n+yY8D14vfLjdCGmjxR/TkHdvbz6PMgAUZV0knvS5tom6hDrJSBTo9QzIz9DCoR8Bxbrp8Txq7A8uBz0Ero9vnwuRjoO1zocZ6Tu+u3PEvPv+KExnBE27cDqq8ItQQNHsimcUd7v4ytHQ3Ln36fVV/dIJI3AW9qF7pNFBk4cvbhbdocm5Pn7Dua39bSUum3/I2Gwme8ow40AbPZO08GcsNpY2yHMrfl6u+ugNI3lRFlyDzx6+JXbgP78TD79VdqsJmqaUo6cTOE9VGhNYnKt9IKW7n2il+xcheUKzNvwpiWh/3VAjKnxu76cCO3jf1WA6urdQZyyhwZBe0EVvjTUitydi3UD2lKUgekJuTd5Zdz92nHRcOMogcVG3UUNbelrnmRPq0kBV/LFuuVWimWqw8kdrquuRvAZPdB8pJ1pMcr4rZUXbI/bL/nsrRo495DNzk7JRxanXZbAbxFotvnlJlZKIyNKzBNZy1TftQE8zYolVNhygdWDEH818S/PReiuPfNatxc/3nz2qk4Fnt/hgC+OO2ARVDMer+RYn86fSm5979lKfXrVV9YsSRZEJx/ZEFte0jQ4EXEyOzGEfZv9Ty2n5yT3VMK4Xe44BbNH65ev/4bU6zadN3ik/lZsH2XmH0G2UctFg/qDEzrPHie2GWD04hXhB1DOwJ/2Dt5/x3+fDXX4T8B/vwXy7+v7gNAJ0T85YGAIAsUqZ7+U1NykSNFTyJ0HUo5Hj9ScHkZ93+b4uZgP6DFhkcwF8WfkjwKnPvEJS/OAQS42eHMfDnNTwA8CAn7ruSj2Eeh7qPYSLDtFEfh1rFwDvz94aJjB7NOt/PRqy79UwAAPsjkWc//TnFvyuW8r9248v67wpEsLP+B0WrfrKZAp8fIb+NdJr7zRTEfRzid4EIVCg0dAx5xShoUnKggm4kzJ8DEVcylqRqRlgUV+5SE3rYtV8lxt8TdJdbHpG3lxhz3nYyLoig1QbfAfSxDkjfaHbcAcqDHSPaS/TuAFMd9d16qkDP3dpWZfXoGGXjGyHjgHzLhILSk4S3e+Wq03rDbFFPuGmn7ttBBApX357gLnWj6KdL0QhpUqkccF2i0n1KRFmpjFdst8TbGs1Mv91sG703MeaxRu9QSXyirTrusYa1YypoG1aVeRvce1k6lzFvIbEvPzHmOeyso3wVrVGcd9PLMxN++a1oMLhQrYSG/B1A5g7QZjf52j23VuXQtTSLw5NSu4G8mLu3arLuUkTueG9p3mRQufJGR9Kk773CdT074/GADOTWN9chc8IS4LZCQ0ACvAGPvUgeU2ZrjSUUm3JQOUcpFmxb+Ioe8A0mnJoKk6HpbTtVL01QXrBtn06TVplhP/4HJ2DWf1cI5J+HsNn/l4SwWVn/76bjv77pkH7gDgJA5iohGPwS2yyLHWUB0Dk8znn8XfB7hZ8F+lj/XXEeEOg/KND306gweC6GAudR3Xc9DAQ81B/uDsAHW2gMMiHw4TaSXDcK+NNtCILMvuWa9jFRnvodwMpU+fgdMMS50WS8V6OTb7pHlUZ791TNqI89yvQX1yC55uv0CW4z0vMsPLkDyJsRc0Z5mhG+dilPZ9+WI2KyuXxt2cWuhbPgnNkxTm80Nhq6kXg1Tk+XfOwq2ZvrtrAw5z7qar7nbfnLYqJREda73PG6w7+74fk/uAJg/beFnP7/9I5928YXYkol/Bgp99t4hHKl/LRfBL9X+Ok79u+KHrGCOP+/sLH/WawPEkP+p+8UPInXj309AEDjMFuRPmnZG6BVT1X/SubVbsLetA5z7I/fyfZV7NaAd/Vj/2hB/7eFJv7X7uz/bYGDf7Zl4vxfs2X6j/iRxf+G7v5/ADJVwKfrRQCAQ0vsnXdQk2nXxkGkSFFQqhBAOiJCCCGhKgECAkroTVpQQCkqvcqCUqWDioIooPQgoYoISCf0EkBaWDrSWwhSP1133p1dd9/dmXc+1hn5I5M8k0wy5/fcJ/Nc93POdb7i/nd3Bn403KCD2iY4xP0L7gOTu5Dve+Oe/EuXF+ALYjKS31+ikJzSiqY7Sf8tawq3NIqATS59c09zMz9X8jTSTSbzN6g5m1/v23+suzo1KIvPTByUF8Y22Sfqttk/u2kt0ewilmDN4JRgbfSkNX9YPW1QqZBr49eLebkXGe5E4ifX3/xl1ybowPTyYXp8wf3v1kP8cLgPTKke4v6C+8AU6iHuL7j/XSX6w+E+lKUHivtQlh4o7kNZepC4xQ9l6YHi/i7uwv44uP9dVfkjED4UkgeK+1BIHijuQyF5oLgPheSB4j4UkgeK+1BIHijuAxOSwO+oFIyJ6I8tn59/iPSfMMaI5XISEf1WGPS13P+3wqBfy/1/+4Dvn0AHH5iclPiOurL/BPrX0iCWL322JL8vGiJh0Iz+i7L/X85WqTGenWvyFtb9wcNKzdF/8Bjr6ur4epvtfHP+z0QkCCz4r91RwYed0D92JzT4oCQx6Hv6W2T94t9J+rsF8PmsH/2apey/rIGjJN+0tWmeAf6h1ZNAqCzfIaKVJyLSkxVifxh5iSfqa+opNJc4dqwuDBXKlLnxnx/GfD50XBhK/M9Bc9d0wtiTrd8/9Rfbf60FJHnsuHiViAl9UyS0wKjOCjLStCGstKJna5BTv/3JtC6j4myrLUP8iO/5kE4pzr+w0AQfWOnzYWZ/n5n9z/YGLls4O1/nNAZyAr8YiP6T5aDsaOHxJ46Wv60ITqjYf10R7gOWTy6djfdZGCjqV8y2smApMsf6a1LBhZmPMop2fDhCNmAcpaZNlc+sQjhyiZGo1Zo2OZmUi9qc9spTmotUwdrMbT8RnXtJdDxFR/4yGdHbdLnCb4P/Z0r9/yN4cdDfBW/OebxFkfgctQ55KmOYkejNqgzSX14QMSJGvMkYr10MhRMB4M/dvjU++/eiEvv7qJhJU83pw/w1RSnhVeaf8y6OiPjbCCT+djKpmJiouDgI9L8a+37+MjEIEAgCgkT/h8mkEMgfjH0h0G+MfSES/zH2FROHQkBwRVEIECwmDleCSUIl4UAoWF5BVAEIUhSFyXHKQMUkxCVgUAgYrAiBQoEwmIIYTFFJCQQGKkoqKYDl/6uxrxhY9G+8ZGk6KoVqidnqVwjaEJXHI/pvKaITOT4xLLYRhkql3Ra5QrRVye71WEnEN3JwksXGyKtGh8urkvn6X7gYV7eBp37dDpJp7ia/KL4Fh9FBU9tkX1rplETO7iOcmcBsyWleBAxC+ESGcARSJGOXvG4J0UA7+07JBJUxTYfnQ4yQzl6QJ6GLg8Lvmdm4U4W/S+4UP10GO5Vgs8pwufXFR7W4sGTsGdX9FHPy63IIiSBHiMDS5QASnR34K3udu8oPiXRfd2pBjO7ChNpt8NSoZ6l47c/vRxUbUp2zdHpUlNhqjKPUKyQVMuxnRCF1uXVaffuZSzT2iLVJL374L3bFn1eUOPBHnakK/NuZqvZPpfOvYmgU9d/LyhgH6uxHiiin5Ri+h4qpCNZb1M6b8ke/uUYYjwozV95AGesKcEZfxHOY7W3mTyuP3tojbENerBL0bOfcfOIqn5da90+Ps9qY7LZo3S/23AZ4Z9mva7I+3/i4MNSc7rjNzpvXaXVjbZwgAmu+MUex4JZkjJ/oL9mg+2DklfQ+ntuq/xkBO9rp1dINtuqTfnJRI1ezL9SjCatezWeZm+dim5Dtta7h3GZypaV7K0nt1tVJ3ELnhTzMA+v2ThShwuHFOI7FqcR1DucHrC+7YT8EIrEEgwm7JAsuuH7LxfJmWSMNk5IVVZ9sEwLLhiUjDtXpE2fYTlGmU+UpTd6lYeCZVFB91ylR1njeAkTIBHrihj0k4ByXM4cXgfVdXjc7HcRTA+MGzETDceHjLJAOp5ud7J8qWzM18DNxhIbnMpgbuYCCPq8NirKhLuZXnShkcnKpCw/vldKVRU2HFqdBq87T3XwndFAzszYPZPLQAT3i43U53Of6z5PlNqQ+xvGwrredrfbXtz459zFx48OWs0fzjFG7gLfq9p5ikejrXyaqMrdlo6Rwosep9Zserl1nWSMlnQsNAeDaz1fPbVaGu7f3Nk2t2hS/AdDVwp8DT6hF6QZg0qcTWjVid+cf3jfGS8oJWE5ZOLS69wpEoMPxDaEZuleRVOGm0+t0cz4I0bFLtg8KqDiOfBmo6l83o7X0wa831OzGIoZML7LzoS4byk4g104b5nO8XZYvyDY7f4E9CXgbXVFzl/RKMPPcm9mFuxEazab91ihrj0lvynq/nPjMIBS9nR8mdpzNHxGYszE4UrFDaL6wh0d576z5mu0BdNzuDDE6DFgk9XgihhdQzmVmme7G76yoYQhmRlleGxhd3njwschu9jWdMPZkIz7y00FQiarCe3yKIXc4fRg3mP3ekc//TJPPIlfCeYSdIihXl57+eb2NkNzDUqsHpQls9klBOfUfhGfScgANCFG5mvsWz4vDaDbV+FhjKdTSqxG1CFpV2bW12KONwnc4W/Jdo9aRRem5L/tBGDKLxxV2xDPluVDaFtDKJjS32JMmjGnNs0xpemF0K3HyacO1nkWKhBH0I8FTfez4TUUj4dIlEPTTC7+ajtNnfPy1LVsYw2v5v05UpYVrARDG8KUqYXwmcp8d6yeia2mfBMDBcGNKrjMFTNgF2uyJE+TyFi7RsAbB43SJHjiKNJrLi+pXSjTc05ivP42PrqkY1EA2q9SFas/I5RWtiEZO3TZCECpCe+KVMXn1rCGLJz8q0Bdy52ywsDnE8H+y8VCKTRx6iykg5PHcGMUCRsuSS1/EBpwaUWliaM+4rxw1XV+wfMOi3VOyHfwUs+YUtrs3eYHO6/4kRfvTc/dW6LxO3TzG5bcBDNd43h3itgCbui2V4ULTzZ8bLL5ySU/4VbwqhnFLfEDvZMTDQs9qsSh+35oHUmkV7CbZbND5qk9YRsxpZANvYZJ21vWjd6Q3XLKC0po9kZEXewbqf1J55k7OIhMjt9gOVFa/zegWbxIcu24udpQFVBHUeyWHhmNu14Ce1nG0+VSljBUN0lKkPZzavMCKxlGdxxaNpd5CvVEpIL91Q6S9nAn9PIQ6K7jRIVR+kEm37sISWbsLctcbKYUZacnC82c7WKFfmRdgPtViYqytBo4wSfIsvz4DWm6JVxYwhqjGOIA7M7FCzsCwy9MFFJBU6xoX2VPEjFRTP8HsLGc6RirMk3kSa806TaWPLc9Ziyu9Z5UQk69ACtSvvdOmoolTOS5RXb3i6nGEntGfPJIrKiC6FUPp8SjdpJk4BsABM6eF4uNrzhT8HOvCOWpQR6tc8iw1ezWwcyosoDjwNRwpHR/AvcTIa96xonIhS/DZSzujTVk5Ods8yQ9Fwp+yNqBqO9sn9adux4ik20W78F6tJKOcVozmxAaQGNQRk3CnKRRSeywuD7Fen19jWY6hIldvGxy/xOO2SD7mWuxddXqpLV9hBg0W3Z5fGz8FF+6Wq/C9e9LQxNdjNcwsb46Ztin4576qkDvvt2otwe4nMMMlBPfG6DNTtNfL8Vd5r021SOa5nDltB/HmUpSeWYwuCqyNts+7DfVVExyLudE4GKoRw80NS4nPpNeoYp7gq30Q8KwpXSDktg4TODSlV21VYEnyEfrNoKM8WaRRYgo+QhLuPHGLaeS6aXRZEUKwa5Ffho3a6HV93pQo/KWdpcAxLzqE6rtynmDusmhPFOx9VGl9IwLP8KBzvqH4ZFbj7tOM3S35fcrtbo1i0Nb0CnOmpHZTgPA5qkvmBr01Rx7NKIHn8nb4j7LFZkREkxLd6OxiCVMIdslqokq6W1UdP86y+4JHscs9Z4YGwK2/7v/K7Z3FghXxi6I+xJsYzBRVnmsrhXGRXsibi8OjAcM2bh6Bj4TO+1aJqrWQELj8zfLirc8Sy2Wsq+UACnITNB8seiG0HNToV0rDF6XmyxXKg815xHYcPWrOmxfjIy47Ei43V76YFzeYJ01dvVPlm8EGCuygRPIJSXNxrYqgu1qOIemYTElYcxC82HiC52SIYazYDo5JfENB9PE1SSxD/1lNTCcT1iBJEyl3omlyoiZNJwY=
*/