//
// awaitable.hpp
// ~~~~~~~~~~~~~
//
// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_AWAITABLE_HPP
#define BOOST_ASIO_AWAITABLE_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>

#if defined(BOOST_ASIO_HAS_CO_AWAIT) || defined(GENERATING_DOCUMENTATION)

#include <experimental/coroutine>
#include <boost/asio/executor.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

using std::experimental::coroutine_handle;
using std::experimental::suspend_always;

template <typename> class awaitable_thread;
template <typename, typename> class awaitable_frame;

} // namespace detail

/// The return type of a coroutine or asynchronous operation.
template <typename T, typename Executor = executor>
class awaitable
{
public:
  /// The type of the awaited value.
  typedef T value_type;

  /// The executor type that will be used for the coroutine.
  typedef Executor executor_type;

  /// Default constructor.
  constexpr awaitable() noexcept
    : frame_(nullptr)
  {
  }

  /// Move constructor.
  awaitable(awaitable&& other) noexcept
    : frame_(std::exchange(other.frame_, nullptr))
  {
  }

  /// Destructor
  ~awaitable()
  {
    if (frame_)
      frame_->destroy();
  }

  /// Checks if the awaitable refers to a future result.
  bool valid() const noexcept
  {
    return !!frame_;
  }

#if !defined(GENERATING_DOCUMENTATION)

  // Support for co_await keyword.
  bool await_ready() const noexcept
  {
    return false;
  }

  // Support for co_await keyword.
  template <class U>
  void await_suspend(
      detail::coroutine_handle<detail::awaitable_frame<U, Executor>> h)
  {
    frame_->push_frame(&h.promise());
  }

  // Support for co_await keyword.
  T await_resume()
  {
    return frame_->get();
  }

#endif // !defined(GENERATING_DOCUMENTATION)

private:
  template <typename> friend class detail::awaitable_thread;
  template <typename, typename> friend class detail::awaitable_frame;

  // Not copy constructible or copy assignable.
  awaitable(const awaitable&) = delete;
  awaitable& operator=(const awaitable&) = delete;

  // Construct the awaitable from a coroutine's frame object.
  explicit awaitable(detail::awaitable_frame<T, Executor>* a)
    : frame_(a)
  {
  }

  detail::awaitable_frame<T, Executor>* frame_;
};

} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#include <boost/asio/impl/awaitable.hpp>

#endif // defined(BOOST_ASIO_HAS_CO_AWAIT) || defined(GENERATING_DOCUMENTATION)

#endif // BOOST_ASIO_AWAITABLE_HPP

/* awaitable.hpp
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
*/