/*=============================================================================
    Copyright (c) 2015 Paul Fultz II
    constexpr_deduce.h
    Distributed under the Boost Software License, Version 1.0. (See accompanying
    file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
==============================================================================*/

#ifndef BOOST_HOF_GUARD_FUNCTION_CONSTEXPR_DEDUCE_H
#define BOOST_HOF_GUARD_FUNCTION_CONSTEXPR_DEDUCE_H

#include <boost/hof/config.hpp>

#define BOOST_HOF_CONST_FOLD(x) (__builtin_constant_p(x) ? (x) : (x))

#ifndef BOOST_HOF_HAS_CONST_FOLD
#if defined(__GNUC__) && !defined (__clang__) && __GNUC__ == 4 && __GNUC_MINOR__ < 7
#define BOOST_HOF_HAS_CONST_FOLD 0
#elif defined(__clang__) || defined (__GNUC__)
#define BOOST_HOF_HAS_CONST_FOLD 1
#else
#define BOOST_HOF_HAS_CONST_FOLD 0
#endif
#endif


namespace boost { namespace hof {

namespace detail {

struct constexpr_deduce
{
    constexpr constexpr_deduce()
    {}
    template<class F>
    constexpr operator F() const
    {
        return F();
    }
};

template<class T>
struct constexpr_deduce_unique
{
    constexpr constexpr_deduce_unique()
    {}
#if BOOST_HOF_HAS_CONST_FOLD
    template<class F>
    constexpr operator const F&() const
    {
        static_assert(BOOST_HOF_IS_EMPTY(F), "Function or lambda expression must be empty");
        return BOOST_HOF_CONST_FOLD(reinterpret_cast<const F&>(static_const_var<T>()));
    }
#else
    template<class F>
    constexpr operator F() const
    {
        // static_assert(std::is_default_constructible<F>::value, "Function not default constructible");
        return F();
    }
#endif
};

}}} // namespace boost::hof

#define BOOST_HOF_DETAIL_CONSTEXPR_DEDUCE true ? boost::hof::detail::constexpr_deduce() :
#define BOOST_HOF_DETAIL_CONSTEXPR_DEDUCE_UNIQUE(T) true ? boost::hof::detail::constexpr_deduce_unique<T>() :

#ifdef _MSC_VER
#define BOOST_HOF_DETAIL_MSVC_CONSTEXPR_DEDUCE BOOST_HOF_DETAIL_CONSTEXPR_DEDUCE
#else
#define BOOST_HOF_DETAIL_MSVC_CONSTEXPR_DEDUCE
#endif

#endif

/* constexpr_deduce.hpp
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
*/