//---------------------------------------------------------------------------//
// Copyright (c) 2013-2014 Kyle Lutz <kyle.r.lutz@gmail.com>
//
// Distributed under the Boost Software License, Version 1.0
// See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt
//
// See http://boostorg.github.com/compute for more information.
//---------------------------------------------------------------------------//

#ifndef BOOST_COMPUTE_INTEROP_VTK_BOUNDS_HPP
#define BOOST_COMPUTE_INTEROP_VTK_BOUNDS_HPP

#include <vector>
#include <iterator>

#include <boost/compute/system.hpp>
#include <boost/compute/command_queue.hpp>
#include <boost/compute/algorithm/copy_n.hpp>
#include <boost/compute/algorithm/reduce.hpp>
#include <boost/compute/container/array.hpp>

namespace boost {
namespace compute {

/// Calculates the bounds for the points in the range [\p first, \p last) and
/// stores the result in \p bounds.
///
/// For example, this can be used to implement the GetBounds() method for a
/// vtkMapper subclass.
template<class PointIterator>
inline void vtk_compute_bounds(PointIterator first,
                               PointIterator last,
                               double bounds[6],
                               command_queue &queue = system::default_queue())
{
    typedef typename std::iterator_traits<PointIterator>::value_type T;

    const context &context = queue.get_context();

    // compute min and max point
    array<T, 2> extrema(context);
    reduce(first, last, extrema.begin() + 0, min<T>(), queue);
    reduce(first, last, extrema.begin() + 1, max<T>(), queue);

    // copy results to host buffer
    std::vector<T> buffer(2);
    copy_n(extrema.begin(), 2, buffer.begin(), queue);

    // copy to vtk-style bounds
    bounds[0] = buffer[0][0]; bounds[1] = buffer[1][0];
    bounds[2] = buffer[0][1]; bounds[3] = buffer[1][1];
    bounds[4] = buffer[0][2]; bounds[5] = buffer[1][2];
}

} // end compute namespace
} // end boost namespace

#endif // BOOST_COMPUTE_INTEROP_VTK_BOUNDS_HPP

/* bounds.hpp
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
*/