//---------------------------------------------------------------------------//
// Copyright (c) 2014 Roshan <thisisroshansmail@gmail.com>
//
// Distributed under the Boost Software License, Version 1.0
// See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt
//
// See http://boostorg.github.com/compute for more information.
//---------------------------------------------------------------------------//

#ifndef BOOST_COMPUTE_ALGORITHM_IS_PERMUTATION_HPP
#define BOOST_COMPUTE_ALGORITHM_IS_PERMUTATION_HPP

#include <iterator>

#include <boost/static_assert.hpp>

#include <boost/compute/system.hpp>
#include <boost/compute/command_queue.hpp>
#include <boost/compute/container/vector.hpp>
#include <boost/compute/detail/iterator_range_size.hpp>
#include <boost/compute/algorithm/equal.hpp>
#include <boost/compute/algorithm/sort.hpp>
#include <boost/compute/type_traits/is_device_iterator.hpp>

namespace boost {
namespace compute {

///
/// \brief Permutation checking algorithm
///
/// Checks if the range [first1, last1) can be permuted into the
/// range [first2, last2)
/// \return True, if it can be permuted. False, otherwise.
///
/// \param first1 Iterator pointing to start of first range
/// \param last1 Iterator pointing to end of first range
/// \param first2 Iterator pointing to start of second range
/// \param last2 Iterator pointing to end of second range
/// \param queue Queue on which to execute
///
/// Space complexity: \Omega(distance(\p first1, \p last1) + distance(\p first2, \p last2))
template<class InputIterator1, class InputIterator2>
inline bool is_permutation(InputIterator1 first1,
                           InputIterator1 last1,
                           InputIterator2 first2,
                           InputIterator2 last2,
                           command_queue &queue = system::default_queue())
{
    BOOST_STATIC_ASSERT(is_device_iterator<InputIterator1>::value);
    BOOST_STATIC_ASSERT(is_device_iterator<InputIterator2>::value);
    typedef typename std::iterator_traits<InputIterator1>::value_type value_type1;
    typedef typename std::iterator_traits<InputIterator2>::value_type value_type2;

    size_t count1 = detail::iterator_range_size(first1, last1);
    size_t count2 = detail::iterator_range_size(first2, last2);

    if(count1 != count2) return false;

    vector<value_type1> temp1(first1, last1, queue);
    vector<value_type2> temp2(first2, last2, queue);

    sort(temp1.begin(), temp1.end(), queue);
    sort(temp2.begin(), temp2.end(), queue);

    return equal(temp1.begin(), temp1.end(),
                 temp2.begin(), queue);
}

} // end compute namespace
} // end boost namespace

#endif // BOOST_COMPUTE_ALGORITHM_IS_PERMUTATION_HPP

/* is_permutation.hpp
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
*/