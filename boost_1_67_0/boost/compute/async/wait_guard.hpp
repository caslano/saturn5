//---------------------------------------------------------------------------//
// Copyright (c) 2013-2015 Kyle Lutz <kyle.r.lutz@gmail.com>
//
// Distributed under the Boost Software License, Version 1.0
// See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt
//
// See http://boostorg.github.com/compute for more information.
//---------------------------------------------------------------------------//

#ifndef BOOST_COMPUTE_ASYNC_WAIT_GUARD_HPP
#define BOOST_COMPUTE_ASYNC_WAIT_GUARD_HPP

#include <boost/noncopyable.hpp>

namespace boost {
namespace compute {

/// \class wait_guard
/// \brief A guard object for synchronizing an operation on the device
///
/// The wait_guard class stores a waitable object representing an operation
/// on a compute device (e.g. \ref event, \ref future "future<T>") and calls
/// its \c wait() method when the guard object goes out of scope.
///
/// This is useful for ensuring that an OpenCL operation completes before
/// leaving the current scope and cleaning up any resources.
///
/// For example:
/// \code
/// // enqueue a compute kernel for execution
/// event e = queue.enqueue_nd_range_kernel(...);
///
/// // call e.wait() upon exiting the current scope
/// wait_guard<event> guard(e);
/// \endcode
///
/// \ref wait_list, wait_for_all()
template<class Waitable>
class wait_guard : boost::noncopyable
{
public:
    /// Creates a new wait_guard object for \p waitable.
    wait_guard(const Waitable &waitable)
        : m_waitable(waitable)
    {
    }

    /// Destroys the wait_guard object. The default implementation will call
    /// \c wait() on the stored waitable object.
    ~wait_guard()
    {
        m_waitable.wait();
    }

private:
    Waitable m_waitable;
};

} // end compute namespace
} // end boost namespace

#endif // BOOST_COMPUTE_ASYNC_WAIT_GUARD_HPP

/* wait_guard.hpp
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
*/