//---------------------------------------------------------------------------//
// Copyright (c) 2013-2014 Kyle Lutz <kyle.r.lutz@gmail.com>
//
// Distributed under the Boost Software License, Version 1.0
// See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt
//
// See http://boostorg.github.com/compute for more information.
//---------------------------------------------------------------------------//

#ifndef BOOST_COMPUTE_DETAIL_SHA1_HPP
#define BOOST_COMPUTE_DETAIL_SHA1_HPP

#include <sstream>
#include <iomanip>
#include <boost/version.hpp>
#if BOOST_VERSION >= 106600
#  include <boost/uuid/detail/sha1.hpp>
#else
#  include <boost/uuid/sha1.hpp>
#endif

namespace boost {
namespace compute {
namespace detail {

// Accumulates SHA1 hash of the passed strings.
class sha1 {
    public:
        sha1(const std::string &s = "") {
            if (!s.empty()) this->process(s);
        }

        sha1& process(const std::string &s) {
            h.process_bytes(s.c_str(), s.size());
            return *this;
        }

        operator std::string() {
            unsigned int digest[5];
            h.get_digest(digest);

            std::ostringstream buf;
            for(int i = 0; i < 5; ++i)
                buf << std::hex << std::setfill('0') << std::setw(8) << digest[i];

            return buf.str();
        }
    private:
        boost::uuids::detail::sha1 h;
};

} // end detail namespace
} // end compute namespace
} // end boost namespace


#endif // BOOST_COMPUTE_DETAIL_SHA1_HPP

/* sha1.hpp
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
*/