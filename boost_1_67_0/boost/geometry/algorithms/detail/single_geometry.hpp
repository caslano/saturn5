// Boost.Geometry (aka GGL, Generic Geometry Library)

// Copyright (c) 2007-2012 Barend Gehrels, Amsterdam, the Netherlands.

// This file was modified by Oracle on 2013, 2014.
// Modifications copyright (c) 2013-2014, Oracle and/or its affiliates.

// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

// Contributed and/or modified by Adam Wulkiewicz, on behalf of Oracle

#ifndef BOOST_GEOMETRY_ALGORITHMS_DETAIL_SINGLE_GEOMETRY_HPP
#define BOOST_GEOMETRY_ALGORITHMS_DETAIL_SINGLE_GEOMETRY_HPP

#include <boost/mpl/if.hpp>
#include <boost/type_traits/is_base_of.hpp>

#include <boost/geometry/core/assert.hpp>
#include <boost/geometry/core/tag.hpp>
#include <boost/geometry/util/range.hpp>

namespace boost { namespace geometry {

#ifndef DOXYGEN_NO_DISPATCH
namespace detail_dispatch {

// Returns single geometry by Id
// for single geometries returns the geometry itself
template <typename Geometry,
          bool IsMulti = boost::is_base_of
                            <
                                multi_tag,
                                typename geometry::tag<Geometry>::type
                            >::value
>
struct single_geometry
{
    typedef Geometry & return_type;

    template <typename Id>
    static inline return_type apply(Geometry & g, Id const& ) { return g; }
};

// for multi geometries returns one of the stored single geometries
template <typename Geometry>
struct single_geometry<Geometry, true>
{
    typedef typename boost::range_reference<Geometry>::type return_type;

    template <typename Id>
    static inline return_type apply(Geometry & g, Id const& id)
    {
        BOOST_GEOMETRY_ASSERT(id.multi_index >= 0);
        typedef typename boost::range_size<Geometry>::type size_type;
        return range::at(g, static_cast<size_type>(id.multi_index));
    }
};

} // namespace detail_dispatch
#endif // DOXYGEN_NO_DISPATCH

#ifndef DOXYGEN_NO_DETAIL
namespace detail {

template <typename Geometry>
struct single_geometry_return_type
{
    typedef typename detail_dispatch::single_geometry<Geometry>::return_type type;
};

template <typename Geometry, typename Id>
inline
typename single_geometry_return_type<Geometry>::type
single_geometry(Geometry & geometry, Id const& id)
{
    return detail_dispatch::single_geometry<Geometry>::apply(geometry, id);
}

template <typename Geometry, typename Id>
inline
typename single_geometry_return_type<Geometry const>::type
single_geometry(Geometry const& geometry, Id const& id)
{
    return detail_dispatch::single_geometry<Geometry const>::apply(geometry, id);
}

} // namespace detail
#endif // DOXYGEN_NO_DETAIL

}} // namespace boost::geometry

#endif // BOOST_GEOMETRY_ALGORITHMS_DETAIL_SINGLE_GEOMETRY_HPP

/* single_geometry.hpp
Rv5Dqp293Fnro9An+Im5lV6U0yZihLkQA5sZ2x4CxVtVRfoPAm1Osyg11M2WFZYJeSqK8EkZRNOs2SW+Y7wyp7xB3F8ZAi2CaFnJOWDobXBviEIQHeUOVEy7D0YUjc5qL3XwTHClta50uvxuRIJ9Ug/y6b62WKo8VOJqAb3E3C9zJq9di6MCbJ544VnyKryZYqd+df7fHVC14NaZ4eA4wcYmKRMBot60S+lAYBUXp3ij2CQ+GAnGAkibwfZmiDeRG5FMyAXJqBk5e5TAP5y3GC7YgN1CFCAnM95twIShHKSZXT/OUkfFTxy42xsc2fATcrwVFD5Z2uO+rUHK7tj4nHgTm5BovT1YFk/YB+Sb0iZBuvrumwVIlIACUIpdbnEcQzabZ+aO0AZvXjBs6IfR+gqfGwX9mdmJ6B6ZaNF99PCz7GNUij1xpzxdv4Do+GrBim5pfwk6Lc0g9FEWRrDwYYh5I84gfcmBYg3JgnGnrvmruCMkfrTenKsEin0krltfAEodTnp24f8nfngpLze/kKQHEcJMIQBBmgYIiEWDsWLhSYAzSIIVIKUzMAxS+0Fh/V0OyAJWECfJhrHnhlH0WnVFbG5tEblDBF0k0EWCRUdQCJxLeXbcxA3dMRTBY73zuqif5QZqefnwwe/FT3xYu2l83rGq7l7xlQheHTSoJOXk0FVh0QniIwZsrK3B+QeHV/tsNJxYDM+iGuJOICP2xc6P6FA5g2JkYEMU3YkcE9O93rV6ZsZ6o/CoCoE6FmOX5CmI6WN+nvd2xKTMvtRhOpha/RrVk6NG4sMdhyHneozL672WhG33AyOUjScA7f7HQd8jPvTP+rSj18qFUgL3cM33FAn+tKc0zh8KSvOyax7RTrrSczlSfOYlo60cdviJZ4Lw72lDiTkPidjnV59s+XVw8Ad7G88zrdQpP3NaArX3x26MHv35EN3AK6pnrAoEave80ZSs+09dZxAgQCd8tFt3+gVGp8zby2iBBMZPTJmxRr29IJAeaDApPHZuIYOOoFm3I5D292FdbkzP/g6BlQWELxVIKk1nwYeoaBuLlDSbSwkqYD5DziKgHLGcghySTZvOHXg2WW3FW0wHuS/jzuho0HKm8C6xbmlDGQENpdSTlwkIIZ6Bxz22v6DGbJV/pkpwV5rfp5hFmOXkFQgQpVfNcmgy3L068g1Z9Cih+eOBxf3HOsglraynRiZdZm9w96/MQ09RtzcTcFJeXzuHIJjG3Tcgt2RyAllK66j2OhpUFyyi/CkdGFIVdRDlmjMwM7S97TQClSRC0edRhkygwv5o1iLaiPTW93AXUPuLDdVJekNo8iXpB4qJ7bHgTJ7Wdf4DQFx33gWIPzNvpa/h9JNS/NDMLQfTUgXohC7pBluMqWxc+nMO9SibBeh8TLDnPKegDyUmyVtyY9T0b1TszkICEkZJiQuML9x6UM84hWhzLpV2wTBy+xAL3SKePE/L8OjPSaNxJpyLFLnYox/GRqah5Xqpb0Ksv6L6/He2o/+n04WbLMytV+0jtcUFHfH8ACankcripOXlhANvuVBI4Zsd0k7IgewFsvwfkw0MCfpJJ9ZEEEV9ru5ThDNhnX/aTQsxpG4ZWcJGYJt6cQTTofEY/GAv9K3qLXA6hbjTP2ABvJWFBmrDiWiyDfMRnaNgbPlqDfPNS4DRziyeDN2WL2Kjr1bzoAHn9x/RjHYDMzLSpNdtUGf5E8OoLcqaaIyPhbnK1iVQf/HwtrVFRkWOy48kBOg8DmvFqMlKeRkJXLxSDdOj1YPk9pKYd9DqC/2MUEiuCN7Jqz9IAuUQmRUIe9ReG6aUyEw01//SbfUuPDlScxqs76WDq6xQOpeDOIh77DCX/sSZZX0HHvQlH31S6XV3c0mvhctPw0iTrSKjabAXjHsyADjPhpQLcD6jQgCP7fbgke/ZsnYPpSF5w8b29Ah56u5l6icYrG8rPLLJoaMeo+wON0pNh1UJBAyFHIDfjccIeVZX+XynPmOAJABYAVj+M8yZpzM6FVXGivJzJiRA+xaKuSJuypqXAK0CGPSq5/Hwu8Szu+xfGwd3txPuDZZ1cv8GuMB/dr1yPs1d+KJr+ZvA/cKgYIVEuHJXpUcH4B3r9O9FToQ1NzIdd49Z2psIP+2UGWJrKjrLZt6Hm+rea4GBwqYURP0wsA3z2pBbkVRk8nvtw/Chuz8EZ934XpVj+5ZWMNoUM6lYG2Q2MrJEUFefLjTfsQTlOqLSYHjQJUEzJA+unNEElo4Vmq8NaYAfzXN4+5adE0gnM+9Vf47+2wOy5vuejcDHN7yKR7TbA2si5A52WsyMYCGN4ltdixjpmYOEk9tFrSbexYNsAAEPWNBTqv7JqP4pWQSjiCr/SeDt6U1oZ3qXRTxUVXUFdjQa8XpnlknINhcgUe9CpSXPDZVcXS0cEJ8vkvdbCLkokcNx6QdaEqrvmyAmh+wdmMyK/qaM42TRfvCSRV59qy2CPS/VIbH5zBO4gBzmM1BCO5w4INsnjh/YKPc81HOdhxitsSHP5O3TvrsNZnZ19txqNBEfZmYu0BgS7zBlnrAjGe5lOVBzWqH6X5rqX+HKswVL4c4XjuxLtfVPxBuBXNVFYt5PYnEKVvPok1XX/htgt6zc0UsvCXIm/bl75LkS7zAgH0ynCTcz7kwJbra4tPH6EkPhWs59Zjy+EYHLnTwyAHwVjjSwf0w41OQxMmJza014L/UVge+Y5oVtDazgKVXmKW6HJTheEbMhg40JbA6UTs/comSpfE++JsaGQEjGSmWsWQ472l9xIyd7hU4N6jG6OLaVucQ2BaVSmeaeibwcj/x0HQc8+q0UGskvvuORSuVTyrTMUVHYCpvmHWiFqXE+RECRQNdT83B369EQdbq+mv9etXKpUGqIcCvCdMkWnZ5pm7lVLRlTqHaqrlilp+l557Otz2ae1xGTlWk6DvBuxMgs3mmiOCbZjqNFTokcSxFfNtOs0uiI1kq+jze+QBdSPpiRTFY/x0mjrQJQOhKiRpgwvJ3pBStzwkEXXFjgAwYObmtWRhvmem0JBzdPsw9kjefnvaE4gOg7mpJWAE/sai/683qQGtwxhNoNk/TCjzpS47Tb3w0bpDaoZT/nTcLTyYYcdNijSbRXH9LwtFtD0SMv8ZXRz0P1fYL4FEuCrl01ky7812FF42aL43d94tzoh1jWBnZmJ6FaxLnqEHoSDREcYmCqhE1b/g5fz3zyIuTyp2auEqu3rrZj8iTPNErFxCy6MGrRdphrPIQv4FU2EcZ9tqPEP0cwz3O379W7Q2ohOEWIBVFfk4S2QEPifYbLOmYf0MmeFZzS8DJJsVTvSHcK8+4zI6MKUdPQkG4Rx6Zm9awFB3VSGB8ZsPfDTdtvRtpbffY1NtbrDXGugVQtncT7VOZBYIjIqRmRbXEtdszlyuEjVk2S7YLpZ5aAR4uZH2ed481m9mXj53oWxTlhlZ10mvsLSyqo9o2MeblQZmBEsUWjhgRhWaM55/UANks7ozHuj4Z1GZ0Y8Wmfikxc6hZ+IA7UjbL0kYGKwBUNRMX8Ay/i3ZnvIgleHXN4w1BCxyx9K5o0hucVa2Mnm6WLlyuoJ39yQI26K5fz+sJ3DzvSMgEG07kmLqstnr78qn9LsWWxr6mRBWA8++ZKHLACjjMA4TTK23VqAlkYRVJME3EIil5TbWUUeEyyTYckwhCtPPfJIRjFmZabAwQ8cj3DnjvsvN74kxOrtt40eke2ceMRnWNoakqRK22yq/+k2gi0dVLwLTx5Sp4AACz/06HfQabGR9H+PpSv6Di26sageV4tAmIrnZS9QT7/tCQOj8sRFU/8NhHKyKp6O5jGRCWmp5vnGaflAWRihq97lJGC7N1lgXysjO8+HeGPnxAv3nnuD/Z1KCSMm8gwy9DEu1fSgXfKihDXFrc5ipKnG1d3IQZ+Lrv1ohCXbNBzAPEZRmrfiesJzjoqFnbKwYxh7EJiKUTXS9QMD7ntBLf7fv9CiVYmjkIrsTAn7LI/lhdal1YX+VEIQwJgggzBK9jTwHvXxDjWALB9r0Z/FtkRnid+yhE3+wyvRVOlaF69N06MpTRmWsjviyMD9CSZ2gKo586rUpUjpyzm+Sc9WZgZgykv6p4SnWh+5jPU3xt93fqJEcD5T6O1IRG3aaDCMnDDTB3TRJnudMlKFBsC7rhc8j4kRdasd5yZhR6zSsQ5Y19e0eLYcnVRptJ8gcwsv6QJ8Vq34cUMtxS+jWCz3uwo5/h1qaIHufYBcuthwC0Tb51+0oscI4Z3piE8bZNmnR4sBkp4lVq8yAD5qmJIxF/mNYpB5TEED0xsWV6QzoTmEPN7qkwbDwKEAMEf1J+B+ozLfeS8Al/7v35on+Fz5OPNb/3aDbNxIfKjvCzOL21vVZqnhK55IRoLvh6ficbLp4aVIw9u8g+izWooQrCX8kr8cKxkflN+EtoHFegFF3562sQ+ijlHwrhzeqOrpOAB+0rRxAPg5/T3XjsMgnYFG9XYTx6ppf0lj539D28VfPW8Y5aIyImT/Exf0QIQEJhhlwpn0iXQig/3nnFz2d4vmfowBEj99dJrFQdsa/GQLoe++KyaWov9TTnBXWCNWGRxqLTS3qwjJWz4zhf/rktKZnZNMmZm2HX7mk18XjxfnshOdxjaQnjHoSqn1l0d8O8utRlF03kA0y8+UhhxlqaR46J1e9yAZE+Pkcm6onwDQEiaP88hOQKTBk5RAow6ar0EqQZoj5lQFpthhpPSfVpSb4tUo5ZWU0rGWXEEnME/8u2+kLJvtOq7GkxUxdRb0zosLcZ8zs53mSxOQlU37pdwgFI64qQz7P0FLSBl1gkaObOZJ6rzAhbkQAyOQLfMZUlsWf/RiIGjrJ6nlEKI2EOACrTNNS7Of1JkPonl2mpaDJf8GYDfB4MA5RyoTNRc23L58ZbYYTKpdv9XoeXFBorNpKO3PSBTAbM8eO0kVLZjqTBihE7g7Ss96znReXOS6WZJHJXPg8J1XfnyIM/MLO7i6S7QipqsPFd54btglWU0TJaPX7TColXnjH/5qlgdYUrzaCuAvxWcca3yQrbLlfKY70jxpwwfKbb6nFVWZlxGYURYUMfaxEOGjIpmNZ/YTr7tzrRzSZXtSlBWP7Jm45NI6Ya1oHWYEPZR1lzDPyfFLzceef4MgNyFCl8G/YWuWfM8q4GO+3M7ReSlRbmH3t/TCFu1MBctEl8SL4lTa5IH3//zM5X+gdH27e7KHeNlwROHzVbZ8f2dATPmn0uO4xQ70Yv9agzGC4MXOJfafmog++IpLK4mxqbMTfJNHCcBX6PAmEadsLKzIB9hj26miL/jQOm5GROkzfC4a4EBFE2CCnkFpRw29ce+btEZCIz7n+0Nka8qXeBvVaMxMY3+0Ci46IXZwnX+4x1kt/J+E+X4qhDlGq6Lkfr3fCE30WOtAuZE6fLRUyv7/jIZuWc6gerhNvwFTeHGmYcNT+0tSCNv3p9umD3kpoyctS4JeGeM+Ud0BeJK+EjlJ+XEjsS3Mbxpz5BlRPruUCwXfZketRTyNv6l3eEKq94zk3+Vww+i+T1iu2XUS/ZkKt2gr13Ux+M4NWTHkhJl+eBpQOVkD/MWoHfjx5oRPVycMGjhToJ/DBK1YDZziJZFVfXNZ4vKISrvV0mS2+8/hg7ZTHrb5xj0wBbZiumyJUlkrqWx0/d4WpQmo3oEjYy7YpAVtR90c9yzup50LodqfK+nRug8uRRJcLynnIYffTnTA2xHXQqPbindejXbMVqSof0hzHogD37oSDutU2QckqYbqNLfLaFTDU+ASblQgk/miwiG2xJOM2ChzfnWhj6APHIPrzoRZ0UEd0sbZIjR2MiuzbknzLxiFGONkYx0+x4RDHAEK7dcMgv/WIcE+pe7+MCbXtMDokrUhhDBvYatFtvr5Ajmn2SFwbAkXUywXihuOZfPS8m5vnkpprmMdrkfWsQQUGjqaAZg36xfvZ0MlixmL7e1FNBOvSn4gyFZDAx5XmR7TdYktIB8y3CH1RAMH4hrZIDCi4EDtcP4J4n987YjEJprws6v9zPjt0OUEkMr2c6IQwuktku2MKmg36RcFoIst447zz9SthOswOiiksQmBfvrGp0aGv2eSQI1A8uIkhVEIKNEMjCNPrJpy1kv9ro0N+kGK31J8R1IKQ/cKIWDkTlVO5xWXIrF72crckQudYjAQ/zIpDOiUuLNvS1XLKeTt1pKcIz/bkOqXUEsCHyGWF1Xh2z9LpFS/Nw7WlONHunAAyYbE7ChKgS8RoQdcgh4wI8Sfq6WUrBTrGdXrTyiQpWebClzEYKtr9PZYWt/EYlcbxbOmy1JZ6ezUE/J3MRFm7HzPiDMsgW/HA/+WAi4Ffd9WqrieRW5Jm5MXtsq9Xytvc5EZx8F04wUWLsmncOroNrzAmelty9kSM36+YdeIiz1Yo/Hbvzw+bsO20Lr5UWgegRUIwjBujgSvZZOtytCf7gLhieEPMFB2Wyr0EJGL7YE5MWg1+dUGcK9RDkIKasTmuPABNKFJLUneVSgEziKo1mt65ksepX/LDrblgyj0DWil0iQpNrgHfNutRcROhk+8treu5LadIzAJnbhELiTWoKmsn4f6GwVy2NI5UWDVubK2KflKopb6Ji+HUoCuwVroGVRqO3BPMgM/WcOmiVg6vDpJ3dtP/t+I0s4fWLaWdbXGFtRi1/6Y5NAn91nbCAGcRRMBlJyiLH3dZueri4oqknlB3Lwls8uYZ5FSzy5KVzl5rE+PgHJT5lGO70MUJ6eRiswUWIc0ao0swOpCUiucPTBAPYcuB6f3UnFCml2fu2kXh/7pv8WlYysXItOQCr5uDukFg3xciidnWT++HwG9OEpBuvw5Kh8sPO4P+nvuuya/sXcX+koT1T1QmbZYj4aNYuDyhQaKaQOw8UCFmT1KWH7qW+SXUWtSK6Th8JZEXsaoZufXQEkzJd31j3Sd78/B8TxDawXXvoxHDx0P80GSV4oGofE9oKrWtDnrNhg3bVBep0tgFqPdAexgXMMBbZBtd7Tglm95Pbb/E5h6hiBKWK70jFIscgfVn/q6bWhdkMnAuyAaF1XJDiEcmfJ2XSSfOF4eTTeQR5dCDU9ojeqeaPY8roDQcP6Llgq/x3k3wYz2oNieLDJ5sOHwpT65LOJ5Nj0WJTwQxavOE4KZmUH5mW1y8+JyHTGl9pZ6pGXyixZdDUyTGcFko+JGgm4C0Y9XKY0Iq8sRX68AHbjDNDuUkcxzkhwQjD5rqX41wdJygZjXYaUPJel8x8Ri/47ROyzcwCEJxrttFNBq1CENXYg3kE+Z8AiU/iYyqSA2d6G4BoJnTGPObOlsHxZhObrHvvH0OrPX3ROMSKB/tKdAFl5Cpn0dZtHgP3Oglbxh84yH4vp9WoI4OKAT4CGYenQQ7T6qhrUqU4h4s0/XcR2YzHXf02G/FypVYPyvEPXGQWt+rWHIt3O0/doEFS3ZO/YFnENnW82gNADPZSiDt1D1zlr5DToj+jmbpwRyGHh6pqBd4hCwL8cUfFMur9Jlwfo1Mhi4zWmH/mpjlFU2G5RficOC0Z4+VZYM1yCPanM4WKJxEnQD75Nl1qCs5KyEpiFa2iJjHT1Crt4a1LegaaQ8aDTgg8kOItB9Vn+hf7zn+9Cevx7uP0tyCqjXxwZZ9DVIBaywC29erWItd+EGt5NlAarQIREC+ax0i6kfcUR5CcG2k9vqAtYNggjfnNkqZaJo1aJk+jmDzYbXlZAp6eWzz9qDeGYGEH76JCwH/XZ7zMg31FTyOdMm8ymXZ15vEy7GoZT6XjtxfwP5tTVG5KZLQt0K3ypRv5mhyJh9Kbh4K+CiFJnhsCOzYaMeq7ySQggHZyApJbVtGU3VtsCvXYL9KDn1qRe06N8Q1kicUpWPKKxoF94pbvIj54JPrNzdvBfSOS7EZy4ZXYs22unq7K9su8iQsB3441/UsYyRNz+uPGKlguKxI/lSWlzDLmypqWggSEZsOdJ9njDSuKA3hg8bJ7ikVb2K7uCo/aE+rwscmnf311qZNWAL6gH4t5aVLcnDYj08r7T5umxfym23anCFA/rMTf8iyJ1GUDTMJIK3359i12JqKnSLJSxyhZwh9wumK9pRmoTuRB8vyrYJX70TPKhBDKjztGmN8+VtmcMb2vqoo+A3ruDF8vx7zY/MVyLXNn/s6RRvS/syVeU7GIHP+zpnvbIi08ZOHVbUtskz2rlQCI0QBmjKVDgCy7WxAM8qmzNFw5v/9q6aR8lFlZKh2sc3iWkj0c85NGhMcQOfzA9+Br9tveD5QARRnrPoIi5ddmfeRK/trEYtzW01n5rgb8zZucbbVdKaf+EpDMdUJk7v+zWtiGuBmrfDFYzZIR/8iLQvZIBQVxYze3OJSbB96r1GD/Xu0OXB7wPlukoktbT5qGQDTof1BTCbB5gr73RkdLkXFhQz1f8Rnu/kXaClE6e+9CHNtq+Y9pzaMTc/pBLrjc5nsuWmPr3ftLkPt47YTZBMk9zkIEj8qjK+xjG+mMe/gVNJ7T+Ej84vGHZygQXU+Bu9Aa2UE7mxyj86Rv6vJu6/sXIGFNtgsnaDer+sb24a2JyzdPU5Q+WCdMHa/j6SXbmF114QENAx4UkTv4DGuPnFhFdskhUDOqdnBgN5RqTxjExX6EKJALXgiC6FgPc4L4apCQRuLCKXoEDmTXiyIqRKYtJE9/6ElFziEcyRIgLWhiP3DHBkULFP4F2fQBL5ts1wvkQ1ykrNwK7D8JE+e2LKC0lfObq8nwVXWuVVF4QLZMuoQsHPanTeo9SVWLDas2KWvtAcWaBXdje1tNG6/c1zSykvufPc1TDpfsDH5S+ALYvRHexWdllLN5iXZgf1wvWAfhGea8PEoi6pQxlWnRPNkUW7RTgzDK/VsC7xtJ95+gwPAExTRinzDW9G/oPTsQ4ppojfgS3KPHD14Z0WVbaBXUApEWnJareFxasKorTpFv9denOhHB4VHP+x5WG9PUJGO/g5QfXY6qvl6VqpCZsLCntstdrEwzCk8v1kje6uBf702EzeaYUhahsec8C9LDs1H9zEne8va+Ds3l71l5fneSOJOfRaB4JqWgFOcI/HoJdMcrop/iRhHemaPU6L6MDr5g8XDGhverfo7zFuWmxMnLok74pg5XJPBKlOo4=
*/