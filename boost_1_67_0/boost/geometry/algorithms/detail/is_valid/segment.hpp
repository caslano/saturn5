// Boost.Geometry (aka GGL, Generic Geometry Library)

// Copyright (c) 2014-2019, Oracle and/or its affiliates.

// Contributed and/or modified by Menelaos Karavelas, on behalf of Oracle
// Contributed and/or modified by Adam Wulkiewicz, on behalf of Oracle

// Licensed under the Boost Software License version 1.0.
// http://www.boost.org/users/license.html

#ifndef BOOST_GEOMETRY_ALGORITHMS_DETAIL_IS_VALID_SEGMENT_HPP
#define BOOST_GEOMETRY_ALGORITHMS_DETAIL_IS_VALID_SEGMENT_HPP

#include <boost/core/ignore_unused.hpp>

#include <boost/geometry/core/point_type.hpp>
#include <boost/geometry/core/tags.hpp>

#include <boost/geometry/algorithms/assign.hpp>
#include <boost/geometry/algorithms/validity_failure_type.hpp>
#include <boost/geometry/algorithms/detail/equals/point_point.hpp>
#include <boost/geometry/algorithms/detail/is_valid/has_invalid_coordinate.hpp>
#include <boost/geometry/algorithms/dispatch/is_valid.hpp>


namespace boost { namespace geometry
{



#ifndef DOXYGEN_NO_DISPATCH
namespace dispatch
{


// A segment is a curve.
// A curve is simple if it does not pass through the same point twice,
// with the possible exception of its two endpoints
// A curve is 1-dimensional, hence we have to check is the two
// endpoints of the segment coincide, since in this case it is
// 0-dimensional.
//
// Reference: OGC 06-103r4 (6.1.6.1)
template <typename Segment>
struct is_valid<Segment, segment_tag>
{
    template <typename VisitPolicy, typename Strategy>
    static inline bool apply(Segment const& segment, VisitPolicy& visitor, Strategy const&)
    {
        typedef typename Strategy::equals_point_point_strategy_type eq_pp_strategy_type;

        boost::ignore_unused(visitor);

        typename point_type<Segment>::type p[2];
        detail::assign_point_from_index<0>(segment, p[0]);
        detail::assign_point_from_index<1>(segment, p[1]);

        if (detail::is_valid::has_invalid_coordinate
                <
                    Segment
                >::apply(segment, visitor))
        {
            return false;
        }
        else if (! geometry::detail::equals::equals_point_point(
                        p[0], p[1], eq_pp_strategy_type()))
        {
            return visitor.template apply<no_failure>();
        }
        else
        {
            return
                visitor.template apply<failure_wrong_topological_dimension>();
        }
    }
};


} // namespace dispatch
#endif // DOXYGEN_NO_DISPATCH


}} // namespace boost::geometry


#endif // BOOST_GEOMETRY_ALGORITHMS_DETAIL_IS_VALID_SEGMENT_HPP

/* segment.hpp
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
*/