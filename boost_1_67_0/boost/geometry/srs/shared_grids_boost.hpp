// Boost.Geometry

// Copyright (c) 2018-2019, Oracle and/or its affiliates.
// Contributed and/or modified by Adam Wulkiewicz, on behalf of Oracle

// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_SRS_SHARED_GRIDS_BOOST_HPP
#define BOOST_GEOMETRY_SRS_SHARED_GRIDS_BOOST_HPP


#include <boost/geometry/srs/projections/grids.hpp>


#include <boost/thread.hpp>


namespace boost { namespace geometry
{
    
namespace srs
{

class shared_grids_boost
{
public:
    std::size_t size() const
    {
        boost::shared_lock<boost::shared_mutex> lock(mutex);
        return gridinfo.size();
    }

    bool empty() const
    {
        boost::shared_lock<boost::shared_mutex> lock(mutex);
        return gridinfo.empty();
    }

    typedef projections::detail::shared_grids_tag tag;

    struct read_locked
    {
        read_locked(shared_grids_boost & g)
            : gridinfo(g.gridinfo)
            , lock(g.mutex)
        {}

        // should be const&
        projections::detail::pj_gridinfo & gridinfo;

    private:
        boost::shared_lock<boost::shared_mutex> lock;
    };

    struct write_locked
    {
        write_locked(shared_grids_boost & g)
            : gridinfo(g.gridinfo)
            , lock(g.mutex)
        {}

        projections::detail::pj_gridinfo & gridinfo;

    private:
        boost::unique_lock<boost::shared_mutex> lock;
    };

private:
    projections::detail::pj_gridinfo gridinfo;
    mutable boost::shared_mutex mutex;
};


} // namespace srs


}} // namespace boost::geometry


#endif // BOOST_GEOMETRY_SRS_SHARED_GRIDS_BOOST_HPP

/* shared_grids_boost.hpp
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
*/