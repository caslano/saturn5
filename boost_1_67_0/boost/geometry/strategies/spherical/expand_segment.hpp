// Boost.Geometry (aka GGL, Generic Geometry Library)

// Copyright (c) 2007-2015 Barend Gehrels, Amsterdam, the Netherlands.
// Copyright (c) 2008-2015 Bruno Lalande, Paris, France.
// Copyright (c) 2009-2015 Mateusz Loskot, London, UK.
// Copyright (c) 2014-2015 Samuel Debionne, Grenoble, France.

// This file was modified by Oracle on 2015, 2016, 2017, 2018.
// Modifications copyright (c) 2015-2018, Oracle and/or its affiliates.

// Contributed and/or modified by Vissarion Fysikopoulos, on behalf of Oracle
// Contributed and/or modified by Menelaos Karavelas, on behalf of Oracle
// Contributed and/or modified by Adam Wulkiewicz, on behalf of Oracle

// Distributed under the Boost Software License, Version 1.0.
// (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_STRATEGIES_SPHERICAL_EXPAND_SEGMENT_HPP
#define BOOST_GEOMETRY_STRATEGIES_SPHERICAL_EXPAND_SEGMENT_HPP

#include <cstddef>
#include <functional>

#include <boost/geometry/core/access.hpp>
#include <boost/geometry/core/tags.hpp>

#include <boost/geometry/util/select_coordinate_type.hpp>

#include <boost/geometry/algorithms/detail/envelope/box.hpp>
#include <boost/geometry/algorithms/detail/envelope/range_of_boxes.hpp>
#include <boost/geometry/algorithms/detail/envelope/segment.hpp>

#include <boost/geometry/strategies/expand.hpp>
#include <boost/geometry/strategies/spherical/envelope_segment.hpp>


namespace boost { namespace geometry
{

namespace strategy { namespace expand
{

#ifndef DOXYGEN_NO_DETAIL
namespace detail
{

struct segment_on_spheroid
{
    template <typename Box, typename Segment, typename EnvelopeStrategy>
    static inline void apply(Box& box, Segment const& segment, EnvelopeStrategy const& strategy)
    {
        Box mbrs[2];

        // compute the envelope of the segment
        typename point_type<Segment>::type p[2];
        geometry::detail::assign_point_from_index<0>(segment, p[0]);
        geometry::detail::assign_point_from_index<1>(segment, p[1]);
        geometry::detail::envelope::envelope_segment
            <
                dimension<Segment>::value
            >::apply(p[0], p[1], mbrs[0], strategy);

        // normalize the box
        strategy::envelope::spherical_box::apply(box, mbrs[1]);

        // compute the envelope of the two boxes
        geometry::detail::envelope::envelope_range_of_boxes::apply(mbrs, box);
    }
};

} // namespace detail
#endif // DOXYGEN_NO_DETAIL


template
<
    typename CalculationType = void
>
class spherical_segment
{
public:
    template <typename Box, typename Segment>
    static inline void apply(Box& box, Segment const& segment)
    {
        detail::segment_on_spheroid::apply(box, segment,
            strategy::envelope::spherical_segment<CalculationType>());
    }
};


#ifndef DOXYGEN_NO_STRATEGY_SPECIALIZATIONS

namespace services
{

template <typename CalculationType>
struct default_strategy<segment_tag, spherical_equatorial_tag, CalculationType>
{
    typedef spherical_segment<CalculationType> type;
};

template <typename CalculationType>
struct default_strategy<segment_tag, spherical_polar_tag, CalculationType>
{
    typedef spherical_segment<CalculationType> type;
};

} // namespace services

#endif // DOXYGEN_NO_STRATEGY_SPECIALIZATIONS


}} // namespace strategy::expand

}} // namespace boost::geometry

#endif // BOOST_GEOMETRY_STRATEGIES_SPHERICAL_EXPAND_SEGMENT_HPP

/* expand_segment.hpp
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
*/