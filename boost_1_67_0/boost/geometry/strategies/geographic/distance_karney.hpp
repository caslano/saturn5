// Boost.Geometry

// Copyright (c) 2018 Adeel Ahmad, Islamabad, Pakistan.

// Contributed and/or modified by Adeel Ahmad, as part of Google Summer of Code 2018 program.

// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_STRATEGIES_GEOGRAPHIC_KARNEY_HPP
#define BOOST_GEOMETRY_STRATEGIES_GEOGRAPHIC_KARNEY_HPP


#include <boost/geometry/strategies/geographic/distance.hpp>
#include <boost/geometry/strategies/geographic/parameters.hpp>


namespace boost { namespace geometry
{

namespace strategy { namespace distance
{

/*!
\brief The solution of the inverse problem of geodesics on latlong coordinates,
       after Karney (2011).
\ingroup distance
\tparam Spheroid The reference spheroid model
\tparam CalculationType \tparam_calculation
\author See
- Charles F.F Karney, Algorithms for geodesics, 2011
https://arxiv.org/pdf/1109.4448.pdf
*/
template
<
    typename Spheroid = srs::spheroid<double>,
    typename CalculationType = void
>
class karney
    : public strategy::distance::geographic
        <
            strategy::karney, Spheroid, CalculationType
        >
{
    typedef strategy::distance::geographic
        <
            strategy::karney, Spheroid, CalculationType
        > base_type;

public:
    inline karney()
        : base_type()
    {}

    explicit inline karney(Spheroid const& spheroid)
        : base_type(spheroid)
    {}
};

#ifndef DOXYGEN_NO_STRATEGY_SPECIALIZATIONS
namespace services
{

template <typename Spheroid, typename CalculationType>
struct tag<karney<Spheroid, CalculationType> >
{
    typedef strategy_tag_distance_point_point type;
};


template <typename Spheroid, typename CalculationType, typename P1, typename P2>
struct return_type<karney<Spheroid, CalculationType>, P1, P2>
    : karney<Spheroid, CalculationType>::template calculation_type<P1, P2>
{};


template <typename Spheroid, typename CalculationType>
struct comparable_type<karney<Spheroid, CalculationType> >
{
    typedef karney<Spheroid, CalculationType> type;
};


template <typename Spheroid, typename CalculationType>
struct get_comparable<karney<Spheroid, CalculationType> >
{
    static inline karney<Spheroid, CalculationType> apply(karney<Spheroid, CalculationType> const& input)
    {
        return input;
    }
};

template <typename Spheroid, typename CalculationType, typename P1, typename P2>
struct result_from_distance<karney<Spheroid, CalculationType>, P1, P2 >
{
    template <typename T>
    static inline typename return_type<karney<Spheroid, CalculationType>, P1, P2>::type
        apply(karney<Spheroid, CalculationType> const& , T const& value)
    {
        return value;
    }
};


} // namespace services
#endif // DOXYGEN_NO_STRATEGY_SPECIALIZATIONS


}} // namespace strategy::distance


}} // namespace boost::geometry


#endif // BOOST_GEOMETRY_STRATEGIES_GEOGRAPHIC_KARNEY_HPP

/* distance_karney.hpp
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
*/