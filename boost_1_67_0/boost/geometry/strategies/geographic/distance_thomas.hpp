// Boost.Geometry

// Copyright (c) 2007-2012 Barend Gehrels, Amsterdam, the Netherlands.

// This file was modified by Oracle on 2015-2017.
// Modifications copyright (c) 2015-2017 Oracle and/or its affiliates.

// Contributed and/or modified by Adam Wulkiewicz, on behalf of Oracle

// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_STRATEGIES_GEOGRAPHIC_THOMAS_HPP
#define BOOST_GEOMETRY_STRATEGIES_GEOGRAPHIC_THOMAS_HPP


#include <boost/geometry/strategies/geographic/distance.hpp>
#include <boost/geometry/strategies/geographic/parameters.hpp>


namespace boost { namespace geometry
{

namespace strategy { namespace distance
{

/*!
\brief The solution of the inverse problem of geodesics on latlong coordinates,
       Forsyth-Andoyer-Lambert type approximation with second order terms.
\ingroup distance
\tparam Spheroid The reference spheroid model
\tparam CalculationType \tparam_calculation
\author See
    - Technical Report: PAUL D. THOMAS, MATHEMATICAL MODELS FOR NAVIGATION SYSTEMS, 1965
      http://www.dtic.mil/docs/citations/AD0627893
    - Technical Report: PAUL D. THOMAS, SPHEROIDAL GEODESICS, REFERENCE SYSTEMS, AND LOCAL GEOMETRY, 1970
      http://www.dtic.mil/docs/citations/AD703541
*/
template
<
    typename Spheroid = srs::spheroid<double>,
    typename CalculationType = void
>
class thomas
    : public strategy::distance::geographic
        <
            strategy::thomas, Spheroid, CalculationType
        >
{
    typedef strategy::distance::geographic
        <
            strategy::thomas, Spheroid, CalculationType
        > base_type;

public :
    inline thomas()
        : base_type()
    {}

    explicit inline thomas(Spheroid const& spheroid)
        : base_type(spheroid)
    {}
};

#ifndef DOXYGEN_NO_STRATEGY_SPECIALIZATIONS
namespace services
{

template <typename Spheroid, typename CalculationType>
struct tag<thomas<Spheroid, CalculationType> >
{
    typedef strategy_tag_distance_point_point type;
};


template <typename Spheroid, typename CalculationType, typename P1, typename P2>
struct return_type<thomas<Spheroid, CalculationType>, P1, P2>
    : thomas<Spheroid, CalculationType>::template calculation_type<P1, P2>
{};


template <typename Spheroid, typename CalculationType>
struct comparable_type<thomas<Spheroid, CalculationType> >
{
    typedef thomas<Spheroid, CalculationType> type;
};


template <typename Spheroid, typename CalculationType>
struct get_comparable<thomas<Spheroid, CalculationType> >
{
    static inline thomas<Spheroid, CalculationType> apply(thomas<Spheroid, CalculationType> const& input)
    {
        return input;
    }
};

template <typename Spheroid, typename CalculationType, typename P1, typename P2>
struct result_from_distance<thomas<Spheroid, CalculationType>, P1, P2 >
{
    template <typename T>
    static inline typename return_type<thomas<Spheroid, CalculationType>, P1, P2>::type
        apply(thomas<Spheroid, CalculationType> const& , T const& value)
    {
        return value;
    }
};


} // namespace services
#endif // DOXYGEN_NO_STRATEGY_SPECIALIZATIONS


}} // namespace strategy::distance


}} // namespace boost::geometry


#endif // BOOST_GEOMETRY_STRATEGIES_GEOGRAPHIC_THOMAS_HPP

/* distance_thomas.hpp
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
*/