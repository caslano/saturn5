// Boost.Geometry Index
//
// squared distance between point and nearest point of the box or point
//
// Copyright (c) 2011-2014 Adam Wulkiewicz, Lodz, Poland.
//
// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_INDEX_DETAIL_ALGORITHMS_COMPARABLE_DISTANCE_NEAR_HPP
#define BOOST_GEOMETRY_INDEX_DETAIL_ALGORITHMS_COMPARABLE_DISTANCE_NEAR_HPP

#include <boost/geometry/index/detail/algorithms/sum_for_indexable.hpp>

namespace boost { namespace geometry { namespace index { namespace detail {

struct comparable_distance_near_tag {};

template <
    typename Point,
    typename PointIndexable,
    size_t N>
struct sum_for_indexable<Point, PointIndexable, point_tag, comparable_distance_near_tag, N>
{
    typedef typename geometry::default_comparable_distance_result<Point, PointIndexable>::type result_type;

    inline static result_type apply(Point const& pt, PointIndexable const& i)
    {
        return geometry::comparable_distance(pt, i);
    }
};

template <
    typename Point,
    typename BoxIndexable,
    size_t DimensionIndex>
struct sum_for_indexable_dimension<Point, BoxIndexable, box_tag, comparable_distance_near_tag, DimensionIndex>
{
    typedef typename geometry::default_comparable_distance_result<Point, BoxIndexable>::type result_type;

    inline static result_type apply(Point const& pt, BoxIndexable const& i)
    {
        typedef typename coordinate_type<Point>::type point_coord_t;
        typedef typename coordinate_type<BoxIndexable>::type indexable_coord_t;

        point_coord_t pt_c = geometry::get<DimensionIndex>(pt);
        indexable_coord_t ind_c_min = geometry::get<geometry::min_corner, DimensionIndex>(i);
        indexable_coord_t ind_c_max = geometry::get<geometry::max_corner, DimensionIndex>(i);

        result_type diff = 0;

        if ( pt_c < ind_c_min )
            diff = ind_c_min - pt_c;
        else if ( ind_c_max < pt_c )
            diff = pt_c - ind_c_max;

        return diff * diff;
    }
};

template <typename Point, typename Indexable>
typename geometry::default_comparable_distance_result<Point, Indexable>::type
comparable_distance_near(Point const& pt, Indexable const& i)
{
    return detail::sum_for_indexable<
        Point,
        Indexable,
        typename tag<Indexable>::type,
        detail::comparable_distance_near_tag,
        dimension<Indexable>::value
    >::apply(pt, i);
}

}}}} // namespace boost::geometry::index::detail

#endif // BOOST_GEOMETRY_INDEX_DETAIL_ALGORITHMS_COMPARABLE_DISTANCE_NEAR_HPP

/* comparable_distance_near.hpp
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
*/