// Boost.Geometry Index
//
// squared distance between point and centroid of the box or point
//
// Copyright (c) 2011-2014 Adam Wulkiewicz, Lodz, Poland.
//
// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_INDEX_DETAIL_ALGORITHMS_COMPARABLE_DISTANCE_CENTROID_HPP
#define BOOST_GEOMETRY_INDEX_DETAIL_ALGORITHMS_COMPARABLE_DISTANCE_CENTROID_HPP

#include <boost/geometry/index/detail/algorithms/sum_for_indexable.hpp>
#include <boost/geometry/index/detail/algorithms/diff_abs.hpp>

namespace boost { namespace geometry { namespace index { namespace detail {

struct comparable_distance_centroid_tag {};

template <
    typename Point,
    typename PointIndexable,
    size_t N>
struct sum_for_indexable<Point, PointIndexable, point_tag, comparable_distance_centroid_tag, N>
{
    typedef typename geometry::default_comparable_distance_result<Point, PointIndexable>::type result_type;

    inline static result_type apply(Point const& pt, PointIndexable const& i)
    {
        return geometry::comparable_distance(pt, i);
    }
};

template <
    typename Point,
    typename BoxIndexable,
    size_t DimensionIndex>
struct sum_for_indexable_dimension<Point, BoxIndexable, box_tag, comparable_distance_centroid_tag, DimensionIndex>
{
    typedef typename geometry::default_comparable_distance_result<Point, BoxIndexable>::type result_type;

    inline static result_type apply(Point const& pt, BoxIndexable const& i)
    {
        typedef typename coordinate_type<Point>::type point_coord_t;
        typedef typename coordinate_type<BoxIndexable>::type indexable_coord_t;

        point_coord_t pt_c = geometry::get<DimensionIndex>(pt);
        indexable_coord_t ind_c_min = geometry::get<geometry::min_corner, DimensionIndex>(i);
        indexable_coord_t ind_c_max = geometry::get<geometry::max_corner, DimensionIndex>(i);
        
        indexable_coord_t ind_c_avg = ind_c_min + (ind_c_max - ind_c_min) / 2;
        // TODO: awulkiew - is (ind_c_min + ind_c_max) / 2 safe?

        result_type diff = detail::diff_abs(ind_c_avg, pt_c);

        return diff * diff;
    }
};

template <typename Point, typename Indexable>
typename geometry::default_comparable_distance_result<Point, Indexable>::type
comparable_distance_centroid(Point const& pt, Indexable const& i)
{
    return detail::sum_for_indexable<
        Point,
        Indexable,
        typename tag<Indexable>::type,
        detail::comparable_distance_centroid_tag,
        dimension<Indexable>::value
    >::apply(pt, i);
}

}}}} // namespace boost::geometry::index::detail

#endif // #define BOOST_GEOMETRY_INDEX_DETAIL_ALGORITHMS_COMPARABLE_DISTANCE_CENTROID_HPP


/* comparable_distance_centroid.hpp
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
*/