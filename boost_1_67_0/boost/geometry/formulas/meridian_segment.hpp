// Boost.Geometry

// Copyright (c) 2017-2018 Oracle and/or its affiliates.

// Contributed and/or modified by Vissarion Fysikopoulos, on behalf of Oracle
// Contributed and/or modified by Adam Wulkiewicz, on behalf of Oracle

// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_FORMULAS_MERIDIAN_SEGMENT_HPP
#define BOOST_GEOMETRY_FORMULAS_MERIDIAN_SEGMENT_HPP

#include <boost/math/constants/constants.hpp>

#include <boost/geometry/core/radius.hpp>

#include <boost/geometry/util/condition.hpp>
#include <boost/geometry/util/math.hpp>
#include <boost/geometry/util/normalize_spheroidal_coordinates.hpp>

namespace boost { namespace geometry { namespace formula
{

/*!
\brief Test if a segment is meridian or not.
*/

class meridian_segment
{

public :

    enum SegmentType {NonMeridian, MeridianCrossingPole, MeridianNotCrossingPole};

    template <typename T>
    static inline SegmentType is_meridian(T lon1, T lat1, T lon2, T lat2)
    {
        SegmentType res = NonMeridian;
        T diff = geometry::math::longitude_distance_signed<geometry::radian>(lon1, lon2);

        if ( meridian_not_crossing_pole(lat1, lat2, diff) )
        {
            res = MeridianNotCrossingPole;
        }
        else if ( meridian_crossing_pole(diff) )
        {
            res = MeridianCrossingPole;
        }
        return res;
    }

    template <typename T>
    static bool meridian_not_crossing_pole(T lat1, T lat2, T diff)
    {
        T half_pi = math::half_pi<T>();
        return math::equals(diff, T(0)) ||
               (math::equals(lat2, half_pi) && math::equals(lat1, -half_pi));
    }

    template <typename T>
    static bool meridian_crossing_pole(T diff)
    {
        return math::equals(math::abs(diff), math::pi<T>());
    }

};

}}} // namespace boost::geometry::formula

#endif //BOOST_GEOMETRY_FORMULAS_MERIDIAN_SEGMENT_HPP

/* meridian_segment.hpp
+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
*/