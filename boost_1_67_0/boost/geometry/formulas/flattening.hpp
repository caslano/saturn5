// Boost.Geometry

// Copyright (c) 2014-2016 Oracle and/or its affiliates.

// Contributed and/or modified by Adam Wulkiewicz, on behalf of Oracle

// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_FORMULAS_FLATTENING_HPP
#define BOOST_GEOMETRY_FORMULAS_FLATTENING_HPP

#include <boost/geometry/core/radius.hpp>
#include <boost/geometry/core/tag.hpp>
#include <boost/geometry/core/tags.hpp>

#include <boost/geometry/algorithms/not_implemented.hpp>

namespace boost { namespace geometry
{

#ifndef DOXYGEN_NO_DISPATCH
namespace formula_dispatch
{

template <typename ResultType, typename Geometry, typename Tag = typename tag<Geometry>::type>
struct flattening
    : not_implemented<Tag>
{};

template <typename ResultType, typename Geometry>
struct flattening<ResultType, Geometry, srs_sphere_tag>
{
    static inline ResultType apply(Geometry const& /*geometry*/)
    {
        return ResultType(0);
    }
};

template <typename ResultType, typename Geometry>
struct flattening<ResultType, Geometry, srs_spheroid_tag>
{
    static inline ResultType apply(Geometry const& geometry)
    {
        // (a - b) / a
        return ResultType(get_radius<0>(geometry) - get_radius<2>(geometry))
                    / ResultType(get_radius<0>(geometry));
    }
};

} // namespace formula_dispatch
#endif // DOXYGEN_NO_DISPATCH

#ifndef DOXYGEN_NO_DETAIL
namespace formula
{

template <typename ResultType, typename Geometry>
ResultType flattening(Geometry const& geometry)
{
    return formula_dispatch::flattening<ResultType, Geometry>::apply(geometry);
}

} // namespace formula
#endif // DOXYGEN_NO_DETAIL

}} // namespace boost::geometry

#endif // BOOST_GEOMETRY_FORMULAS_FLATTENING_HPP

/* flattening.hpp
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
*/