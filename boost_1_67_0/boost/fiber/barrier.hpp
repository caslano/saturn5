
//          Copyright Oliver Kowalke 2013.
// Distributed under the Boost Software License, Version 1.0.
//    (See accompanying file LICENSE_1_0.txt or copy at
//          http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_FIBERS_BARRIER_H
#define BOOST_FIBERS_BARRIER_H

#include <cstddef>

#include <boost/config.hpp>

#include <boost/fiber/condition_variable.hpp>
#include <boost/fiber/detail/config.hpp>
#include <boost/fiber/mutex.hpp>

#ifdef BOOST_HAS_ABI_HEADERS
#  include BOOST_ABI_PREFIX
#endif

namespace boost {
namespace fibers {

class BOOST_FIBERS_DECL barrier {
private:
    std::size_t         initial_;
    std::size_t         current_;
    std::size_t         cycle_{ 0 };
    mutex               mtx_{};
    condition_variable  cond_{};

public:
    explicit barrier( std::size_t);

    barrier( barrier const&) = delete;
    barrier & operator=( barrier const&) = delete;

    bool wait();
};

}}

#ifdef BOOST_HAS_ABI_HEADERS
#  include BOOST_ABI_SUFFIX
#endif

#endif // BOOST_FIBERS_BARRIER_H

/* barrier.hpp
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
*/