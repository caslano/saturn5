
//          Copyright Oliver Kowalke 2013.
// Distributed under the Boost Software License, Version 1.0.
//    (See accompanying file LICENSE_1_0.txt or copy at
//          http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_FIBERS_TYPE_H
#define BOOST_FIBERS_TYPE_H

#include <atomic>
#include <chrono>
#include <exception>
#include <functional>
#include <map>
#include <memory>
#include <type_traits>

#include <boost/assert.hpp>
#include <boost/config.hpp>
#include <boost/context/detail/apply.hpp>
#include <boost/context/stack_context.hpp>
#include <boost/intrusive/list.hpp>
#include <boost/intrusive/parent_from_member.hpp>
#include <boost/intrusive_ptr.hpp>
#include <boost/intrusive/set.hpp>

#include <boost/fiber/detail/config.hpp>
#include <boost/fiber/detail/data.hpp>
#include <boost/fiber/detail/decay_copy.hpp>
#include <boost/fiber/detail/fss.hpp>
#include <boost/fiber/detail/spinlock.hpp>
#include <boost/fiber/exceptions.hpp>
#include <boost/fiber/fixedsize_stack.hpp>
#include <boost/fiber/properties.hpp>
#include <boost/fiber/segmented_stack.hpp>

#ifdef BOOST_HAS_ABI_HEADERS
#  include BOOST_ABI_PREFIX
#endif

namespace boost {
namespace fibers {

enum class type {
    none               = 0,
    main_context       = 1 << 1,
    dispatcher_context = 1 << 2,
    worker_context     = 1 << 3,
    pinned_context     = main_context | dispatcher_context
};

inline
constexpr type
operator&( type l, type r) {
    return static_cast< type >(
            static_cast< unsigned int >( l) & static_cast< unsigned int >( r) );
}

inline
constexpr type
operator|( type l, type r) {
    return static_cast< type >(
            static_cast< unsigned int >( l) | static_cast< unsigned int >( r) );
}

inline
constexpr type
operator^( type l, type r) {
    return static_cast< type >(
            static_cast< unsigned int >( l) ^ static_cast< unsigned int >( r) );
}

inline
constexpr type
operator~( type l) {
    return static_cast< type >( ~static_cast< unsigned int >( l) );
}

inline
type &
operator&=( type & l, type r) {
    l = l & r;
    return l;
}

inline
type &
operator|=( type & l, type r) {
    l = l | r;
    return l;
}

inline
type &
operator^=( type & l, type r) {
    l = l ^ r;
    return l;
}

}}

#ifdef BOOST_HAS_ABI_HEADERS
#  include BOOST_ABI_SUFFIX
#endif

#endif // BOOST_FIBERS_TYPE_H

/* type.hpp
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
*/