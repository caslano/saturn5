/*
 *             Copyright Andrey Semashev 2019.
 * Distributed under the Boost Software License, Version 1.0.
 *    (See accompanying file LICENSE_1_0.txt or copy at
 *          https://www.boost.org/LICENSE_1_0.txt)
 */
/*!
 * \file   utility/manipulators/auto_newline.hpp
 * \author Andrey Semashev
 * \date   23.06.2019
 *
 * The header contains implementation of a stream manipulator for inserting a newline, unless there is already one inserted.
 */

#ifndef BOOST_LOG_UTILITY_MANIPULATORS_AUTO_NEWLINE_HPP_INCLUDED_
#define BOOST_LOG_UTILITY_MANIPULATORS_AUTO_NEWLINE_HPP_INCLUDED_

#include <boost/log/detail/config.hpp>
#include <boost/log/utility/formatting_ostream_fwd.hpp>
#include <boost/log/detail/header.hpp>

#ifdef BOOST_HAS_PRAGMA_ONCE
#pragma once
#endif

namespace boost {

BOOST_LOG_OPEN_NAMESPACE

/*!
 * Stream manipulator for inserting a newline character, unless the last character
 * inserted into the stream is already a newline.
 */
struct auto_newline_manip {}
const auto_newline = {};

/*!
 * Stream output operator for the \c auto_newline manipulator
 */
template< typename CharT, typename TraitsT, typename AllocatorT >
inline basic_formatting_ostream< CharT, TraitsT, AllocatorT >& operator<< (basic_formatting_ostream< CharT, TraitsT, AllocatorT >& strm, auto_newline_manip)
{
    typedef basic_formatting_ostream< CharT, TraitsT, AllocatorT > stream_type;
    typedef typename stream_type::char_type char_type;
    typedef typename stream_type::string_type string_type;
    if (BOOST_LIKELY(strm.good()))
    {
        string_type* str = strm.rdbuf()->storage();
        if (BOOST_LIKELY(!!str))
        {
            strm.rdbuf()->pubsync();
            if (str->empty() || *str->rbegin() != static_cast< char_type >('\n'))
                strm.rdbuf()->push_back(static_cast< char_type >('\n'));
        }
    }

    return strm;
}

BOOST_LOG_CLOSE_NAMESPACE // namespace log

} // namespace boost

#include <boost/log/detail/footer.hpp>

#endif // BOOST_LOG_UTILITY_MANIPULATORS_AUTO_NEWLINE_HPP_INCLUDED_

/* auto_newline.hpp
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
*/