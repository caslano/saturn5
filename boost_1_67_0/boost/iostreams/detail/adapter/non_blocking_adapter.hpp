// (C) Copyright 2008 CodeRage, LLC (turkanis at coderage dot com)
// (C) Copyright 2005-2007 Jonathan Turkanis
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt.)

// See http://www.boost.org/libs/iostreams for documentation.

#ifndef BOOST_IOSTREAMS_DETAIL_NON_BLOCKING_ADAPTER_HPP_INCLUDED
#define BOOST_IOSTREAMS_DETAIL_NON_BLOCKING_ADAPTER_HPP_INCLUDED

#include <boost/iostreams/detail/ios.hpp>  // streamsize, seekdir, openmode.
#include <boost/iostreams/read.hpp>
#include <boost/iostreams/seek.hpp>
#include <boost/iostreams/traits.hpp>
#include <boost/iostreams/write.hpp>

namespace boost { namespace iostreams {

template<typename Device>
class non_blocking_adapter {
public:
    typedef typename char_type_of<Device>::type char_type;
    struct category
        : mode_of<Device>::type, device_tag
        { };
    explicit non_blocking_adapter(Device& dev) : device_(dev) { }
    std::streamsize read(char_type* s, std::streamsize n)
    { 
        std::streamsize result = 0;
        while (result < n) {
            std::streamsize amt = iostreams::read(device_, s + result, n - result);
            if (amt == -1)
                break;
            result += amt;
        }
        return result != 0 ? result : -1;
    }
    std::streamsize write(const char_type* s, std::streamsize n)
    { 
        std::streamsize result = 0;
        while (result < n) {
            std::streamsize amt = 
                iostreams::write(device_, s + result, n - result);
            // write errors, like EOF on read, need to be handled.
            if (amt == -1)
                break;
            result += amt;
        }
        return result;    
    }
    std::streampos seek( stream_offset off, BOOST_IOS::seekdir way,
                         BOOST_IOS::openmode which = 
                             BOOST_IOS::in | BOOST_IOS::out )
    { return iostreams::seek(device_, off, way, which); }
public:
    non_blocking_adapter& operator=(const non_blocking_adapter&);
    Device& device_;
};

} } // End namespace iostreams.

#endif // #ifndef BOOST_IOSTREAMS_DETAIL_NON_BLOCKING_ADAPTER_HPP_INCLUDED

/* non_blocking_adapter.hpp
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
*/