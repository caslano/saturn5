//  (C) Copyright Nick Thompson 2019.
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_MATH_STATISTICS_T_TEST_HPP
#define BOOST_MATH_STATISTICS_T_TEST_HPP

#include <cmath>
#include <iterator>
#include <utility>
#include <boost/math/distributions/students_t.hpp>
#include <boost/math/statistics/univariate_statistics.hpp>

namespace boost::math::statistics {

template<typename Real>
std::pair<Real, Real> one_sample_t_test(Real sample_mean, Real sample_variance, Real num_samples, Real assumed_mean) {
    using std::sqrt;
    typedef boost::math::policies::policy<
          boost::math::policies::promote_float<false>,
          boost::math::policies::promote_double<false> >
          no_promote_policy;

    Real test_statistic = (sample_mean - assumed_mean)/sqrt(sample_variance/num_samples);
    auto student = boost::math::students_t_distribution<Real, no_promote_policy>(num_samples - 1);
    Real pvalue;
    if (test_statistic > 0) {
        pvalue = 2*boost::math::cdf<Real>(student, -test_statistic);;
    }
    else {
        pvalue = 2*boost::math::cdf<Real>(student, test_statistic);
    }
    return std::make_pair(test_statistic, pvalue);
}

template<class ForwardIterator>
auto one_sample_t_test(ForwardIterator begin, ForwardIterator end, typename std::iterator_traits<ForwardIterator>::value_type assumed_mean) {
    using Real = typename std::iterator_traits<ForwardIterator>::value_type;
    auto [mu, s_sq] = mean_and_sample_variance(begin, end);
    return one_sample_t_test(mu, s_sq, Real(std::distance(begin, end)), assumed_mean);
}

template<class Container>
auto one_sample_t_test(Container const & v, typename Container::value_type assumed_mean) {
    return one_sample_t_test(v.begin(), v.end(), assumed_mean);
}

}
#endif

/* t_test.hpp
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
*/