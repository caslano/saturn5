/*
 *  Copyright Nick Thompson, 2019
 *  Use, modification and distribution are subject to the
 *  Boost Software License, Version 1.0. (See accompanying file
 *  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
 *
 *  Exactly the same as barycentric_rational.hpp, but delivers values in $\mathbb{R}^n$.
 *  In some sense this is trivial, since each component of the vector is computed in exactly the same
 *  as would be computed by barycentric_rational.hpp. But this is a bit more efficient and convenient.
 */

#ifndef BOOST_MATH_INTERPOLATORS_VECTOR_BARYCENTRIC_RATIONAL_HPP
#define BOOST_MATH_INTERPOLATORS_VECTOR_BARYCENTRIC_RATIONAL_HPP

#include <memory>
#include <boost/math/interpolators/detail/vector_barycentric_rational_detail.hpp>

namespace boost{ namespace math{

template<class TimeContainer, class SpaceContainer>
class vector_barycentric_rational
{
public:
    using Real = typename TimeContainer::value_type;
    using Point = typename SpaceContainer::value_type;
    vector_barycentric_rational(TimeContainer&& times, SpaceContainer&& points, size_t approximation_order = 3);

    void operator()(Point& x, Real t) const;

    // I have validated using google benchmark that returning a value is no more expensive populating it,
    // at least for Eigen vectors with known size at compile-time.
    // This is kinda a weird thing to discover since it goes against the advice of basically every high-performance computing book.
    Point operator()(Real t) const {
        Point p;
        this->operator()(p, t);
        return p;
    }

    void prime(Point& dxdt, Real t) const {
        Point x;
        m_imp->eval_with_prime(x, dxdt, t);
    }

    Point prime(Real t) const {
        Point p;
        this->prime(p, t);
        return p;
    }

    void eval_with_prime(Point& x, Point& dxdt, Real t) const {
        m_imp->eval_with_prime(x, dxdt, t);
        return;
    }

    std::pair<Point, Point> eval_with_prime(Real t) const {
        Point x;
        Point dxdt;
        m_imp->eval_with_prime(x, dxdt, t);
        return {x, dxdt};
    }

private:
    std::shared_ptr<detail::vector_barycentric_rational_imp<TimeContainer, SpaceContainer>> m_imp;
};


template <class TimeContainer, class SpaceContainer>
vector_barycentric_rational<TimeContainer, SpaceContainer>::vector_barycentric_rational(TimeContainer&& times, SpaceContainer&& points, size_t approximation_order):
 m_imp(std::make_shared<detail::vector_barycentric_rational_imp<TimeContainer, SpaceContainer>>(std::move(times), std::move(points), approximation_order))
{
    return;
}

template <class TimeContainer, class SpaceContainer>
void vector_barycentric_rational<TimeContainer, SpaceContainer>::operator()(typename SpaceContainer::value_type& p, typename TimeContainer::value_type t) const
{
    m_imp->operator()(p, t);
    return;
}

}}
#endif

/* vector_barycentric_rational.hpp
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
*/