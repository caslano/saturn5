//  Copyright Nick Thompson 2019.
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_MATH_DISTRIBUTIONS_EMPIRICAL_CUMULATIVE_DISTRIBUTION_FUNCTION_HPP
#define BOOST_MATH_DISTRIBUTIONS_EMPIRICAL_CUMULATIVE_DISTRIBUTION_FUNCTION_HPP
#include <algorithm>
#include <iterator>
#include <stdexcept>

namespace boost { namespace math{

template<class RandomAccessContainer>
class empirical_cumulative_distribution_function {
    using Real = typename RandomAccessContainer::value_type;
public:
    empirical_cumulative_distribution_function(RandomAccessContainer && v, bool sorted = false)
    {
        if (v.size() == 0) {
            throw std::domain_error("At least one sample is required to compute an empirical CDF.");
        }
        m_v = std::move(v);
        if (!sorted) {
            std::sort(m_v.begin(), m_v.end());
        }
    }

    auto operator()(Real x) const {
       if constexpr (std::is_integral_v<Real>)
       {
         if (x < m_v[0]) {
           return double(0);
         }
         if (x >= m_v[m_v.size()-1]) {
           return double(1);
         }
         auto it = std::upper_bound(m_v.begin(), m_v.end(), x);
         return static_cast<double>(std::distance(m_v.begin(), it))/static_cast<double>(m_v.size());
       }
       else
       {
         if (x < m_v[0]) {
           return Real(0);
         }
         if (x >= m_v[m_v.size()-1]) {
           return Real(1);
         }
         auto it = std::upper_bound(m_v.begin(), m_v.end(), x);
         return static_cast<Real>(std::distance(m_v.begin(), it))/static_cast<Real>(m_v.size());
      }
    }

    RandomAccessContainer&& return_data() {
        return std::move(m_v);
    }

private:
    RandomAccessContainer m_v;
};

}}
#endif

/* empirical_cumulative_distribution_function.hpp
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
*/