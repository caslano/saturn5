
///////////////////////////////////////////////////////////////////////////////
//  Copyright 2018 John Maddock
//  Distributed under the Boost
//  Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
#ifndef BOOST_MATH_HYPERGEOMETRIC_1F1_CF_HPP
#define BOOST_MATH_HYPERGEOMETRIC_1F1_CF_HPP

#include <boost/math/tools/fraction.hpp>

//
// Evaluation of 1F1 by continued fraction
// see http://functions.wolfram.com/HypergeometricFunctions/Hypergeometric1F1/10/0002/
//
// This is not terribly useful, as like the series we're adding a something to 1,
// so only really useful when we know that the result will be > 1.
//


  namespace boost { namespace math { namespace detail {

     template <class T>
     struct hypergeometric_1F1_cf_func
     {
        typedef std::pair<T, T>  result_type;
        hypergeometric_1F1_cf_func(T a_, T b_, T z_) : a(a_), b(b_), z(z_), k(0) {}
        std::pair<T, T> operator()()
        {
           ++k;
           return std::make_pair(-(((a + k) * z) / ((k + 1) * (b + k))), 1 + ((a + k) * z) / ((k + 1) * (b + k)));
        }
        T a, b, z;
        unsigned k;
     };

     template <class T, class Policy>
     T hypergeometric_1F1_cf(const T& a, const T& b, const T& z, const Policy& pol, const char* function)
     {
        hypergeometric_1F1_cf_func<T> func(a, b, z);
        boost::uintmax_t max_iter = boost::math::policies::get_max_series_iterations<Policy>();
        T result = boost::math::tools::continued_fraction_a(func, boost::math::policies::get_epsilon<T, Policy>(), max_iter);
        boost::math::policies::check_series_iterations<T>(function, max_iter, pol);
        return 1 + a * z / (b * (1 + result));
     }

  } } } // namespaces

#endif // BOOST_MATH_HYPERGEOMETRIC_1F1_BESSEL_HPP

/* hypergeometric_1F1_cf.hpp
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
*/