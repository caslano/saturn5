///////////////////////////////////////////////////////////////////////////////
//  Copyright 2014 Anton Bikineev
//  Copyright 2014 Christopher Kormanyos
//  Copyright 2014 John Maddock
//  Copyright 2014 Paul Bristow
//  Distributed under the Boost
//  Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
#ifndef BOOST_MATH_HYPERGEOMETRIC_0F1_BESSEL_HPP
#define BOOST_MATH_HYPERGEOMETRIC_0F1_BESSEL_HPP

#include <boost/math/special_functions/bessel.hpp>
#include <boost/math/special_functions/gamma.hpp>

  namespace boost { namespace math { namespace detail {

  template <class T, class Policy>
  inline T hypergeometric_0F1_bessel(const T& b, const T& z, const Policy& pol)
  {
    BOOST_MATH_STD_USING

    const bool is_z_nonpositive = z <= 0;

    const T sqrt_z = is_z_nonpositive ? T(sqrt(-z)) : T(sqrt(z));
    const T bessel_mult = is_z_nonpositive ?
      boost::math::cyl_bessel_j(b - 1, 2 * sqrt_z, pol) :
      boost::math::cyl_bessel_i(b - 1, 2 * sqrt_z, pol) ;

    if (b > boost::math::max_factorial<T>::value)
    {
       const T lsqrt_z = log(sqrt_z);
       const T lsqrt_z_pow_b = (b - 1) * lsqrt_z;
       T lg = (boost::math::lgamma(b, pol) - lsqrt_z_pow_b);
       lg = exp(lg);
       return lg * bessel_mult;
    }
    else
    {
       const T sqrt_z_pow_b = pow(sqrt_z, b - 1);
       return (boost::math::tgamma(b, pol) / sqrt_z_pow_b) * bessel_mult;
    }
  }

  } } } // namespaces

#endif // BOOST_MATH_HYPERGEOMETRIC_0F1_BESSEL_HPP

/* hypergeometric_0F1_bessel.hpp
J0ruloASZKHCUoHsYYDoJ9kLuk9Kp+S0xegXuDaRIszHSWtcPu5BDk66UQDt0vrc9xFCJjUh4eNxIkBFDYxj8wv9K1CtwH+VZkcdp64kiPkRkJmNUyVEUZ1M5whjrEC5Z3SIKOo1Qzq5/R6Nt5U6vU7SyaG+0UWx1dQNY7RWh/4brWAonFoQTR1MsBk9GJ0WeZjoeQeSyduyFUEkb0/p4SGMOr5XPlVo5hJAEHslxjthhYg9UZDOnroTxmGeZbR9SJmUR0AiC9peccAf94qmipFMrzGdZ+gCmoSkHHuu5zf6s89bn9salXFE4YUdQmaEatGsXr1CCzUjp1voFadOFjzxDFXGurpa5ZDrF5fTk7l8ANJmh7kMOvtM0xX7/hWZMwGx6u6BS1DdxivlDXVIGXOw0/PZ/Xr9+nbS1jc0+0Pn/1l9Au//9urztE+uo6MzPHIGViUpuOre7fOeyP81xH/i7v/q/rbz2jf2n238bcENa4vzeH4AvSw1ZMIMC8EAPTVqMGvQcHTxSFukPzVE5A65B6tbvW+A7Y3dEsz1TyuKx4lZeg6ft8hOlvgXLs2Y7XZ7c7iAsYwx4sayc3JIB3LEtSFJyaQKbTdhd6OuqBNUmGqznTbdjE4jLTbTiHklKiuN/rlLZSUHB4cA5YgHj5/swPFP9OHhYbHORqusxEUpzeN1HoOCS6NrIYlRe+fr/D7Wapl0EKXWU8LkgtE7dQUfQeBOwuFrYg5//quOzCknsVLKOiX+/wOVxZHk8X8AgENLNZ1TeGTP27VnYtuc2LZt27ZtTWzb7Nh2JrZt23by5fde3/+gD7p31z6ptZ91r6rnqi359mLeOUjvCVCUOSXuRAYkoMSZl4eV2kOChi9m2Y2eoZ/zjvYKSJa7e+XMZElj0LaN9zpcIt+Jbx+NDJTgzr+GlpajUGcNuHAT7fmJh6khiBVNsl6J9yIopUD7ESwcdBOVP8yio8Y+BlECr71HO0DwMhuPDkI+tk1aAnfmQxl7+ZNrqKUPBbED4tvrp+qYqts0q0838v5URhqEc1L33PSBiOWp7mjbI4zx4pnbWK963gZkd7WQl0MZMSfe8q5hwKAdR8ifS1JkteQxixisUFB6z2gKaGkACyz008w4l6qjzJgj65KXmHtKMWTsVpp0cwP6FBdBjYAL6/OusUQB+Sr5z+GPvXL5qFHDRL6fgXa359vfLDFXWyUaLNyfL0ZfB8f4t3q8dC/2dfhxKll018CSkDfLpFNOvLn36H63qR/32588V9sdw/PTuYzpUZhyJdp6uoyYseDlQhTOZa97q+je+9jbOxeDx0k+o2vkncCXFQ8TxBssLXPzHAVAiAPxYtwqKnlXZ5wo5CCKGHXCgoevuPu37MGPETupn7S0tAlGujHjCoM/+MCYbr1Q2A7ZNfLSHNxEjjhqnPp5V7uXBYR8UPA4Y6hG2CnsMLr9ytCGNBoIAUJyGDGoQAzHXtxL0HUQbIQ+rkuiqQbPOBv6ooWv0N3ppxv6iA3i7v6eIH8X+As2guFIFiYd4ZRTAAM8UGZfKT3LmSB9vXIpeZZT450SK0oWpiAqBDn9L5oy4T5WnPRY1TiKyh57Z17HyqbC1XBFmKwtbUUuWJxANwIe30TkPUFo5O/EoFfpRvTe4b0GJxNJS357DZDysZz4f2Evy3GLNTeKdYTFPCO3bHB+Vl5EqBAj4xT8Kc5umufGrAdDorh6RybobTzeN17CfTM/VHtCHRwhKzrbZsB3GRjXdJVRzw5zKILzsGRQnuGgU9/eyo/e8CuC+aS9YCZmLogbJqmkEgrLqqwCqEqwq6Jv3fyQQvWcZap38/09TdLJl+Ho7QXmkFumQ/QUIdRAW84AxT3wkgsKtzJus0un+1uLb2fvIqrnI9JveDQytTJVaqz93z0CIG8GNAehHBukaCEPqHaHP5WkYjFCjvc1qHBdjPv7jEOSyna7rT/STM/h+KuLXk8y+A5qysHHZ9SZG4AXq1Eta2+KrhNTQPiEPUJEF0dObqTlHzaDskBgMgOYCIWwvAX8y1N2HIx/Z3W0lEbgx+MBNJmyZgJGyPMbHMXayGExCw8sDyJInnPDiHCBMuz/u7PMsssoOhFKykFsWKIu4y6J5Tmp3vBTipKVRY+8IQEmrKRIoDSsS0qAPtxCaJ4DPh98KV8zqemI8jOSdD5hYQ3Yb4x8t/arnaVFilE5V2RgXYT4kdFoEN5cx/bAOYVAhTaClznfIgcBYaU6lwcrFlHhEyhNRAGk4OqRkFbzQELJFjQF7PSs50DU3Fgq8gp2XlQfli0zDEJnrcexBBRX7te/tECCiW2SLXE6ZLt4AMMvSXlh/6Ntxj+FJLwv3Hdc4RE/086EGpYC8eC9F7I9eGvDzA5Q6C7BW9RmY01hU7WuRAwZPKu/7kJejA9txERJOTrLGDx0Wmjqu9424s7Z0ZFj6+l7siKdX3eHTWaMV2JCGRI+wf5ACQEy86q8W2CJioLr29AYCh5SIcn1+cBRstx6PfLJkIKNLqSDKSdv69bNS9472fL5CQdy37cl1KlSWZcvo3JTL5n4nyTPeBuASkpJ7sQCQS45C2Ze1T862jpOdx8UdLm8JsyZDg8nNnCxV/Jou4MXPhDzHl97oO/g7wuJiK7d+t9LBHo+X0njFVZPbm6zpMSSlNf2qrcXq0x4G37/pnU/ULqc/rpEcCa5r49cjhBVCdcpqyTjjP487BRQFJG0jUkfOaGrY8VJhsxYgG2Az4Uzp4zgy80NPUcNyVm5jdbRvUe5WjIVpJUNJXAuEepri86SDkqs8F8JiLupKThFckXGs3unMXcDfgyPefImGmkmWz2UJVa17BglwenWsNZ9zefAX0lskmcUEmHm+lHK9RckCjP58qSEbqt0WNrha9Pk1B6JCd6SFN1DcCiMDgbQ/rVt27Zt27Zt27Zt27Ztu7e29foWZyb7ZCb5VvGu/jYM4xw0gdMi2DboTu4LNFM1p3k8XI4DKoSPfTOo2yKAXjD4jAkBhmKFiEGiHr4EiVtOCSEKBcZBwfHLG8NAbeUYkosizflyofYERyTjcWU8IuwLiqIQJ3xJBbmPwVifsnDSvjhrNxNQRDXcAwRO7LcvKIfplxLu/Vlj50Cik5MvMH7wycLXbvaDIYnIIlB1EQ9UFG936xB64tbab7eiJ18sn6eXS1GJI5woVssIbWMoTwk72X8EcYapKhTUM3VR3Q3jBDCS6ysNxiVSVMx6mmdRjw9NtMvaLksehQ4R/MD/iW69vvh213sYnNr1ZjX9rcm7DB1zY47yKwiXxH/u5YSsHPucKN/V8f5SWkQxypOiKYtBeTagh732IJh04tOz5M5FfJec5RF5JSA6U5A6fnvZ9eq9VvXMnH++ONkDwLTW2OiQXDBc/qd48hzKlynOwjXasUnbfqXf+9JwtP+M0/L4fXNnqoPlK1uxlDEF3NIGye2Uj4I7gbac0jk4Go2aUh9PKkIqE/wlh1HetrG78VtOBCibM+YLXPBhsWE8nrWVL1MlECPKsOD4Xdvt0NWGJq+g8N+nKAQe7/uN+7zo4C/pTjWNfI3ks1MSAbQGBwes7U3hhdOVcLVX/rDa7dANchbDhZ2OHh9e2Z1tABz01CZ1AssDo0Pm2d753VensMvEY5Ag9p7BJAT10leVwJZwJiBrsH3HgRkdSqNd8q/ukXalrB1F8TMoHTfuIaMcPY5G+qPCYRkNTCAd4XgFpCJ+KNi/1x2hrTdw3L3BYzk8A11ftR5FIkp4dgTIxITLfdHDHp3mAVsECYraMiZi8dkAuwW6mTo+8SH8ypcyC7/wvrl9uJ9TnKGRmgYCfigiWnGaHvkXXK2wcBOllzAB4mLk8o+aB8ZGjETNNyllYUPfFgVfPcDpyEGpgU+LLVBP5Ty9ooUL55gL6xXTcShuGErRW6JKIlcq59rWLS1hEvBjPR4m0PxoyeCwVG+MNcWtio3MbanqaJEHBU/wDvb2t8Y9+Z7MqUduGlBXS3VuOAi7JqPG0VtSmWmYXG7Lur6x05Hbql+uLwqTT5OIGO6likUSiQzNF42BVremvCkPJqP6/FcWIdZlX6/v90p6Ry+/iioQo83m+2yStduQ/uriY8DXQXFN/WIe7r7l6erqJZX/QMDgXl+cM9fuHkPzcxbLyTWhlYx3axony3vFoq87YzOxGf1HhnF1gr+GsEVFhIYbtRU9FrI1GCkyePSEeRDjvbC7FsAtIvQVy2RrdEs0O6xbnGcJmfSEdTetl1Y3POTRp7bOWHbwIPlufeW+NyPoSpukZxODmTKxKb/YPN35KBIZnBAp8P+TsqJb2Ntzhak1WwQ7i7X4UNgbP82aX78LfZTLFmjFaAI/FwLIs1816Re2n8xG3SYcxBrpfRP4EhCO77sj+CDjLEUJvFnOEyDY21cHyJMTGNj2qIDmM9WoMcjFkP54wpM0j1zKLnOBBgtO4BeqqHL31OUkKU53yMOMZS08Q05/B7Mc3YZ/fm08bYZoVbIT5Mp/yVgT7efFd9vmNS0j5mD4xw7VT5/IMn4vTmFH7PxJtY5B5oGep1y/KRvOF39X/7LfV3PVy2auNuDYDg6NS7DNZ7iYZ4lQTaro0ubxiTQq1VM/lWBklJzAj3E2P+uKvD35KR6mWxzSroFsgkBkss74Th4S2UamJDHnnhXqonZFdQlqagrka5dPpej0ewlSHv58Z59NrSnOeG5jolzqPV9NEXeXnoejiEen99YeeHtzFhkiFYU6tbjUQTf8GqQx27O38wPAWrVQUubvlXGIODSwxfjcDrPu6/N0eNrqS3H8KT0VixaPQfim48ehpCIOu/So8yiDWrTW88gZO9vntOiUNwFm4FhsPJqAxbwZqxU/ksPUCaImXatb4kpANBlbo+2HZ9TpwZbO+f0w3Nqjd/QZcP48u/LuPgiPEEUsZEiI1x/opbjuY5NrsPmLnTf5pWdTgQQ3LlCws06pueFinZRKXd+vWCOvEEyub1e3ixct/DvBzaXxaWaGcHamWgpTpSozMnrEO48bxoW1HzlFnXlWL7+youru3buISbFccQQFC90w+Kolfb54eln7mYkri4IFu5cgROFqA3CFjRXc34r5jcN7gJMgn3d62We0b3gjXnJ+X2wcsScPIOpKrarJ+tIJ2lWd2q8diE3T8ELAhLJHupKiWi+06g+DLBlBcIO2Hqw+OAUbxWoPAxjY6jxwno4LRRHCLSYLks7v8PVApSRqWZy1MpkA7UDM57k2rPmFzaDbQEHRr+fmPljU42YZU8d13TWBCFeyICbc/VyE3kWI/6sr6ZuUfAf8wfDpMx/O60RNBRZNLgbVCwxAmHtvS2dST6ntfEulnaKsrKO44x4bn/DgbNaZ9N0k0xHYb9L1ZSZFElIcP35XaHJbtn+tkh9764O/MZLS2NH6VketASJRZvcZsLZUzfCQhb4lA7KsKdMWZvvdCY7Qbc10khxTAwlLG2vUsF0b9IO549m7EdN53upq9ytFN+sTI7aOunXd09ZE7t03y12VKFrlcGt7ZPddsNoREy01pgK9G+s/1ANt7+49FscEz1QwtXhbd2aXeL6dG/SzHVd84eS58B34ndYDpiwDqaZYWuz/4hirWhYQitjxNEWF+GsI4gYAJjcmO5WqV7vH87epbAk1SEYuL17JCmcdJxRBCLjcPSRwOaqQbnfECdw4a9BzxdBOrM6euawR/8vuAUwXs6IZdtPHv1t+YgYjO9sdA2OjxJFU1GFVG0wB/ToAJZdb33n3knV1fRkA7KRn0rUmNDr06k4S7gYXYTxo1SH/cn8s+WoODK7OElkQxmqSd947bADHNCyM85IiyxAMA0WX6vzCLoNvdbFdBl5u6gKuac7H+d4A8Fh0CwYEbVH5ke3/etiv4bjQeYROz5FXuRTcLlc508lxFM5DeBPAfubyILanhXyAsmLEHPEyfaKylf2dhcCOSH4FShD/Zm4uAbOOa0C0bASDjxGSHoTd4IYlnMIjI6zih2bPBI8M1LDUr9nh72kwMvUGgWSQEglOVNT972Ll1x0Y2F0X/l27tPFYtMLQrEggjJsEdsLxABQUUh+B5mWcnzJ60ldmt/2T42pkJsqhzwiXstF3K3Cuy05npuAe+xnax1m6lRGzJL8gHdiyk9MpdDT4xPiMzfWbY7i1MZenCdYtptMPazXt2Pfa13uqqNNaRHLZzwXlOShzSJdRVJPCZXfglzmtTNeoz61MaooJdA3bW4b76hzMgoMrKMvmeC/x+M3ZbtWLl4mLw6cUF69Aeph1U4fw9UyJTDqFHS1FFoh3SmCWg/0LtKknd8fO1rdL52A72+6zmHXPV/rC50jWQ8IK2VjgUXBg8fxk+aX5yU5mwEaBpMPma/rukKZ4hpNI1zqfl2qdI262sehSR3HKVc7vZq1i12eIec/2hvTuXiQ8kTOw3HprgKzHnuaMIVEycVX1gBoYQMTUt3SD1FBEYfEUztsXhSHemKInkBrxugOury8tDa11IdM1H9+3yuks6jpAi13ysDUra+saFWPcsGkGw1qQPHntmVt0ikxgIOqe62z9fYGpwlM2QwyxtwgvMh4PlJCRmJABOcLAGvNl93ZolNrWsZ8kwF5ufU+vqMb+P94WIeJdqIjdLYvBELIFWLPD+IETm/sMy3fKQIbmh5/buewZ48PukENAcQGV708JwaCU1s/6zDj0zxcl0Y34wZWZY5IWo/dn3fChXHQexdeR+7Z9QhBg5Ydj8i1wE7EsBwGLhwANyvw9gUVasyGvEHnzzyvsHFEyWnbN6JaQ0FglfyPqG8v2fwTEdI2MvmATHYN8J6yen3y7xf/Cf8xCXAa4F4HGsEnLfAscKNQblRStoziiylUAT3g25LGy635XFA05mKF9/djo9jvHbIY1GO52P73TUm+N1G+MM5V9vM4w+G6JDpp8/dJgamN4HncrzyZIK38OEV/rflOrPFYkPvl6+wNRtdGC1nbPsrtl+1nIdkcv9ZSwYubEGC+g5b83aEot0fs9OHMuJB0SlHCX658HLGDYODVBtzfWqZnmjMn8U6U/YarhUXHjvMKgf6PGY8eYnnwr61NxITs1wk5uG/bKdtEu5N5mnr3CL957U6xsbGCijAt/1he5NV0LYxKc/NwRwjPdmNgkk2hi/4JaXDCpjHLdaoVyty/Or6/qh+fQGU2DYMxAVyBPMisu2IyT4XUX43gatggtU7FiLERm0lOFtbk5fioalfAXQmTj5P4lVdgso/5gBqE/t25MVJTUTuUVd5HJFNNDH1NFZ2dnshHFdbYEsEeFR+bXc4wNIXoS+gRPp5/6u33VFBQjD7R4E2my+kXKof3YOf1R58GDz0jLSi08SR+xRI+s4zTWqDCmBAjIXrsuWge9Q/rUMprMcUSRv75JIFzBRnBO24GvXzo9UTNdcj1K9Wu3Px6sOBxWWqJqeqRT62Z72GSuE8VXbe0APFVDXTI8iFm+PSNRTtt8hmhK5ce9G7Otr9mAo10WLJdjR6iGW0P/VdYbEXSyYQ3tYn/NvHnaUPVXZxftGG4g0ymz1BGWbfYq5FSwqKx3YBt1zVJVRkfg+HyeWpin8OvXzuwB0NP47+XKIwDTcH34IKHxdxE2t1RtB9QCSKQ1B3ijfa/myLXbkoPNr06nmcVUwdn2xIySIgc3A/DHFzGlTmC0olfoixGF7l1tie8tDl7Zlq/RyomNr67RnZY3l1JPOIuYIl821jd204kHcgRmNbnMRaNZbrWlrdMiQpOmsrROYjFho+7MgO5H43N04eirwMAKQEXhQP5YtFMHzXqAZmAuI15E63c9AHw8FQfGt07hmol5mXbVRHZKkstjsYmb12tgofH705e2aoA4W82lPv109YVwXzowfMsF3umnLFad/oUvlxTXU6qOq9B/9FRIlrmLdz2L7zLY1PfQ11TLqmLjrygKgno2799W+Ze7HBmDKaPR7CRAPwY7tP71ilSV3mtIXUk0eVn5OZpMlUwD9urYMsL+G86w/qzO5DYFy4EsSwMLDANNnIgQDBY/GWIyMjOfDgo0E8bMq7dD5EXr/kxbrOCH6CRHcApar2DP7EdW6A4JmqtoiIgtEcf99jm2MaIplC9OhArWqq/qX/VU44nT1RxhxKi3XxdrOpzEsmDvKA41TggwRn0oXI3wojQcRQcFsUBdGt3x+K1ohiJ9nvXOh+AcBVg7P6JFZJbt69kFgNybS3q+Jyy0OKAEJdLtW0jDHem9p1HQJOUiRZChBG0xpI3VajnJcpgSpjoxkuywQYAPoOM1zIEr+MRieh5OunnDaQ9g2ABne+Ofg9+s/KtiDv8ZA4l+o2PZA1wm6CvjiXrcB/xKoaszghe2358mnOIQThz4QVrSVoUP4b+s7hmEE3u752LsjAxxCN2NwsASW1FsrBdSSe12XcQ8WB503FhE/v+7EQJMCOXTOXnrYM5qicOvJs7LDyXb0uhDz0ukydl042/u4JZnsmuLcg1/DX3O1XWJjQclwZjKav3YoGhEOZ3NI+dPTZPu3qaPfSs4h263VxPIto+XENXLN2hsQ8clkRmBx5AQq/SpTqJD2qePaALnzInHjunNxOe7Z3Vc1zIySoS5qOirkqJvVwdkoAfeUPP6we7ooZ9ozo0emnSZtrUAIOfyT8+OCYvwbtuiUxX5cUW40mwcB4cv8LFv9SGY4a6ZXd989MpryzlYX6y0rk01zKevhTD9mhxKGaQSBEW72uIXT0yu6Rcp1Px9Dm4cT/pqCl6j6Y6f15HzQEZ6rtsADAxMT3un49OdeB4EtCe7om6NfFVCWrcPuwqnFd/He5bE8htW4V5wlWVYt+Z/jwE75GS+V/StkVK0dXPpDEUBeXl49XPlXfQj6Z1L+jYvHAedl4OHSXb6NJDl+I/8AABgpnyyPcLss7I+vX0ebf8dvLIY0PnWW+uaBOi0+0HTzvofQiM85AxSccRxGQNyFyBKw/Ylj7HIg1WC/JcDW7Ug7OF3z8X8vK8HfqBzn4JJEkiNthKxMYK/sZ5hmRAZXRKlSXOB1HIyKROvcKP80teTHw3/wr2ZSoUcXGMxw7GFLYiF4fj5PHjmLUmYaAJ6EpZxw/xvoqrFHOR94/1fHaFD10OF6kW7jpvJFg4dEnkyVPDtXv4AsXOE+slaKrHMmuACSuD+jebh4brgKk3g64dh2+U=
*/