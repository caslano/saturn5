//  (C) Copyright John Maddock 2006.
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_MATH_SQRT1PM1
#define BOOST_MATH_SQRT1PM1

#ifdef _MSC_VER
#pragma once
#endif

#include <boost/math/special_functions/math_fwd.hpp>
#include <boost/math/special_functions/log1p.hpp>
#include <boost/math/special_functions/expm1.hpp>

//
// This algorithm computes sqrt(1+x)-1 for small x:
//

namespace boost{ namespace math{

template <class T, class Policy>
inline typename tools::promote_args<T>::type sqrt1pm1(const T& val, const Policy& pol)
{
   typedef typename tools::promote_args<T>::type result_type;
   BOOST_MATH_STD_USING

   if(fabs(result_type(val)) > 0.75)
      return sqrt(1 + result_type(val)) - 1;
   return boost::math::expm1(boost::math::log1p(val, pol) / 2, pol);
}

template <class T>
inline typename tools::promote_args<T>::type sqrt1pm1(const T& val)
{
   return sqrt1pm1(val, policies::policy<>());
}

} // namespace math
} // namespace boost

#endif // BOOST_MATH_SQRT1PM1






/* sqrt1pm1.hpp
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
*/