//  Copyright (c) 2007 John Maddock
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_MATH_COS_PI_HPP
#define BOOST_MATH_COS_PI_HPP

#ifdef _MSC_VER
#pragma once
#endif

#include <boost/math/special_functions/math_fwd.hpp>
#include <boost/config/no_tr1/cmath.hpp>
#include <boost/math/tools/config.hpp>
#include <boost/math/special_functions/trunc.hpp>
#include <boost/math/tools/promotion.hpp>
#include <boost/math/constants/constants.hpp>

namespace boost{ namespace math{ namespace detail{

template <class T, class Policy>
T cos_pi_imp(T x, const Policy& pol)
{
   BOOST_MATH_STD_USING // ADL of std names
   // cos of pi*x:
   bool invert = false;
   if(fabs(x) < 0.25)
      return cos(constants::pi<T>() * x);

   if(x < 0)
   {
      x = -x;
   }
   T rem = floor(x);
   if(iconvert(rem, pol) & 1)
      invert = !invert;
   rem = x - rem;
   if(rem > 0.5f)
   {
      rem = 1 - rem;
      invert = !invert;
   }
   if(rem == 0.5f)
      return 0;
   
   if(rem > 0.25f)
   {
      rem = 0.5f - rem;
      rem = sin(constants::pi<T>() * rem);
   }
   else
      rem = cos(constants::pi<T>() * rem);
   return invert ? T(-rem) : rem;
}

} // namespace detail

template <class T, class Policy>
inline typename tools::promote_args<T>::type cos_pi(T x, const Policy&)
{
   typedef typename tools::promote_args<T>::type result_type;
   typedef typename policies::evaluation<result_type, Policy>::type value_type;
   typedef typename policies::normalise<
      Policy,
      policies::promote_float<false>,
      policies::promote_double<false>,
      policies::discrete_quantile<>,
      policies::assert_undefined<>,
      // We want to ignore overflows since the result is in [-1,1] and the 
      // check slows the code down considerably.
      policies::overflow_error<policies::ignore_error> >::type forwarding_policy;
   return policies::checked_narrowing_cast<result_type, forwarding_policy>(boost::math::detail::cos_pi_imp<value_type>(x, forwarding_policy()), "cos_pi");
}

template <class T>
inline typename tools::promote_args<T>::type cos_pi(T x)
{
   return boost::math::cos_pi(x, policies::policy<>());
}

} // namespace math
} // namespace boost
#endif


/* cos_pi.hpp
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
*/