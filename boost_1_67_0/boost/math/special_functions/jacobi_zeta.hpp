//  Copyright (c) 2015 John Maddock
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_MATH_ELLINT_JZ_HPP
#define BOOST_MATH_ELLINT_JZ_HPP

#ifdef _MSC_VER
#pragma once
#endif

#include <boost/math/special_functions/math_fwd.hpp>
#include <boost/math/special_functions/ellint_1.hpp>
#include <boost/math/special_functions/ellint_rj.hpp>
#include <boost/math/constants/constants.hpp>
#include <boost/math/policies/error_handling.hpp>
#include <boost/math/tools/workaround.hpp>

// Elliptic integral the Jacobi Zeta function.

namespace boost { namespace math { 
   
namespace detail{

// Elliptic integral - Jacobi Zeta
template <typename T, typename Policy>
T jacobi_zeta_imp(T phi, T k, const Policy& pol)
{
    BOOST_MATH_STD_USING
    using namespace boost::math::tools;
    using namespace boost::math::constants;

    bool invert = false;
    if(phi < 0)
    {
       phi = fabs(phi);
       invert = true;
    }

    T result;
    T sinp = sin(phi);
    T cosp = cos(phi);
    T s2 = sinp * sinp;
    T k2 = k * k;
    T kp = 1 - k2;
    if(k == 1)
       result = sinp * (boost::math::sign)(cosp);  // We get here by simplifying JacobiZeta[w, 1] in Mathematica, and the fact that 0 <= phi.
    else
       result = k2 * sinp * cosp * sqrt(1 - k2 * s2) * ellint_rj_imp(T(0), kp, T(1), T(1 - k2 * s2), pol) / (3 * ellint_k_imp(k, pol));
    return invert ? T(-result) : result;
}

} // detail

template <class T1, class T2, class Policy>
inline typename tools::promote_args<T1, T2>::type jacobi_zeta(T1 k, T2 phi, const Policy& pol)
{
   typedef typename tools::promote_args<T1, T2>::type result_type;
   typedef typename policies::evaluation<result_type, Policy>::type value_type;
   return policies::checked_narrowing_cast<result_type, Policy>(detail::jacobi_zeta_imp(static_cast<value_type>(phi), static_cast<value_type>(k), pol), "boost::math::jacobi_zeta<%1%>(%1%,%1%)");
}

template <class T1, class T2>
inline typename tools::promote_args<T1, T2>::type jacobi_zeta(T1 k, T2 phi)
{
   return boost::math::jacobi_zeta(k, phi, policies::policy<>());
}

}} // namespaces

#endif // BOOST_MATH_ELLINT_D_HPP


/* jacobi_zeta.hpp
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
*/