// Copyright Nick Thompson, 2017
// Use, modification and distribution are subject to the
// Boost Software License, Version 1.0.
// (See accompanying file LICENSE_1_0.txt
// or copy at http://www.boost.org/LICENSE_1_0.txt)

/*
 * This class performs sinh-sinh quadrature over the entire real line.
 *
 * References:
 *
 * 1) Tanaka, Ken'ichiro, et al. "Function classes for double exponential integration formulas." Numerische Mathematik 111.4 (2009): 631-655.
 */

#ifndef BOOST_MATH_QUADRATURE_SINH_SINH_HPP
#define BOOST_MATH_QUADRATURE_SINH_SINH_HPP

#include <cmath>
#include <limits>
#include <memory>
#include <boost/math/quadrature/detail/sinh_sinh_detail.hpp>

namespace boost{ namespace math{ namespace quadrature {

template<class Real, class Policy = boost::math::policies::policy<> >
class sinh_sinh
{
public:
    sinh_sinh(size_t max_refinements = 9)
        : m_imp(std::make_shared<detail::sinh_sinh_detail<Real, Policy> >(max_refinements)) {}

    template<class F>
    auto integrate(const F f, Real tol = boost::math::tools::root_epsilon<Real>(), Real* error = nullptr, Real* L1 = nullptr, std::size_t* levels = nullptr)->decltype(std::declval<F>()(std::declval<Real>())) const
    {
        return m_imp->integrate(f, tol, error, L1, levels);
    }

private:
    std::shared_ptr<detail::sinh_sinh_detail<Real, Policy>> m_imp;
};

}}}
#endif

/* sinh_sinh.hpp
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
*/