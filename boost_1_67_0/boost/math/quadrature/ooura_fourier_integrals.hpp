// Copyright Nick Thompson, 2019
// Use, modification and distribution are subject to the
// Boost Software License, Version 1.0.
// (See accompanying file LICENSE_1_0.txt
// or copy at http://www.boost.org/LICENSE_1_0.txt)

/*
 * References:
 * Ooura, Takuya, and Masatake Mori. "A robust double exponential formula for Fourier-type integrals." Journal of computational and applied mathematics 112.1-2 (1999): 229-241.
 * http://www.kurims.kyoto-u.ac.jp/~ooura/intde.html
 */
#ifndef BOOST_MATH_QUADRATURE_OOURA_FOURIER_INTEGRALS_HPP
#define BOOST_MATH_QUADRATURE_OOURA_FOURIER_INTEGRALS_HPP
#include <memory>
#include <boost/math/quadrature/detail/ooura_fourier_integrals_detail.hpp>

namespace boost { namespace math { namespace quadrature {

template<class Real>
class ooura_fourier_sin {
public:
    ooura_fourier_sin(const Real relative_error_tolerance = tools::root_epsilon<Real>(), size_t levels = sizeof(Real)) : impl_(std::make_shared<detail::ooura_fourier_sin_detail<Real>>(relative_error_tolerance, levels))
    {}

    template<class F>
    std::pair<Real, Real> integrate(F const & f, Real omega) {
        return impl_->integrate(f, omega);
    }

    // These are just for debugging/unit tests:
    std::vector<std::vector<Real>> const & big_nodes() const {
        return impl_->big_nodes();
    }

    std::vector<std::vector<Real>> const & weights_for_big_nodes() const {
        return impl_->weights_for_big_nodes();
    }

    std::vector<std::vector<Real>> const & little_nodes() const {
        return impl_->little_nodes();
    }

    std::vector<std::vector<Real>> const & weights_for_little_nodes() const {
        return impl_->weights_for_little_nodes();
    }

private:
    std::shared_ptr<detail::ooura_fourier_sin_detail<Real>> impl_;
};


template<class Real>
class ooura_fourier_cos {
public:
    ooura_fourier_cos(const Real relative_error_tolerance = tools::root_epsilon<Real>(), size_t levels = sizeof(Real)) : impl_(std::make_shared<detail::ooura_fourier_cos_detail<Real>>(relative_error_tolerance, levels))
    {}

    template<class F>
    std::pair<Real, Real> integrate(F const & f, Real omega) {
        return impl_->integrate(f, omega);
    }
private:
    std::shared_ptr<detail::ooura_fourier_cos_detail<Real>> impl_;
};


}}}
#endif

/* ooura_fourier_integrals.hpp
+vZ756XShnrjebmY/PmxP5VHQVMTBwIPDFuDQPLVaQVCgoOLUWVVo9efvrXxJoWUYzzG7td/+xW8gRLU/xX7fWgdp/Ibu+lftvXjE5/SjaZnNvgc/6BbVGBd7O0024qam8qvvWEJlbRfc1kozMewvxfiCwDtXFPTmaj4yK3w+0M/U/pj9xPfiBg+L31Dpw5V80QA44Dk5Y0HB5nm89j5kMVwbRN9Ad3Z0qEetrm8YqWgEIb5dYgjIdW5INmDBmXOvkluFP6bBceVJ+2upEIbMAQhVOyine4LKWHe9Mc7zQmSh4or7isv//oNBPLIJibkn/TDm+q7wheQ1Smh8b2IjdX5Dk+8gswFfAIVEj/ADb1S/RfV5UjyJ/TkV3Jyp2Q1MRVbpYCMkS6uW0mjE9qxU4KVeomtQ6NuyZA3nJIf86Vy67Uult6qwKv8pTrzlkPEg4SIlogefOCF+MMPOx8/ClldVHOn7ZSTHT4sgPtGNQnFPFvdB7qZE88fpc+PB3rvk6tfifzHohflFNpQDTGk8eNHMJJi1EPB4aq5AO49gxZXxrncp2H5RfW+tG5QEE9Z71swD4DUC4UG2yYljc/Cq7WKGeNSiN38yGGpqWY5vVbXV7UkPT0rMK8QFZe8ZWC2WTeWoHVvyrjGVEGF7dPZyZUzCFCxmRNBzVnWHio8GPv0mH0smtd+ZWEV8NSbhxaLrze4V8ptoZ4cUCON1tmnWniJokrj4hy6pOPe1at+s43MyYhhw4kq45v2zf352ydFw6bOoFRWcdHoF7G6zpuR40WM5YQddgfyJms6sAlatircn+8lGdHQd6cWFQw77cVR3aNIdQ3mCIGWAqt55GhtsWZdvri6ROUJ4mD7BbFo5eACxixvPU3gHD8KO7tPCpZKH0W6eUDti/BQM70fNBmxmQaw032u8tw+QnyYDNluonBNkbIpzru96n4xVQOnvFkBCtRcJhesZ8zbIyOvFRQxPUgjG50HA+V+QxuY2R5Mceep4ngFh5ErURliKAGJBfsmYiEgB1KqkQA6MDoqcs12PcBO4V3sNycOYAyr3GYm4xr4RhSpV/0WC+AGVMjyXdsBBNxMI6y1lDtbTezSYRFQ10PRToEPP53liIOhFV+GQjV5CyvQ+9C2nBT6ClAIHAxNXvjhhJvy0WwCb08KY/Asj1Hgeldb5Z1NPmlKZ9CeDaBmWLKf5Bn5iEU/0HWpHg6f1lzbY5mPJhn/T7GPFUFtC+KArh+ZRjJGyh93BlJhDKJtuKqXvL5M2Xf9I+f+z223iMN+6Z3Rw38ox+tBL5QTEJ2QasaYGir9jYOP7PvhEX9hK2QE/hLSdIqCSTUlkdehqxvKZS5XVYp23cEkwckH/b9ZPhfCSE7bP6iE5aNWfOhPfgRX4quQu2/JM8i/wMYtEbTJm5+GVf3b8qZLeM+FjMLJIh42asfzuh5fX2gJZ33gzOfDFMzlk5XNsDs6EiiSse8UWNRAbMwby/M9OLaw7BtTDkClRct2F/jIlWkziOByEa/WNimQJk6MDpA3TPhqJg9IbmWz/TjLej1LVlUrG2cWZPhL4HjGeddSSfo9xQNWVm2KrbRJgt6VeTX68XzBhZiVUNbe/0g2em61OfaWqmVspqonEtl31y9dqkgvszMlMz8/MDj5iPj4Y6kln/cWnVBRE29KQ3Hkxu1YgcHZcWBGRygdiowLDia0WdHOjDq3FaV3TbqtkMtEafvQAQ79JdfcTay5nlWWsTpZLyqQswq+EI+QCYpagbLFGzg8MWCwnvYBQPztLV2qss4n1+9qH3Uj8+394hORTV8oOY5mRH3KWkoSy0r3Kuw4He1zOB+GRSny5JTNb9yvSBZPYgLDSUXfJyzgOG60KfMFfp4opCspVrdlwyd13+tuOAEVGOKUB8b19lNM2qlcUjwxpxrM6ki3CiQZSUFScQfklgusVYqoUcs/TPObzckJfMY+Bpu/dU2Lu4YJVtzVDclK4HQbYwLf+ZSSYmWGsNszijSQSC7RDdqFlzAkVBFvlO1KCRxlJydYTXfLORnxZ/+UHcvaQoXKS0zu94j6/rhSJJuhgRnw2tdCl6QzqG1kWzhAH/j6kNMkF061LjLhoKAgSrY7XD6YqUlQdX9ipmeblcB4LWVs0oCHe57MQCdPxwDen0bNUOEelIiRCBcGCuJxcBuZhGfEILSIRZpwKQipWHU608dMs2ll5Kal282ny1UCQjbAtyeh2mrlArew+exF4dBJ+sxFwHTYw//L1a215pcsBPZV5AsThDWV/AKPizgzDJ+aTRtKRuEHZK3tAsM/+Sz2HBxh5iR7IXfazeqs/fqKhbqV3aEQX8ImzbO1Abxo50LE6q3jzrM8OyLJcUJWkMQecIQkFZCnlyWmERwUDwa17W7uBYsSZC09vFsh7SCr1ln0zOlly1Zt/3lizFhttArezrzVBqxpD83Magq/8d3WRetr3Uu+ikTfKL02iWWfPdbKkYZFVo2JRqt4zyCgzjaNJWuT+9iLERt1jLuxkDNpS1sbmOT51TpjTaGi0pDXNoxn79leuol0OXUHIxLMPyU0RKzOcyfUxKlJwZN0jqbZu+loVumza84GFDotOoSOBl4ujrK1ZPbRcFnw/CbUb2VpVOXMHridn0RKOBjBF74d0RV95P6+xl6wxsGSRuKm1jcj1abEbG9UVnsG1BJh/32F4ipTX2G+lh654KyVnbtlODdotShw82HVY8y9MUEadUVss/lafXvcw/1FgxVJtyy7qvIGTJT9jbLyKR4cwRBxOAfccB1Dv5N1kNTZ4KwTKHbhS1U7QwGYVtKpgZ5sKaCXM8DZTSvAmEcGYFitzhbUwk5KoqT4oGmZMaPYP9BcH2dqftjPXHbZlIK5X3hd84Sj21exgpdH48L/7AdAJDTovXryZR+y0n8fGT9oD6bBta7j9DiBJEkWhnwe+Cpl8Xsinz2fyXuA7MKh86dETMhEwUmMnAZkW8roUmq5hD9d5dK09hw1thPNLIv2zXKaRuHeiEClslFdeZ7xKchYGOV2I3VEHd90bFGo8LLQHbOAKk8WoeUfzQOztGz3ogrkmLzaU1pVbqwoOayDgji19xeFVmAr/Hi+RWeRfnLyyNLjBQFMndUsYydfjTt0GB7ATSGewfdFlMIStuCSzf5BuYybmhoprF6YfMCtU+EW6nwQ12Xo5tF2DLildmHpLSR63Q8PuBSwilSUXm1l/iy18W2DhIc7juKwp9s7oEfW+tcfJBfeR5oU9cNHElAKYGgVXJ9+M9vXATr/eO/eXV4j1N1bIs47R7VbyFq2F7HoWJ1VHBRUXFgr4mJDwMqBY3ErjHhBrQtFYlMAGd+nHzezeMteqdzHMsD//HoB/P9+vSAAUHlxUK68hI8RVVnJn1Y2sq5kLK8Usim33LQOrWQxGsBQyZJXis5WmQHI/k8HZbHn9UJqcZfVCfj9QV9K1b8NANxdRCH6uDpAJprW8P54NceXpPi4BV8OK77lGz52peUPBy15EmAimSNFiQOQUJ9h81j2RFgWAEMeQtIVHrcJcZeoF8j9f8TzjxhMH57FpU7FLKlcAJACAUjTeER6lB8E1dV1cLwgWArehT2QHRzn5jCIOBb+9cxlkgVf8aW9Tcq+GrvmCKe7eFsk9qSsmK3Au8nz6wWahrygCGYYEw4fhtF5WN0c4Qthm7c+6bIjPH93seHO0AVmVuaC0doiUUmGdk09x9byATBlz2F5Rq886or7ehEqBPyKAI32PW6WEr7pYj9sjc7FYknoWLWyIY0k4zIxptSr+5ekhTW0D1Vf5e+nr3ajwqyMwbS2j2H/tO7fGBG+OZms+C37f4vz2tKJZfgmGg6TgaEWHnec4ARNW1y1L0W1V7VYddktctyeEgcdGD7XeLQrosmr4SL62/vJW5uVNSzxsNy/g4kSk0/kVEtj5aLFbhtc2bNJRbbKu9MeklAM+5c3d9skAc05Yq7mh2K/8XbQbD4kfp1wP31bzgle3yYDC273ZKm4BK/Oi4SRdlEf6kuoeGpc8ap/qC0Lg6ae7mq9NrbHx7FG+nhpmZIs8uGtkX3f5LQJTtyNzhMDd8GxKLbAdM3Mp6NRyEhHNkOn62NcB9z57whqb/PrbBvXhPNddxZ2hSswjm41FXKTLOhsGrulwPOsrkwvI4JMMb/AT5x8s9ZVzOB3SuRHGAy6/susFJhPz1uDV2FoBe4aJ/csX5xA3q80VddIEOpp2HWJCk5L80vbwvm+9NdKczEEKU3Lng2JJFtzkG7yAJjD8HNktA+mRM1pw9EYMSZF9+IgxErAWtuGwdV/XlT8GMGEpi4POzm6hnp1d80NGSUl/5T6dSCJDUK7LmIGBXDELvI5x1kMj4iwWUAH5+u7ygoDWpsHX7CFyPmWgWsn85Lp8270iq9zXFNzNC8J7dN8zg3uAu07BRTpojdRRS9bokn4bESbFg05YBBlRIARNFneOJ2vOId1djlmCWz3MmPtAcqwBYYq4LzSqMeUHv1sPYkSO1yOlGakT6VwFpystfwHmHYIvXaU1Rm7AU6sEopgC987G2d624TpSIZdZMRMTYaE9oM4X+9u+E15sd3TOdYYf+pEVLTLLYxfjoMfdUvpvqpQU3kMEDDLuWSZ1od34uK4lFTAwUsbXePW42tYBuqsd+N12VNezVcvKrvT6zvQfpy/dE5J0iWp5Wqtx17thkvBcwK/BLWIZkYnznomwmcfhSzvzI+trt5QxZI1qhLna/rrvLHfhl/i+y3T4x1tLNV7KTgouXfvAp8E+jqcHq53nVwbG9Ywna3pUxxGeAeuJXkEB4eGQnoAmXWMvFpuJ74sEcJfihLEcVlrO7rWAIegkZiJLPj2bzuyvnZ+VxOvRAJsH7JKg/CK0B1oVBkD22Ow1DXUVaS1tFTBo0lT6m8+XjMJFcaw09GfxBCzu319xkrwpkbnGWO6WgC/CQHRqZMNuv00CR/bGRNNpO+Z6T7UKo8C843rt2ChXPXzVNlMN8c8WNUeKqeHo2wIIsGLfWzhmnjIb0f7y3ysYfeTIkOKUDltVD/9D+vDGtgMgu0pS+/FynsuxmeXGw5Yki2ZT1qdNv3ZlHY6rwCimElWnwhAZLHPKbROIAYxcBQ3vvNug8KH6fv32tkj+LNvQ8hk1/Lrz7L18KhOnanwSzH5yhtDGPO+Et0zuIg9nNzwHI9w7f5pUhBybL5UfgsQu95sM1JXQuCv+OrkEeTZNBwibzNMk2eVIr35BkdicCKr2RAPDxiGWWzL6huetqTrlpz/86/QMU2+b77JuX6ErrPmVe36PBLt8nUOGgCT5ONNVw3NU6gwcJEk3lyGRz9MvuMMdrpTTA76yjCzyAEKa4uIOhwcONiKXuxsYi3lPkR8typUrBFyc8TzYpxOhFn1AXlRU0y7DwmZ/vAmNCij160yFqjfuvv3qsVNLd7Tl3XM7miI6FolW1Iql8bhfBlcxIiX0y7l0Rii3HhIobxnVtfJnp9dK2198q/haxQsqIzipZkREJttuAMohc8M3KbBwWKwhmF4D9ku6MzMCYYeNfStQY/FLO2shtW9kOesUiLuHl0KDnXHWcvDsEvPYrVz+z3fr/A2p7V8EmLW2TLU6xWc6SsNKfi3HznOIylwcY5ulqfAdiS9Fo81GC0sKCaZB4/rCqT4nZkuoJfc+7gEhnbHmwVxxcchnuNJ8KN28oAzeKIg56cGZMx2sU8gG/HkaYK8p1wVl11A9UUweQTcU4O61IdTKX2Dn017QoSq6oN/5SfVj8URbTfo+q5Tq6VkSJR/KyRo/2rt4TG4M1OMkGHNwnjVtyzj2T132qvNwYrqeD6AiBE+oA58j0Nfc20dcjl19sNM7H5dlLwoJhjAOYn2djkDcrGowccuxMJzEH949PRMsZ/dJeHwhCeRcD0sRMUE54AtbvA1New5BfIjDLv4endUyi6KfyaY2gAk6WxXIGSm2M7Wxs5KbbjLV2PXK/Kd/JGkw414+nS0tHOXxWv554jInSNFBzHBaLzWtI9BBAZiAw7O9cBPbCgufJt9Lvj0NVBLyikvsiQfJ7nEKy7Qcw0rZdpXAPrcCZ4rMMT1uAs7jXIhbQ2J0VoW9Xr+cEPU304E5iGtTHTgxTrFHBAdu/uhYVQs+UMagTsD0yKbYGdjHQ4SOCsRiHW326Ndx+rv301rq/bbytWqZjd46gZefPrNcewIpfcA/4+B8ZtaCo2piPxtD1QdfIZkTdzQ/MZ73DeSXideXvoLEdiH3L8nti+ILAXnzC//84d/grOs5QoiXD0bAjkSCl0wsHPK8dOuAYws2uVYTrF0ygC56MMi1SSId+AsTGIyXlsfCH45ZVDD+dBAAnHPXGR06atSSJER4ZGFw+5myYvO5am/PDrrUJVmjedj6m5Gu/zE8rnZXWufHgQgOXxpl8u+14QnL1LECWoHOCtfrthox7YFcpjKYlk7q4t11Jez4R88PqEJ3AJL3JBfiPUfcQdGXY5ha/Q33ZF4ndtwY7mJKY94DsnkUXZWNPHnRhEp9rpWdoBO2NTHo8Ybx7Sz9nkS2l87WNBZbHO66Vz4XvqNHYI86j1Jh7fT3NYkR/jGKUlUydnhHjnDQgqTs8TrleIFFjp5l3A1apJ2t1lCjdvkkq2YF7ZWgoXm0FFijExiVdSYjdsKNXJVgx91/aaDcUxt8J5bmFS6DR9387nd3uZCceWLEpe2IJtQTvAAGbIM/fj9l6spkuRNEGcYxBZbqrbRH/NJUbmJyclluBIRwddH+hsUNc6RafP/IqKU2TU07rkbuAQkk/fRgZsuz96QOAVi7Qu59q5yv1dtVMti1I5jqhthGJscrIQVopljozWOWEOLxywnso9icfFZ003bYgL3tdI8bJdiolh5naBEP/pg0a2N3bGEJga10Wte95FrOyfDTd2tzp9rv85/QzT/NEitf3P+G+Lb/pG1PUsJcFXs4E9MC+ND8XDBlzPEI44LaXAVQFxNYC/naiFYS5lxK+MuREx9FdNUEMYOFwcOFn/5JmKUl7hvGgTylrIeBBC6urQ6BkSiD24AjXHLocwWeP+7NvCSBuTL9zjiD9vlwzqglM0cEwU9AduK1AXpgnB2ilgKaj/2Jh0QbS7qSXR7YzQNVSl35QeRf3ctIdGZLHRpnr2YB8+DVu4n28X2Vuw7esISth2pm3gCNqtnvEI9nuYRaI7TQ1yDuFVFYwKiszJw4L46Lan/h+PIQyCpB4xhq0EYYClO2uX2FXo/uRB2qP427ySzkx6J/XJs3Vs7PsuqWuWXxqatIbrmkaVt0XZ+JCe1vXPTSxkSM/u5abeyKyaogSesPiOEkw0wkaZoKNV/ae4d1i0vuesJSyuLbJcpjFhRHSxMgELQ1FX+XwPn3FG6C3QMW8mZjgq7fcx3dJn968KfEwHT+pF5R0WJR5ya7vGR7rjvtm0MAOA11mTm42mj99uQrvngxovR+qoZ8Ty+11WryOoij+6NGmn4RjHM5B04qCY7gdRqmIqh8sTYBtJ3xCNQmqjcPsoeCOJIzFQMU01Q76Nj5zeJWWGZ2ARwHlXX+eHePurQ7dzFYj/hX5mx5wcUb4oy01hileHjWwpafdC4dovAlX80rHo/bbSqsvAiJHx80YcJlDnicwAeAyo5Jj9Lv6cHnZPxjczQOR/u+/pQzfZv+XcYRVbfuF+4L+jolvTS3DjyoDByl/T8Bs9JZK19WqG4w3x4C/NH7YSeWN8HvH//JdkxJpUlK2e5tH/+vH78enS0QGEBJzZklLY9dH/4/vroXbvIya88Sna3axVF0IhxWiznx/7XPCKZdMxA8VluLkurOKGqhn2OsrzlnaNWi3gbDDRukIFlhIW4EalU0/4WRHVTcweeW9Ye820Dfm4kbXZ5Yz+1UWmERa0LFUW7Pc5VbIoVK8UFqwMHx1yF0OJ3MrB2bZbdYL37/qnB/PNJKrJGjcfINjwRGmfnOOQkf331Zsul6vA1brIvBoEaqjgWppO3xUnec++ooMgxy0AHpymNJwCYaa+fNkzYXuQgprXMCDyLM5rHf3Qs5pzAfsIaW3QszeJD+NrxAguwoGUY6s8+h/5+FOZXJMugCT+MwRv+L9z+XdFHBmxPhs0812HpaZCV5cEXa+cwnnLPxTyiWCJRn4GCJ4002cqUdgKLoyxNCshivcx/tBIX2k8ZKtDbywo7Rr2gYFg2CPpIcxtyN+8oMbU+xa9uzQ/GasvTNtJ8Dm8ciuL0B3o5rKA/t4ccPLk36PkjNlByXRcqna3JR/ZmJ7wx/yW2KCb8iAgCVKmjEotURwaBmMrTTiP7uPxIAucsoe3fWcGuEIyJprgrS+rXNqyj6OqIz7kVPXKLS0t6fbCC+tnQ/lVffiZS/p2H4e/77pyJx5tznb9GgnA9dkFTVSlUWGZ1oP9uyEJ1o4cM/Wd6NwJE77+GpCaJwGxfiMQVamr1jFj1DCWdJArLxdwBWHtJicTXpoSXAPPrCVKjdyfIyQCity3nq1X0QfpO1CSNCE04WDCSId/4FR9js6vrp1OvO2imP5iC/arDztCOgrQXd74sOJ1lOWpK5pPYT/WL0wy8wLH8cPP3k/NTO8PRQmJb/Uw+CMynLKo02DnzGL7wkS3Q1yZQw27ngiyPVmSR7MU1dsKfZDQj/OlLy7jhxMa2oqUpd3aqoo7W++qIdBVjun1CHArCi2xPyLr7HLOrltqwdu3HJir43Ky3j9Jqie99nik/26qQZa0LiErWEkmT8A/jkx5+EsYm45fbm/ySGCF8dJxsQ2agDqzM+J3A24NgxmJ6rUqEN1YzVCgtqrzSFFRaR49hRyGsdwaAoaR7QhTU/l86bPvsD8/CML6SV/MHXIIumCM8r44hxZm2DYyqZ2cYDOdmivc0HRGiGb6liHHE9bK2Clguv/c9sEqjtaxYjvxdE353HG12ZkWFiRV1uRRFiZNX1yjAj+W3o/r2rdDfFO1wmF/UD3cWxtng/SwldGyFtYTbDLMx9EbBPLy8/l2oJwCECJydsl8KLP1OGE5fobIRylEWcCHb0znGNiTAAZiRcL7Xx6Lw0m4k3thNYlefC9P8oMR91BW8yevEJdloL2cLpC79pJRQF5FGh89nZMp/LjkIiQ/1ef67w4reEFhe2UddQIlzm7i00tGTfBZDzsR6daxOc4XWy/FQQwqTyCM=
*/