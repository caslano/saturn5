
#ifndef BOOST_MPL_STABLE_PARTITION_HPP_INCLUDED
#define BOOST_MPL_STABLE_PARTITION_HPP_INCLUDED

// Copyright Eric Friedman 2002-2003
// Copyright Aleksey Gurtovoy 2004
//
// Distributed under the Boost Software License, Version 1.0. 
// (See accompanying file LICENSE_1_0.txt or copy at 
// http://www.boost.org/LICENSE_1_0.txt)
//
// See http://www.boost.org/libs/mpl for documentation.

// $Id$
// $Date$
// $Revision$

#include <boost/mpl/fold.hpp>
#include <boost/mpl/reverse_fold.hpp>
#include <boost/mpl/protect.hpp>
#include <boost/mpl/aux_/partition_op.hpp>
#include <boost/mpl/aux_/inserter_algorithm.hpp>
#include <boost/mpl/aux_/na.hpp>

namespace boost { namespace mpl {

namespace aux {
 
template <
      typename Sequence
    , typename Pred
    , typename In
    , typename In2
    , typename In1 = typename if_na<In,In2>::type
    >
struct stable_partition_impl
    : fold<
          Sequence
        , pair< typename In1::state, typename In2::state >
        , protect< partition_op< 
              Pred
            , typename In1::operation
            , typename In2::operation
            > >
        >
{
};

template <
      typename Sequence
    , typename Pred
    , typename In
    , typename In2
    , typename In1 = typename if_na<In,In2>::type
    >
struct reverse_stable_partition_impl
    : reverse_fold<
          Sequence
        , pair< typename In1::state, typename In2::state >
        , protect< partition_op< 
              Pred
            , typename In1::operation
            , typename In2::operation
            > >
        >
{
};

} // namespace aux

BOOST_MPL_AUX_INSERTER_ALGORITHM_DEF(4, stable_partition)

}}

#endif // BOOST_MPL_STABLE_PARTITION_HPP_INCLUDED

/* stable_partition.hpp
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
*/