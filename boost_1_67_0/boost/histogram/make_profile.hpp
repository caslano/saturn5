// Copyright 2018 Hans Dembinski
//
// Distributed under the Boost Software License, Version 1.0.
// (See accompanying file LICENSE_1_0.txt
// or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_HISTOGRAM_MAKE_PROFILE_HPP
#define BOOST_HISTOGRAM_MAKE_PROFILE_HPP

#include <boost/histogram/accumulators/mean.hpp>
#include <boost/histogram/accumulators/weighted_mean.hpp>
#include <boost/histogram/fwd.hpp>
#include <boost/histogram/make_histogram.hpp>

/**
  \file boost/histogram/make_profile.hpp
  Collection of factory functions to conveniently create profiles.

  Profiles are histograms which accept an additional sample and compute the mean of the
  sample in each cell.
*/

namespace boost {
namespace histogram {

/**
  Make profle from compile-time axis configuration.
  @param axis First axis instance.
  @param axes Other axis instances.
*/
template <class Axis, class... Axes, class = detail::requires_axis<Axis>>
auto make_profile(Axis&& axis, Axes&&... axes) {
  return make_histogram_with(profile_storage(), std::forward<Axis>(axis),
                             std::forward<Axes>(axes)...);
}

/**
  Make profle from compile-time axis configuration which accepts weights.
  @param axis First axis instance.
  @param axes Other axis instances.
*/
template <class Axis, class... Axes, class = detail::requires_axis<Axis>>
auto make_weighted_profile(Axis&& axis, Axes&&... axes) {
  return make_histogram_with(weighted_profile_storage(), std::forward<Axis>(axis),
                             std::forward<Axes>(axes)...);
}

/**
  Make profile from iterable range.
  @param iterable Iterable range of axis objects.
*/
template <class Iterable, class = detail::requires_sequence_of_any_axis<Iterable>>
auto make_profile(Iterable&& iterable) {
  return make_histogram_with(profile_storage(), std::forward<Iterable>(iterable));
}

/**
  Make profile from iterable range which accepts weights.
  @param iterable Iterable range of axis objects.
*/
template <class Iterable, class = detail::requires_sequence_of_any_axis<Iterable>>
auto make_weighted_profile(Iterable&& iterable) {
  return make_histogram_with(weighted_profile_storage(),
                             std::forward<Iterable>(iterable));
}

/**
  Make profile from iterator interval.
  @param begin Iterator to range of axis objects.
  @param end   Iterator to range of axis objects.
*/
template <class Iterator, class = detail::requires_iterator<Iterator>>
auto make_profile(Iterator begin, Iterator end) {
  return make_histogram_with(profile_storage(), begin, end);
}

/**
  Make profile from iterator interval which accepts weights.
  @param begin Iterator to range of axis objects.
  @param end   Iterator to range of axis objects.
*/
template <class Iterator, class = detail::requires_iterator<Iterator>>
auto make_weighted_profile(Iterator begin, Iterator end) {
  return make_histogram_with(weighted_profile_storage(), begin, end);
}

} // namespace histogram
} // namespace boost

#endif

/* make_profile.hpp
Y6iYswBBcMER04DKVAILajDZ7VZqj9RymFh0eFwc5TZWBoSaU2OafDO/VJs6ZqLktVjZEbGXwr7GKPJuQ3BK010yVqD/ICAJ0pioWvG09ZWSpI5xgr9Hj25E8WUTGW01hQfrmoo7A6S5EJt8tfDoj6tT3DY+ImL2dmJmN9KesSyqH13SFwubh0CXDgTiiPZVeYo68uAZlmhPqG0Nv0uW6+hw78DHEN103pTnK0ZagnK81d6ahr4mATrHU06KbsGK5wNiQFYSE8/Jl3FO9BWLTrTwjEKMm2JeTw9bllzzJIf4pEMkq7yb8EpVoHeFew2UfIGeDWdp06ucgvsYq1hIoKQ+YoO9ExNCWSjspxRcNiKMIA6usXaMBYwPs9xEUoAnUhcav6L1BytzA8qzF/Q5UQmTGi5rUfwiglk4y/FkSPHqXidII7idXruvpXtvrsEDUHDbyQg8D6q0q80QKwMlRpyRTaJKa50W5b/q0Ix+wb4g9vIlE1pL4CVMhe2RJgALrcZoAL8kwbZd77fQFE2ALejU8M2yiHmr5HkI4RYAoudiXhnrT9vq9sGwnqt0zpMD10iYdWSVNPc+hXFe6YX8tNq/RYkwjxct2pt0qeBqwOYK00VYk4M1js3c+3CjJVypIRl0oj+nYJlLXG+56HhdoxLQs9jW8JewY9+oX5F9Z5Fp8hu+5W4lGrSq7tZ4pAf+HeQhXvlwhF1OMD3O83f+wa+zSeRVVIDQ5z/edUYBI6/+Y2NvxXVGNVH6xwCEk+49nOuzDU76wwjED6NJo4QXkzLAexCUPYmL+ckCZpvgeVigFiydBRU5G5DCUjSRjHJ9IB+hHyzWVFS2jpvP1inbR5IqYG1+qlEDVMfI4fN0CcrhWUjQvu3e9VUDTAhvd8ARynWSi/TWup1UhxQOMi1C93S3xjSTRDAO9KY0TvhEXnHucgLHjTHdUHMEhB5lm4pNltSWFlnmkSNsOPRhmezmSMgE8ge+3Vd5AJkeWOYn/ILl2HqQoltc9kC5eTe53HHz9Fy1OtT+OJvvnxB4r9vacKY1HS+QK6NSl2OJS75HJ5ahtWRZUwFJJkdpw+mnzv2yXLF7jXHy1VfsRf3TEDLGZU89eoodE6sNxMtnK93CxTvsHfz37Xx039vQmiRQww7htNuGB/y31yLUw9sz70mO+rwGryWKJsmKJR2cNRfeDn6ZH6YAYPOoCkNhA08mOETLx9VeOUhwEDConW5qvnIa9AZbdVS73IJk25kbgZoLXpYc5QTUb6ADHgkPwphgUJNPHYz6RsE9YvzliyXwMpzmTBpIPLg5Yll1TlNXyhSYeOKvJecLZ6HMeAVtZ6zm9uAUyHEyrtdrDAX6pi7VBmuwG/3cS4Q2IPsBowzCNDyoQSABilLpPTMh/ePxIqsKB3Y6KhGPWwbYT6ZV/6SZqSUIXzbA4DgPD8MM4rKtrnB5EFUgj+FhkECJbdOT5YjVsu+ToJsdsVzisY19CuGkz27BxcbfC/ruwL4SZJpn3PtrSa7TlB2hR6PiAGHqTA+rNFMZcof0PlpoRB0ZPNPew3ofg9UAvS7YZ0ororXGXopgxFqMreiyg4diTtl7iHPbTiiP/mKi26vbecEYPQ7xj86DmL9SOxAts49OPmyYX2778tR0Ie2fR37mH3CRmZNh3YrQJvadgxNSofQk0goa5kcX6GcMZljh3CMCptZPPEAKxdEnx89YISfmd1LP7kuswC8Ubp3Qck5KZbEMQ6VQzPPpSq42KQ9PmkNJlNYc0QQRC6ttOgWVemfVREDIB35dx4pvpnjKdq3+McB0aU8URedksIKUCxR9ktZ1Mk9N4VEaZxC5hNWUfj97pFuQALnWAo5lhOG6iraHKOml4pQRjE76cIXXYlVLIfZEEnXdAGvwJbKWNh60Hl183jIa4EEgM6ZGpvD357MKIgCciyRvc0fN3g4z1CaXUJSRDBzF1aY3Ec3b3qSM2kOUYG8OP2jYlFI3gDjA+CMsvDypmGKYzyffTqEvg+lt2BQf5uXVOYF4gnR35+JRkmkFg1dDVXXOLNhwrqiNFqOuYNh0cOJPaX3a0XxuTlh/5faB2v6MVkcoPSamZU0B2zp4s2xMtuNIIghz3N1zB5HjqqOE4SBcKwIPltQGLjqddBiE5onzocRLPi3+rBrkeffj43LZqJJYHpK7ioaCAuB5624pWQxE5NgUT7c7DAQAv4qSOLYiLw1CV1oeNzcAmjgxpqCFWjkpX+nfDAIwa57UHK5XqqvtRyo6dzddhqVG+JNtQKgeJEIli7s9lM7O+g1Dp3IKV43i8NMIm5YR2VkcWuPef2BXqBJEnBbeobrU72B5DJPdtFRDp1DSwtK2bcePKhq1I0bMspBmoLrrLFkZj9Sv/0yb8+3Z62+VbjfjfI3F7KT6zMKOacK/2hMZCpbavoU4RYs5i53nADeYXUhi0HrpAuOl6Ua6M0Ae4ice+BeyQmopSVGlLjiifPhBeJronBgFNd71iT0wmEuW39zNsBpAedppiGwVnAXEfShH+LqvMNXUJmSO4xTx9d17v7sARN61TGIJ+REAAIxEIBMIsQHXbtt1FBcGESOC/rNcUXajbgG7JwPxeWbU9q54MaBrpBalky6LMwgNRtBd2bvAGN5ZqRSuENQZnA8PiLVNhYIbeXuGYkkChNZyMHpdabmSOv8BGlx+LY0uzDV0277Jut6HfHsRoUtg6lscW5xCPmqJWDjjAU4VkCS3gH0LbIPyZb08LCaf0ext1hyCMxN3s6P7TvMThcTJN4nRk5cZTLImH1OQMnPNRE2kV9i6UcUm5xE0HutrT7NaX4sswDI/vzIqQyaTSo+qws/fdoweJh1wMmnhD5FKfU1e7NF0Y1lPykchEqfN8QOKNrs/kzMrX3G+G/CBvqfME4X0PN/831uEU2lOcEvG8Q8Onlp7CbwvfzjK4oxNBnzgnVwD3cNDyzAupRcP8CcZlfHsabQS+XkHpqhNOhNUJ/l7hzFFHySA2z5tsqcxtb6f9PMWuZh94CpiMzHczzWocSUSv47D/KuhQBv3JMzTB5tBvtZThH+efRr8eFUei7L3aBXkyjdFPAGajTHmtsq1Z9q5bSb2qF4AxmV/u+Q3gXeY+HAyTstghAieZth7ouJ0ugqZY7SRNxBi0LJimC8LSOeRtyoqkpEGhPJ/Rv+Gv6n2VRRMoplvHSRs7/CUFetKMiyNtBEeFn+o8guzR7Oz8bP6FjdejQwO+ZBmHx8YSLHLPi+sG3v05c1G0oRFifK29haqebra31Px9j6JvLt0N6yGAI08KoXWnbv64txGAewXZ/gxstvPqoXprK88IaeoyVqYlY/MsG17m273x0EiMGgr3O8+PMTqLNiuWLit0m9T04YPYTzQSS7CfeFSP3RYBqNhKfTD7UPfIaEogSogPdJsVqvjDAqP9QAlr/RCrA5e1b6X3mIqVsk0UU9ZGKcHvf2E8AQz3/FzlQMwDmES3OUxCmJ97i272PuVKT0654BABe8oARRmo7ccoPKnoP2D8UnnMbuzd92PmaT/FEZlYAjBPIQu0Wqk+7rQVGMfIq4N9vjzGTvStMkVlH3YSPEPbVYVfBb8hiDJu8iIVhVGFajA6VAWqX8CW5al5hQ2IPGyXHbF+4stEDIQxEmjbA1rCezmUQRqm6wegPZ929gAIYBqcQODH5TuixsP4dCzcOMfKctmoou/1XonnbuQUZaaea0euI3lyqXkaCepgxf0Boc0BLW3MAlNw/FuF8eTNJgls240HcmnJyyhXpED3FEFXMxp4DPeyTz85re4PhzSkX6L3JV3PwkFOH3Ni6slfhfUaPvPazO/mOTLCD6jzLaX9CMQ39M8gSie0tN2aJZ9UXV5IV6PeGvrsuqSjwpJ6dp7tXf4m6RhInC/3c6norE1uhZCMFhoNopwmfOSLkEjrMocBwyPuDU5yK1sGLgFiNEegWW/6JtzC+0mz3xKqFgZFTgS0SKkoL03zDpvezc6RD2kw7S9zMkO3sCl7aX1vAxSj+sIVtYHDUxwIv0ks28YyShLGA77HBCAxhmK5tnorK1Mik5gSmdxUdeO72JzSq37qJfixrKp0oEiz2gyFwQaT6dZXvJbSiZxXNrIj4PqOq59MgUtRAaXEUfp6VTK2XlqDsaxKFZSqrqJCrjWpJF+zOG7IGlOyb6Bl34g5hPwKFqwDnq3L5UTrEV79Rfvkznug+GhH2vDMVNur9p2RGVl9vXt12FR29aiKrrcMMNch3rpXlDWYBgk0/ADOBS/RDYlMK3AyfG+CMDn09EJqSn/7NHFvD86AhMOtMNjIHGoIzh0CfJ8ejSZ0pOGy6AJknLIsONwHzYhvym15b+cPVscamdSsbmtLlaJSAYth8WasHMVvACvmZHlhsG8C43hg6Z6GKwNTccS2k+eIcy/yj4v08azFqf1PV32Nko7XfR/UWIUmN6nsPzFLzVrl2e3WAatNzr2rxvqUjSSFpC9r04KAg7Cif9qjXh9TK+kvD5kMN0N1fw8jhzZLlc2qGUQVWl9kRNW9j1E3wn5/qjsSps+2feizTR7bCTGnKwIhu2BUpjcWrf432kQdz48+SGppXdMLoKtBY0JRB/E7Jm5hNIMkAWQLb8YMTgmxEsDr00uWQQkIxj0acGRYAj8eeiUpyqAtFuPiGftiyX0VN7JxZoIYEQRdGCd2qw0Q1USh5iqUFPvxiUSCGtAXlTTb3ZxpozHLevCfbvoS08o1jLILYrFsr1f2ZaK+PMEzJ/MDMk/M79RpmEnyEJlTllBI0nlugI9FuHbqfQYaLajdON2zdZw5ziCDVinWl4XKfI4JZw2bkKcTCqnEsFjw2OsLoOyxlIo/cilSc1mJVjHmtmZmsHSblwZQZpKdGiE6GzABMUkPCmlOasjbmm4fWN6A7pAvOKKG+JOK6Td5/F8hTHwkEa976axQ3d5nUKZERuBRVtBEp9KnztRkaVutZPe8o3z3KIi1Sk5khAYEWTJnegBMgV39acOqEZhsZVGMp3ArWYb5LpK0nF6FKelfZYf5PgPJ94qwL164+PClBiyipUpH+Cfedg3+WA6pwx8AABAR8BcENAFaK1PXOVcY15sm+IJIoTs+LTpEpOqZVF+9cEWqV6wRCnAGLSeMd8vk0O6GEe+8qAjNdsWoZxk5gSXGrNCW3VUu+M6Qf1leAEN+I6WIOiQk3uZbkJolDyJyq81Kjf0lnusjeekGBkGeyh2gjAcKxOxPq6eOQJ1HkJjXVgKxhOOdLDYW9v+YYNu+cRy8bJCIG3xx/EWaAFZc0TatVUTUzdk70XLv3Mboqr6DUpGFl/VBTCWIjOWo1hXG/jnRzKT6lCZKzbnDs3MgX7LBs5TjIzR8J9SVdLN8rM5ju9FKVAWazlQks3lAy9aKdy39HsHJ0MT/7JrUeSVdqULy/MGuWMerIqhBS/ReVAgzujRG+opsO9NxHCv0QqN6ipkwkAaGz7SQ2AAYIyZktcRlm2zU8VjGGx5rmgqtJ9879EhA4Hsu9brwnw63t8qRxQmafOa6S3Yatso92SmPAarj3K+UGE8HwfGSoWsmwcV6El4XeoJseQG7gAAgAJ3hyUgITmLH8RiOm2F+FX8Q0ZVACe57uE0Ymzv5thIxe3CCRH5KLMxHq5WdMePZCwAz/TA2+YEosgHm5Jeo6sljJX2125hdMa23d56gRrtz1Ufpmyqr/PzVXtNy1nrIOgYyCK1BDIeem+ibAS8RptobgwnHYQ5p4a9FHiPMfaqpTi/bogkSju4X+g+xaRIUR0vvCeWATapRQMnYMtQwbescxVLgqJXejU8zKRz6XPN6pvHLer3MCZkuVepQhAVVIYmqOYLSTu5d9zF7qWBbMbEkBgRrpIRQARGAEKkpgIo+OGGzgPiFbD/ZY7CLVn6ZgdXWxy1qSK0YTZ8uNLyYWUsttxJBM7eTFuzVN8cxEwBvXJkish0sKR0LIi0Fpp1mte0cSIz910QlodivusgkKDcxnzIU3MXbxM0WNWlSK+3UvAvzzAvn1GZlmYqYY5fNo8OlNvbkyvYC7KDlsTV5JqWpo6eyovyWHsibPRDjBdTxYdMh+Kaxy8O1zmnG5hvWDFKiBwI5fNIGzD3x7C28kvADERjE2C5gf2xiv1CiesZj9mo7CTEUv4t+KEBBPviBhgIJa3nI8yo0NsSgWChRAKJ4doPojhW3S4oiRR0MeSqPyTHB77ImX47f823vG8Wahh2erH6MeXZX+iinnoYLjH9RD7O1NBObpgMHdmtn6SFfeoD7ISxnTCqlq7Dm7/7nP5EtcqFsqr9LN3g4H7AhVtLCxk2XziF5pPhQAjPYkFKOMkBFOts1kHpxNDVf7KPmEhHpGcDRcgEqVJQU+Shsl7krqL2KehPsS8QbZUOI4kmkFHqHxuWQPh4hR02y+UI+jj3BoorqVGLRp41yS5Uxx65HmIIGMdZN8pDn+ROZO082kjrzo8mBEOmUaPAUAJH8pPgCugzIz5Ff7Or+PB2ZTTi2RJIaltRCf/5mFrBpof4FwCji63PJrmfwyn3ZaJz2A4AoCCvNmRUD/4bK4O/sQL5Gysf3ucoO1tA4F6P0h72keWAnjg4mWaWC/qHuKT54Yb+VVLnA9nu2M2GyBE+WJ/BvvzpVsuGa977c0qo9X0ITYV8F3xWb8Y/HoM72TMhfL3rlIDe2j/eN5pahPM//vMfcRfbdtUrrV4ARmHlY04sbXzxAh4TEQgUgSzyxClDKXWJKFfdyxKYK1BfJ69CElVlOSMdPpcXatEP+zHui9rEB6mkLoTJH0FXTvkOY4mi3wPk9EKIdB/C/qCpZUFEiHFRheKlAi+r9FMR7fCu95GAw21brMuiffl+binHCbbGgQ3phShFx6iwiQD8NyIMOwJeYO/ZP22ANBRDyhYaz455u9A1PXo9X/Tc5C8r3fBKznKnjzP2XTq4JJqzdfI676PhdpHAuBinOyznjnFZIeNd7Wjxo6uEQHa4Vtu9x6vMccVZaIMI9TOy2398H35W3kgYx8x99DvqzjVqrzq7MDYgqc6wwm48UOetBcKpA671POD0mwUbQ2FEKr1LMJzRvZ3nXAWmO0Hm640SUcVtjF+XAMm3TOmiH5zaN2SkAezbuCNuT7qxvZDcy/1QcefDSKGuofYz3ZtJQJokMxrq2gipUHYGQ8eCCJVJCICGSlIGGCWUqxQDNo75b6WrpyWxjap6mPmrFTxJzQOZy5A57ogdyiSbneAW26nsDV0p+egk+vNBZ7ukevMvPjOLGsriFOyNYocafSumnzBSmdTuiFcoOfIZJXm8Tgc6//pY3Hd2RxPA3I/HQP5N3O0+nvc3tQ3iQVpjCVZkAjm9KsRSnLzUY0Vap1rHaozHDneEx5XHuYoWGfO0UkfGR3KTMw4CtCKcyzBTyF5GmkgYzbFkSi8NnjjXjAtOzTnP6bYoSk5hks7DIkND2cOI3MoorDRX0Bzgb9Z5cEOr1FhzSbyM82OZV+KTKCf/+Ll25/d4+9IYRmg1YHe6/ux+xyn1wEC6y3EGGu6/w3ecpw/Vrf0MZH30oj+jGE0mXT8AzwRb2iaUHhPXtgyHbQ2zHWZzRBYS1o3OWn9YIwwbVd12dZLqZdSxS6aUDcARithMFReoaVB9kxizAAAs/9PgqCUzUra+JCKCqgOe/2RdIVGschEFPU0oslCTzyDNmOLv0tdfGtBB8cfezJA1fI9DSAY6/7F9O9q5e3SXRg/aBRjx8f3HGxW1ogVjub3TTUCAiUb1Qc4u7nZ2l7Aub/fN0Fc65nSDPlXZO975EMzQGUhaoSHUpKRR6+8vk9CE3EKSUMzWrwDo4CXBol5HtPlBGApcFjGYKUvDSBIo+KWxiYlYVMtbN8vjlLfH+azSlotL89tVZdnas7IfbbAVUNXy2lV+V/6JRl0qZlYIs+5qG7TOPp6rw1Ut+ODJm/Ywy3P7Czo6fuuSQDNtyHlK9eGPsCy08E3s8VRrd5yFbQhAShCWLBpayMyEEChEwx3FuwehmAMxeQBRaC4OC68Rx3l4WHl5vo6lEq3zGynVv5EC+1+k5ECs1MhuKEHNLKQbcxnJhXdyXOQvZ14yPTv/JYmTMdy9CHjyAXcsa8jKfcQ1F3xNqnce99c8HrHAp4lH62xN28bHKSCaGk/JTkU5Kn8+3LwLiVO85m0d8ED6YvN2fr+YB8VL08RGjAXV3NfmwvRD31TGY1MjHo188JMIwtw47kVVDLZjQNL1O0FL7HwCzrAL6FDiFYae1CsIiQNiFsUWx+W62S87qBeK8uxKAWpMDfphhCQ5wBioxpoy5vDUUFiOGrVjsT9Lpx5ed9iVuuhivCE/R6DeeB0rmISK6M07buww/mQlFt47mBigbaYDEszFlgR+j9FeIrF/V8j53Ly1yrPm7bw6d6Wc4IuMCkJS2EXVVDh72H2FpV/juHo0Qjy7cZRsoFGu/Rgs5dCVPa6guhUDI0vcmEf442oLZZdIs//H+F4Kik0YnykbfDnyH89hOBd1aCnpByXJSOG9+Ka9fShEaiKY2JhVBYgHBGPtK3fLDT7XY53vZMjLC3UXpgzbsjuHGuqllg4PMKIw34fAxKPa5+hZ8MtjNdkeZ9C0a2H7Eh3yBqGnCmgrwbBg+OxTDUSEfCqCvz88JJtR+lTjSmfFG1gx48o5BdBI1D0LoR62iy3QENGsyzSg7QXw6oujltLYeXX9vH6Dnzcvy+3M8Zl33rqsQDEiQ8uelYjNX90moTH7KJj8R5CApnQwjOVk0m0HhHfQGOYlLZPsU059bejckW5hKdM9MSKCl2xFPZAH7AabxMjogiSeoz7B6oKCVJGKJCUXp9f66YAdNReNkrcIf+fU9/OL2IKiwhehoMC/Ft1vRppRctMU0rdLDscURI5ujVlxd+rnXFa7PHRN+1xcD1+OaIMMVMgEnxcyXn2lp1S6+jGpW4n2YweTMDiwfGLgsYyWQBazSBgAAO10Q2Yw3z0733c71zaEcu0ACKVZNs3NTJYNBRRnXexg2e8WoGmKpGiconlZtq4wix3eT/UcgyGnheNzqvSub/L7wImEWKiorbHD/o3hpa8mqRX6GSXqJCj1lILcuF21GJUIoh74zO4SobJ4cJJSzdvoiKF9C6OwDGq8J/PMMeIQZg/05945UxQDTFTcsxnPL75fPz8=
*/