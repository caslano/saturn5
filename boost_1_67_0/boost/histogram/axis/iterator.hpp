// Copyright 2015-2017 Hans Dembinski
//
// Distributed under the Boost Software License, Version 1.0.
// (See accompanying file LICENSE_1_0.txt
// or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_HISTOGRAM_AXIS_ITERATOR_HPP
#define BOOST_HISTOGRAM_AXIS_ITERATOR_HPP

#include <boost/histogram/axis/interval_view.hpp>
#include <boost/histogram/detail/iterator_adaptor.hpp>
#include <iterator>

namespace boost {
namespace histogram {
namespace axis {

template <class Axis>
class iterator : public detail::iterator_adaptor<iterator<Axis>, index_type,
                                                 decltype(std::declval<Axis>().bin(0))> {
public:
  /// Make iterator from axis and index.
  iterator(const Axis& axis, index_type idx)
      : iterator::iterator_adaptor_(idx), axis_(axis) {}

  /// Return current bin object.
  decltype(auto) operator*() const { return axis_.bin(this->base()); }

private:
  const Axis& axis_;
};

/// Uses CRTP to inject iterator logic into Derived.
template <class Derived>
class iterator_mixin {
public:
  using const_iterator = iterator<Derived>;
  using const_reverse_iterator = std::reverse_iterator<const_iterator>;

  /// Bin iterator to beginning of the axis (read-only).
  const_iterator begin() const noexcept {
    return const_iterator(*static_cast<const Derived*>(this), 0);
  }

  /// Bin iterator to the end of the axis (read-only).
  const_iterator end() const noexcept {
    return const_iterator(*static_cast<const Derived*>(this),
                          static_cast<const Derived*>(this)->size());
  }

  /// Reverse bin iterator to the last entry of the axis (read-only).
  const_reverse_iterator rbegin() const noexcept {
    return std::make_reverse_iterator(end());
  }

  /// Reverse bin iterator to the end (read-only).
  const_reverse_iterator rend() const noexcept {
    return std::make_reverse_iterator(begin());
  }
};

} // namespace axis
} // namespace histogram
} // namespace boost

#endif

/* iterator.hpp
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
*/