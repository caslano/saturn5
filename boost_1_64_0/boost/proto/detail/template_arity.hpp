///////////////////////////////////////////////////////////////////////////////
/// \file template_arity.hpp
/// Replace all nodes stored by reference by nodes stored by value.
//
//  Copyright 2011 Eric Niebler. Distributed under the Boost
//  Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
//  This file is based on a similar one in MPL from Aleksey Gurtovoy.

#ifndef BOOST_PROTO_DETAIL_TEMPLATE_ARITY_HPP_EAN_2011_05_07
#define BOOST_PROTO_DETAIL_TEMPLATE_ARITY_HPP_EAN_2011_05_07

// Somewhat indirect definition of BOOST_PROTO_TEMPLATE_ARITY_PARAM is
// to overcome a shortcoming of the Wave tool used to generate the
// pre-preprocessed headers.
#define BOOST_PROTO_TEMPLATE_ARITY_PARAM BOOST_PROTO_TEMPLATE_ARITY_PARAM2
#define BOOST_PROTO_TEMPLATE_ARITY_PARAM2(param)

#if defined(BOOST_PROTO_EXTENDED_TEMPLATE_PARAMETERS_MATCHING) ||                                   \
  (defined(__WAVE__) && defined(BOOST_PROTO_CREATE_PREPROCESSED_FILES))

#include <boost/preprocessor/cat.hpp>
#include <boost/preprocessor/inc.hpp>
#include <boost/preprocessor/iteration/iterate.hpp>
#include <boost/preprocessor/repetition/enum_params.hpp>
#include <boost/mpl/int.hpp>
#include <boost/proto/proto_fwd.hpp>

#undef BOOST_PROTO_TEMPLATE_ARITY_PARAM2
#define BOOST_PROTO_TEMPLATE_ARITY_PARAM2(param) , param

namespace boost { namespace proto { namespace detail
{
    sized_type<1>::type template_arity_helper(...);

    // Other overloads generated by the preprocessor
    #include <boost/proto/detail/template_arity_helper.hpp>

    template<typename F, int N, int Size>
    struct template_arity_impl2
      : mpl::int_<Size - 1>
    {};

    template<typename F, int N = BOOST_PROTO_MAX_ARITY>
    struct template_arity
      : template_arity_impl2<
            F
          , N
          , sizeof(detail::template_arity_helper((F **)0, (mpl::int_<N> *)0))
        >
    {};

    template<typename F, int N>
    struct template_arity_impl2<F, N, 1>
      : template_arity<F, N-1>
    {};

    template<typename F>
    struct template_arity_impl2<F, 0, 1>
      : mpl::int_<-1>
    {};

}}}

#endif // BOOST_PROTO_EXTENDED_TEMPLATE_PARAMETERS_MATCHING
#endif // BOOST_PROTO_DETAIL_TEMPLATE_ARITY_HPP_EAN_2011_05_07

/* template_arity.hpp
LPV/Q/+eDLNyrKwSPz2Yp7O9GtsWBXjyNsx2OQFOGJV2WU8TYpWn6Souhrr8XnSIhSvYkFk1BMhLEMnPheJgZXRALLHzQba6SmewfOcvxOJ9PxXlXE0NtNJROpsJ8vVmfJyiXsCEwQ75UsZ1+q15fzz6yrf43CvElcrqqLakci7epvGxwv066w18HH5bSuI5igbrm+S5dH4pFy9+wUsKjoAy36cYNznDXHItq9/PNDn6vuBnu1Zty/Xhup02HlPFj2cpmeRrtMF3hGz+5LFEHs8QmPmMl0GzAd5b+hk46oZ1MdSAtmM12IX0QgqX6njPJeoRN/1YPwf3MVQwcw9debCsR3GK43tfQp7kQNxTaP7aL5n5xMsmpzjskhU29bKjHHbRCpuU/g+M9kvh+TW6zte6IYcpr5SVKj8eRqoM7PPGKOtsoRg/CRkfg9PygTZPa/Rtqdhx8HPWpfC6yDvcmyKVNIX/fq8V3qm9oyr0Jut2fJg3xRrytBMu+rl1T/qPdlotuDOja4Lv6Po5JRY59qNgc3RgSwJFPu+FWBIqynzLYsmOn8fMqBkuFT0k4xMeRu5Fr1jhqFjAfsO6IpshZyzAKfWqzPOp7SZLZzN8pmaXCecOSLDKNltWW+K9M96Ob/Je2+Bmj4gun2fbVosRPo7yT6GxbTGyfqJxI2xKpsF7T4uRwwqWVby+kfZdrjtvLtcHbI53eOoOBzH7bQZ8k2ubg4tChu2CnG0tBGN7rqd0Do7aTPz0sj4/ke2J9w47sRHESlWPzTGHgQcssKuB9YEqGZ+RuvJoZEywzxQhz3fXkfTEJPPuPot/OR+IFdl39LjN4DaCN+XCpvGPrjyYjWCb0l/O6Xb6vZ+NWE84ZofjKAfFudRNHR5xOBjJXb4L4qbDhz9wx5H9OrhyoLa4/h915ICbjVJd6pv+4TLU25m57zLUjg22F3QZqELpta/K+3g33/n08SzZW5U4/3Z9vgy6IvRJ3X73vAwO7Q7mscrfgAFs7Zw+Kz0t9X54T5ZUHhulsr6/8hGSJ7heo1WCdenLVS2i+lLX0QcG8QiX2HYizILNeae0Wu3Idrzi8FguyDAxFbdceGajwni+duWADFhod5ShAHMVDwedFGB5n+OMm6Zjr3vZlUUdrNjB+bnD9/o9LC5v9fhveZh8Yi51LHEc8hjf0WL72SHsSmnN4DcH85O0+SO+Hua9Z44XhvHY8sxfGsbDy0rTwlfrUH5aaWU0/5kwL+d85te3wov1yFfDPOstWXe6N+DnR9/cLWZTr9eyh/Pa1mtXkKVTZW2/sm0wm1g+FbE+abBc7csumFfhuUX0kzthXno9YD3itdEwLz0fgK7vlbQWCqfBEcDCWD2hCusw+LCscD8b3UJcZTdM/OUwr2/3K57bIJw3qqs26RCiAewJZ8Wh75o+GBscTyFpbo99A9mXk08RfithZDAPNtXUDjfDdZNNFfKziVyqOJtSHpTy4IIhO5sS7XBhdzBualZ3qwLx3UE8tZzoV/WB/AnZdq9jHVAwjvDSIPrG2EBetzflaWQgLwoh8nQ33B7sFQJ8MPE+cRDfx9nu5LEhFlQJ1DOEz6lgX4pmWae8y+vDTE5t3I9ndnhZObUx+yo/K6e2EvufGR3ERgnWrwZlyqlKr6vmg7xsO81fCuZDdD/RdpmQfOpK4q7JwzE/6586olm2/R8cT9sMDORezv4HbnjLGJ4C5FnX5m5/XDkF8D2nMCuHf5HvOg7iTxj1v8xnbyP+OHL48/7Mz8phpm2SHuthaZiJfUVup5+Tvs6mrT6C3R8aWdMsz2jDYyeSc1N4C7Cm18sZH0O3CoWd8ozJpUiQtPd8lcUIQczMWww=
*/