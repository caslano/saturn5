
//          Copyright Oliver Kowalke 2013.
// Distributed under the Boost Software License, Version 1.0.
//    (See accompanying file LICENSE_1_0.txt or copy at
//          http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_FIBERS_BARRIER_H
#define BOOST_FIBERS_BARRIER_H

#include <cstddef>

#include <boost/config.hpp>

#include <boost/fiber/condition_variable.hpp>
#include <boost/fiber/detail/config.hpp>
#include <boost/fiber/mutex.hpp>

#ifdef BOOST_HAS_ABI_HEADERS
#  include BOOST_ABI_PREFIX
#endif

namespace boost {
namespace fibers {

class BOOST_FIBERS_DECL barrier {
private:
    std::size_t         initial_;
    std::size_t         current_;
    std::size_t         cycle_{ 0 };
    mutex               mtx_{};
    condition_variable  cond_{};

public:
    explicit barrier( std::size_t);

    barrier( barrier const&) = delete;
    barrier & operator=( barrier const&) = delete;

    bool wait();
};

}}

#ifdef BOOST_HAS_ABI_HEADERS
#  include BOOST_ABI_SUFFIX
#endif

#endif // BOOST_FIBERS_BARRIER_H

/* barrier.hpp
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
*/