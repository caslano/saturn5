#ifndef BOOST_SMART_PTR_DETAIL_SPINLOCK_POOL_HPP_INCLUDED
#define BOOST_SMART_PTR_DETAIL_SPINLOCK_POOL_HPP_INCLUDED

// MS compatible compilers support #pragma once

#if defined(_MSC_VER) && (_MSC_VER >= 1020)
# pragma once
#endif

//
//  boost/detail/spinlock_pool.hpp
//
//  Copyright (c) 2008 Peter Dimov
//
//  Distributed under the Boost Software License, Version 1.0.
//  See accompanying file LICENSE_1_0.txt or copy at
//  http://www.boost.org/LICENSE_1_0.txt)
//
//  spinlock_pool<0> is reserved for atomic<>, when/if it arrives
//  spinlock_pool<1> is reserved for shared_ptr reference counts
//  spinlock_pool<2> is reserved for shared_ptr atomic access
//

#include <boost/config.hpp>
#include <boost/smart_ptr/detail/spinlock.hpp>
#include <cstddef>

namespace boost
{

namespace detail
{

template< int M > class spinlock_pool
{
private:

    static spinlock pool_[ 41 ];

public:

    static spinlock & spinlock_for( void const * pv )
    {
#if defined(__VMS) && __INITIAL_POINTER_SIZE == 64  
        std::size_t i = reinterpret_cast< unsigned long long >( pv ) % 41;
#else  
        std::size_t i = reinterpret_cast< std::size_t >( pv ) % 41;
#endif  
        return pool_[ i ];
    }

    class scoped_lock
    {
    private:

        spinlock & sp_;

        scoped_lock( scoped_lock const & );
        scoped_lock & operator=( scoped_lock const & );

    public:

        explicit scoped_lock( void const * pv ): sp_( spinlock_for( pv ) )
        {
            sp_.lock();
        }

        ~scoped_lock()
        {
            sp_.unlock();
        }
    };
};

template< int M > spinlock spinlock_pool< M >::pool_[ 41 ] =
{
    BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, 
    BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, 
    BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, 
    BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, 
    BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, 
    BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, 
    BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, 
    BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, BOOST_DETAIL_SPINLOCK_INIT, 
    BOOST_DETAIL_SPINLOCK_INIT
};

} // namespace detail
} // namespace boost

#endif // #ifndef BOOST_SMART_PTR_DETAIL_SPINLOCK_POOL_HPP_INCLUDED

/* spinlock_pool.hpp
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
*/