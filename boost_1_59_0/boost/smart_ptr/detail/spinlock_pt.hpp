#ifndef BOOST_SMART_PTR_DETAIL_SPINLOCK_PT_HPP_INCLUDED
#define BOOST_SMART_PTR_DETAIL_SPINLOCK_PT_HPP_INCLUDED

// MS compatible compilers support #pragma once

#if defined(_MSC_VER) && (_MSC_VER >= 1020)
# pragma once
#endif

//
//  Copyright (c) 2008 Peter Dimov
//
//  Distributed under the Boost Software License, Version 1.0.
//  See accompanying file LICENSE_1_0.txt or copy at
//  http://www.boost.org/LICENSE_1_0.txt)
//

#include <pthread.h>

#if defined(BOOST_SP_REPORT_IMPLEMENTATION)

#include <boost/config/pragma_message.hpp>
BOOST_PRAGMA_MESSAGE("Using pthread_mutex spinlock emulation")

#endif

namespace boost
{

namespace detail
{

class spinlock
{
public:

    pthread_mutex_t v_;

public:

    bool try_lock()
    {
        return pthread_mutex_trylock( &v_ ) == 0;
    }

    void lock()
    {
        pthread_mutex_lock( &v_ );
    }

    void unlock()
    {
        pthread_mutex_unlock( &v_ );
    }

public:

    class scoped_lock
    {
    private:

        spinlock & sp_;

        scoped_lock( scoped_lock const & );
        scoped_lock & operator=( scoped_lock const & );

    public:

        explicit scoped_lock( spinlock & sp ): sp_( sp )
        {
            sp.lock();
        }

        ~scoped_lock()
        {
            sp_.unlock();
        }
    };
};

} // namespace detail
} // namespace boost

#define BOOST_DETAIL_SPINLOCK_INIT { PTHREAD_MUTEX_INITIALIZER }

#endif // #ifndef BOOST_SMART_PTR_DETAIL_SPINLOCK_PT_HPP_INCLUDED

/* spinlock_pt.hpp
Mc5Av9tGf3MkIu92M76VxJpsJbKL2x3twfZaexAi/W4nnacO8v/dc5u18b4YhL2EPA2iYUX4p5bcFsTCEO4jSsvK5+HrAWG3gcfWxLniJjFI6o1WXSltkPZLmmzLU+UF8m9yXkVViikHlVOIGuFKUrWcel1Np7XWdkFDTS+nt9b7wj5m6XGMAoaEuFgSPuk6WvEN2rCw2crsZs4zl5gP0VbpraJWVaux1RbWssTaCC94wrpu3bEeWwR4tpAt2rXsRnYre4BzwnngkHMxmGslZbkgoLFMclY5J+y8oMwDyenQrqhcUi4LPlNFriHXkRvITeQWchvYQRe5u9xb7i8PlofLo2EVk4GnZmFcLJKXAHmskTfIW+Tt8m55v3xYPi6fls/Ll+Rr8i35nhwqP5FfyOHyG/mD/EWOocRREihJlBRKaiWdkknJquTEiCqo8PDGumIDv5RUyiqBShWlBsZ7A6WJ0kJpg9E2FaP+tPJUuabG1epqg7TlYA/59MK6oVdCfzbSJ4FD3NOTAHsuQV++M2Kbac0yZmqrtPWLdc3aaIfYuRBhpjo3nfdOKo/sqeHp5ZnnYoIYZDk+NvIf+DhCSqEQsGQjIPFWYjuxk9gN3rKvOFAcivExVtwq7ZIOSO+lr0BbszEiKihNlc7Q7ZryRCmndlBnqEtUURuojdBmaHO1u9oL9GVC9OMC/Tg0y27YGA13MQrSmRXMQeYC84CZ16poTbT2Wq9gb5Xt7vYYe5F9Gp5KcTo6B53U4HSdPEM8OzxPgAe8fjUmlx7opSY3jLvFNeCP8ZWEAcIYYbawWFgnJBPjSRWlEdIJcJ6qck/5s2wqQcoY5YvSUm2vdlV7qevUHepJIK9HaoS6S8ui19eX6Kv0I2BD+WBh9Y0uxh0jBJhhADjoZPNXc5m5zvxgxrRSWWmtAGuldcgaZs9AnErkpHKKOPWdfmA22zEKqTMKOPGA55bXr5KYLkYfzU3kjnGUa8T3h/eZw/sJNYRZwl3hlZBa7C9OEW8ilvGSIV2TnkuyXEquAHsbA5vyKCWUSkpz9HsQ/E2okknNripqEGJ1MBhNIHDVLC2BXlvfrj/QJaOh0R5I9jdjp3ESUbsoxnANa7G9107o5AeiquKscNaC5bT0zPDymuQx3XbMyuXleK4Zt53z8A34Znx7vhu46gU+nM+IiBQobEE8jy+mEAuCUwxOE5MMgQyFDIMMh4yAjISMgoyGjIGMhYyDjIdMgEyETIJMhkyB/AKZCpkGmQ6ZAZkJmQWZDZkDmQuZB5kPWQBZCFkE+RWyGPIbZAlkKWQZZDlkBWQlZBVkNWQNZC1kHWQ9ZANkI2QTZDNkC2Qr5HfINsh2yA7ITsguyG7IHsheyD7IfsgByEHIIchhyBHIUcgxyHHICchJyCnIacgZyFnIOch5yAXIRUgw5BLkMuQK5CrkGuQ65AbkJuQW5DbkDuQu5B7kPuQBJAQSCnkIeQR5DHkCeQp5BnkOeQF5CXkFCYOEQyIgryGRkDeQt5B3kPeQD5CPkE+Qz5AvkK8QComRNibpDrY2RVwtPgMmSSflB6OpJI2Xpkux5RJyDaWdEqbUwcg/oBbQBM3UisE+e2gXgEZq6jf0tEYuo5ixyjhlCGYl8Mux4DKR7gyKDfbS1l5nXwAOLorxvtDZ7BxFPDM8FcEAOnuA+QJiunPxhbl5XB3+onBfKA6U8hjRWZDPylfkycpiILgPQCDl1U32A3u254SHcDEJe9lHYow6SbCEKkItobHQShgtLBA2CoeAAh+LX8Ws0hT46tPwDy2VpUAxB5Rzyjo1r3ZQS67n0Lsj8mzWT+ov9QHQfJsRjMiTCLH5tZnOymxJVglrDzhxdsSWonag3cNu4enime3OwaB/8BGf8+MsrhLXCAx4HX8DOPcFH09ILNQUFgqXhbRiObEf6nEP3LCYVFWaBXwXF3EoUG4kt5Y7ykFyH3mQPEIeJ0+RZ8rzEStXyuvlXfJR+ar8QI6jpFIUpZuyXaFKSXjcW2p2rQ2QNgGTb6hPga8N1jOA3dY0ehsTEd8PGo+BWyOMZeCR+8xjQFgfzYxWActj1bJ6WaOtVdZO6wwYZUI7rW3Y5ex6wFUz7F1gEUfceZsd8MME+Oqg5x7rEeBzr/9IxKXhBE7j6iL6j+Umw4+845IAZU3gh8ITX4ePCwBz4hA75gFXXhctqTz6bQii5hVEwgyIdSUQ20YoY5VJSg1gx07qNPWpmkjLpnXWYugKalNfH4f4v0E/BjaXzMhiDDN2GI+M14afmdvkzWZAK5fN19Zh+6Kd16nlXAU7eesU9JhAQ795NsIXQ8nGMd15wBHcVO438LsSfHV+DBjLcv4oMNFF/hp/hw/layB6XAW7jCW+U35VP4BFZtRsxK812jZw16vaK9hEJ30QbOIk7Fk3qhnnjDxAIBvMfVZRu4bdDBy8rz0ELGkh2BzpDB9H2DzcQH4EXw/1XyFuFluDq/4ieeR18ik5ldJYSaM6wMr31J7aFG2edkfLrOfVwzBWjgGLPQF75MCILbMoIngg+F0doMQWZnuzi9nXnAGUGGbGs/Jbla1O1nhE97nWYuu+Ra04dlI7ta2gDzvZS+yVzjMntiejp57LSWK68xcWd4XrxecTqgqNhEnCPOGeECYUFh2xA3jbAozvYNhkQimNpEtlpG7SAmkn2H5ioKOiwD8zMFruyh/lmm7Ef6VEwv4YAs6h1lAXqUfRcyO1tdo97QsiU26MntLmLbONtd7ebG+DNe0D3z1mn7LP2cH2VfumfRd45LH93A6zI+334E/Eie3EdxI7yR0/J62T0Qlwcjh5nAIO50iO7hR1knqKe655yKSYLl9pyO3mTL48P4yfxu9DfWoJwzCy2eySR6wlDhe3iC/Ez2JiqYo0U1qO2PpZyoDxlRsoTwTG45QBylbluPJI+aokVLOqxdQ16h71OEbSE5VoWYGtJqP31wOJXtQitRZ6D32wvl4/Da7yTv+s3wA6eAeW0soaAZS80Aq33loxbH87g53LZjO0U+z1qN1rO4cjO6Wdni5Kn+TMcBY464GibzivnEyeJfBToeDmES5fgQ8nbK7a5CZxEVxKXkbNmvCd+N4YS2/5VEJmQRKKADkMFiKE0mJ8KbfkkapJbaQgaRLw2BlgncbwGfGAFVuib0Yrc5RfwRF/R//kV4uqDdSl6mZgnidqJk3U6mn9tNFgAde10notvTE47jh9tn5Wv6lTPb4RYKhGeaOzMQacIBhYIgSW+M4gYCxpzCwYdQVNFVZZHOithlnXbGK2NPsBha+CZ9llnoZ/vGHeA3tJCtaS13KsDdZHcPorsESO1XM9Yic+cnBFuLZcGtSxNj+K38lf4ucI+4VjQgKxirhLvC2mRv1EqZk0SJoszZFiyBlkTlbBxTrKI+XNQNZn5evyUzmxkhHosy1qOxGcbCVYxE0lCXhoZbWp2kNdob6GD8mnF9Fb6OuAPTsavxgLjbXGceMqWNh7YONrZjjGUG9rLfS7BUuMgBXGdOI5KZ1MsDvB0ZySwE7VnTpOc6eHM8JJCO7DeI93bBfkGnDruUucwVcAp7zAJwaL7yNsEB4LWcSa4nhxN+yvpNRemiF1kftB7ylykNIPbLmKi0IHqpPUOWpKrbrWV1sP79zStKwJ1lZrv3XDymPL9iroRO1MjuGUgA6VnXbOeOeAk8WTw1PYU9RTylMFiHiSZ4FnqecZ0+lcTJIRfCYBl4HryM3k5oPzrYVmrfkFfARfGSjusHBcOC2cFy4J14RbGPOhwhPhhRAuvBE+CF+EGGIcMYGYBEgvtZhVnC0eFe+L74Cj06AfSsBn15MaS53hvYZLY9Aj88DjdkvXJSqVQ4QqolRWaisNga9FMOFAdYF6Qn0P/5lGywIkUBIjabb2q7ZFu6990GLrSfQ0ei49v66jX7rCmy7AqNoBrnxSP6/f1Z/or/S3+ic9rpHMyABLzGcUNhTDAnaoir4rYn4yC1p1rS5WH+uYddf6YmUFPy1v17QbgNl1safaO+1QOyM8RnnnjPPcSeLZ5Yn0kLsx2dQ7GYqR9ZA7yWcSQoSnQhJEpYciFfNIDqJvS/CF21IisL9tcoj8Vk4Cnt9AnanuVPepp9Vr6jM1TI2nJdPSahXQY2n0THqgXg38eTx0r2BMMXYZJwzN7GCmtbK7HmGRtcLaZZ2FR35jSXZZu4rd3FbBnVuyvgqLSdiPlxFw5t+41dxGsOYD3FHuNHeRC+N4viT/is8A9N1NSC+eF7tKS6Xt0l0pnnIe/jaOmljNoNZSW6l91DXaU/2LnsMoYdQzJoJH7TPvg+mZVqDVCC3U1xacOc5l56Wje0Z4Fno+edhemiIotifK28BnBptrK6WRm8v1YJWnXPQ2V00P1j1E36c/NtJYH6wiTm0gsWSeXN750uSx3DiaiksL28oNDzWb38M/5DsKR8BmAoFmWOT4KKpSFylEegl2mFyuJIfJn+QUyjs1sVZZ66mJiNxfEbv3W+9g5R3scfYyRO70jopRNhsY4x1YaWXPMM8mzzHvelZALJdDEZeljIFfLMQXR/xeyT/hSwoNhHHCCiGdmE2sIQ4Sk0kPJVU+iegUQ4mvJFNKK+uVk/Dv4Uo8VQDnO6q+Ua9o79F7GfWCug3rm6DfBkoqZDhGGaO20dLYYFQHLn1oJrCSwStMszLa7eHJr9qvoOEvzgUn1HntxPekwtjrz5AeF8uda+yL8baZu8vF4bPxBfgT/F0+F5hzT3DlzeIxoLsXcoT8VY4FjfyUAPB8HsitGLSrhlGzTzmhZFczaMW11tpO7QriZnw9rb5W/6iXh0a22Rp+1ESM72iNgz4dgMq2wi+8tj/YAU53RJHmLt706pGEq4VRb/IrEC9aCnOFJcI5oS4i+i0xFmy8gTROygf7LiJXA7JcBFbcUsmMiEe0GsA4u7WYGJcFdEevp3fWh2NcTsW4PIaYkMNYZuwzksHzlwRTjzQ/m7zV1UoBhLHIzuYUcgY6vzrFPTU9oz2kciy2LEUiOZGvw4/ld6CPisKO6wkdhM3CSyGbqIqVxOniOTFC9JNUaZh0WCoge+TJ8g6MuS8yr/RSCqlV1DYYcw/VjtpQbaq2WtuvXdYitNbw4ArQbBZzkDnFXG1egCcoDys/at22EttB9mD7pP3UTgHE0BRRdjUwYGb4yNaeUZ6dnn3g44+YH2gcyx13sbnG3GDY0le01UU+BEyXA9OtJTQRZgrLwQ72wi/OgAd8JAZI+aRXUiM5WImtplBLqv3UcepV1QNEoOgN9AP6Bf1XYOpW5g7zjPXCCgbX5p1i0GCAc8QpjdHe3LPD88pDOsciM1Guw7XiZnErEN2TgWnPQvscxuj5zCcEO+kg7BMosHIxsbLYWOwvnhDDYDmq1EQ6KBWWh8qZlfpKf2WcMk2Jr/ZUhwCrnFLfqXG1RtpwrTP66ZM+HewktymZ9RCRp5gnzanWI4vAJ46x38JW2juLnFXOIeeuI3omemYBGTM86BtbPbi9XEJe4Wu4WCqcnwjOz1C7IlYVa4tB4i/iKnG/mE6ypPpSO/CUpPIAubsSAP94GOj1LXx9Yr263kGf5Hrw+IafkcmwjQPGQHOMOQHaTDdnm/PNX82l5jaMrYmw5M+WZg+yJ8KO4zptnGXObYz7PJ6CnhJos1HunHQswl5ql5qrib5aC//YGQyqjtAV3Om4kEGMxGhPJ52Wvkg35Fywm1HAO6uUK0plIJ0O4EIttE6Iq6O0mdoi4NHzWgDGe1wjuZHD2AQu9NRIbpaFbrOB3m+Z2a3qVlNrqLXOCrUC7TkY75F2bCchMKcN7MawWSx3LlVHvB/DleDv8TEEfyG7kEGqKw0Bmm8NdnYCfCa+kltRlabKbxjVl5WHSka1jDpabaANw7g+YjSGt+sGhjDBPgr02wB4cCGQ4Af0x3x3zTQWW8omybn63FNYCM+r/C+wj5N8MqECmOs2oZnYRhwrThVPijkwmptLi6T7YFKFZQeob4o8B+zwg1wMyC9MKa92VzfCTj+qGTUHeHy8tkbPa3SyTiMmGM5Tx50f3+eNBSrXnlvM3eE0vgXGQmVpBfpWlru49ZmuJgQLW6OFat30DOYGRLMX1iR7s+PH1p/PefVtjJ65yX3k4oFPnRYHSe8lSx4s75TTKI2URUpbdbi6Qf2CEcPm2Prrv8KnnNcf6zGM4fAqN4wYwJSpYR2vzWJWEFD0fqufvdb+3c4CrF8OY7iUpxcQ11nPZ8TwWGQbymvFdeIGQuO9XEY+P+y1Az+VX4J4mRr9kReephuQTaTQAGOnNix1ELDxdGmJ9Lu0BxH0g1RKric3AYacgr7KqVhgngeVTWqEmhRYpYBWVFugrdQS6s30gWDQwfpzWEwqI7vRE7jxrZHWLA2028ocYa7B6Ao3UwDd1rMGWGMQ6/db+WzTLmVPsg/a1+1Fzn30a1tovsNDwry+2Y/TuXrA87f57EIQMGKYkBv8f4A4WpwBbzhduiHll+vLveUNYPixleIY5+XV81qIlggeuYI+Q1+ob9FP6BeBjmqAAa839honjWdGR/MqWu6EddGKQKxqbveyEzjpgBR/RyQNd3hPM08/z15E0qsetjOSze8Srih3FWM9HaJ3Q74bvNBicKcj7pyvAfxaB5ywtbAGrRgTLKq52EucKe5Aa6aTRkq3pJlAR0uUrEDYulpPba4OVseos9TV6hb1onoT3ugMOOxbrbrR3KhrNjV7mv0xxn4zd5unTAc4KLbNuTMLTcCRl4IR7rYv2beBuPM5MTyD4ZGuuhgjthtDSgMPhcOukvCZ+TJ8D3Doc3wa+GldaCv8AjQbDAwbKTgYD8uBOkLEcDGGlEIypBrgQ32kTdIbMFZBngC+eg2RN7GiI+J2h4cgqqa2UCeoe9Wvah7w+yDY5Cp9v35Hf6+nMVoZvY2xwHKlzbbgMbfMAKu4XckeACZX2engTHA+OiQgtmv3E7mzXH9+vZAD3vGYGFtSgJDHSVclXv5Vvolo3xl85IbyWKmuLQXLikBUz6Dn1DW9vN5I74bo+itw4z49i8EblYxaRidjpDHfnGtdBPvI6zjOGue0k41FVPRXbBe7puUKc+NQ5h34hhpoj2n8Bv4Un0gIENqhNRKJWaDHeMTW/cBfWaWxwOiz4SEipdxyW3mIfBUorA185CElhyqppdVu6jH4h0dqNW2hlhvcL8CoZjQDir0CptcJtl3a6obRuMqKC6s+YrNV6TNOQY/oGeNhP+rBuE96xLIgLjXfh18GtCEJd4TkQNJshWetdEryk9meqiZo/W3APn5KJkVT2iuz0P734RV5tYQ6VV2lbgf66KVd0CrqYxDd8xmljTZoh2XGZkSOe8CJZRHLWsOCykOXrVZuu7Q92v4VHCjC6eDpDfYz2nPQuw5VObYbX7NxlRArRgLlz0DEeAJ2yfHt+HWwnGrCFmG38FVILA4Ws0mFJQ3cuZt0BKz5q1RHzqjkUEqCly1VaqvN1PXqIbU8YsR9I9y4bD6wYtp10P+hdgzHz0nvFHR0eKb6TiugwdsYY+/ACf09gqekp5VnENjYSs9W+Ks74PUvgDdik9bQKymYbh+uADz6MHjJCLGVFC59lTMpQWDnu4D/biovlPdKIjWNmkc1
*/