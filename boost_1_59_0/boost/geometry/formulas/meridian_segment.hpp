// Boost.Geometry

// Copyright (c) 2017-2018 Oracle and/or its affiliates.

// Contributed and/or modified by Vissarion Fysikopoulos, on behalf of Oracle
// Contributed and/or modified by Adam Wulkiewicz, on behalf of Oracle

// Use, modification and distribution is subject to the Boost Software License,
// Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_GEOMETRY_FORMULAS_MERIDIAN_SEGMENT_HPP
#define BOOST_GEOMETRY_FORMULAS_MERIDIAN_SEGMENT_HPP

#include <boost/math/constants/constants.hpp>

#include <boost/geometry/core/radius.hpp>

#include <boost/geometry/util/condition.hpp>
#include <boost/geometry/util/math.hpp>
#include <boost/geometry/util/normalize_spheroidal_coordinates.hpp>

namespace boost { namespace geometry { namespace formula
{

/*!
\brief Test if a segment is meridian or not.
*/

class meridian_segment
{

public :

    enum SegmentType {NonMeridian, MeridianCrossingPole, MeridianNotCrossingPole};

    template <typename T>
    static inline SegmentType is_meridian(T lon1, T lat1, T lon2, T lat2)
    {
        SegmentType res = NonMeridian;
        T diff = geometry::math::longitude_distance_signed<geometry::radian>(lon1, lon2);

        if ( meridian_not_crossing_pole(lat1, lat2, diff) )
        {
            res = MeridianNotCrossingPole;
        }
        else if ( meridian_crossing_pole(diff) )
        {
            res = MeridianCrossingPole;
        }
        return res;
    }

    template <typename T>
    static bool meridian_not_crossing_pole(T lat1, T lat2, T diff)
    {
        T half_pi = math::half_pi<T>();
        return math::equals(diff, T(0)) ||
               (math::equals(lat2, half_pi) && math::equals(lat1, -half_pi));
    }

    template <typename T>
    static bool meridian_crossing_pole(T diff)
    {
        return math::equals(math::abs(diff), math::pi<T>());
    }

};

}}} // namespace boost::geometry::formula

#endif //BOOST_GEOMETRY_FORMULAS_MERIDIAN_SEGMENT_HPP

/* meridian_segment.hpp
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
*/