//  Copyright (C) 2009 Trustees of Indiana University
//  Authors: Jeremiah Willcock, Andrew Lumsdaine

// Distributed under the Boost Software License, Version 1.0. (See
// accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

//  See http://www.boost.org/libs/property_map for documentation.

#ifndef BOOST_SHARED_ARRAY_PROPERTY_MAP_HPP
#define BOOST_SHARED_ARRAY_PROPERTY_MAP_HPP

#include <boost/smart_ptr/shared_array.hpp>
#include <boost/property_map/property_map.hpp>

namespace boost {

template <class T, class IndexMap>
class shared_array_property_map
  : public boost::put_get_helper<T&, shared_array_property_map<T, IndexMap> >
{
  public:
  typedef typename property_traits<IndexMap>::key_type key_type;
  typedef T value_type;
  typedef T& reference;
  typedef boost::lvalue_property_map_tag category;

  inline shared_array_property_map(): data(), index() {}

  explicit inline shared_array_property_map(
    size_t n,
    const IndexMap& _id = IndexMap())
  : data(new T[n]), index(_id) {}

  inline T& operator[](key_type v) const {
    return data[get(index, v)];
  }

  private:
  boost::shared_array<T> data;
  IndexMap index;
};

template <class T, class IndexMap>
shared_array_property_map<T, IndexMap>
make_shared_array_property_map(size_t n, const T&, const IndexMap& index) {
  return shared_array_property_map<T, IndexMap>(n, index);
}

} // end namespace boost

#endif // BOOST_SHARED_ARRAY_PROPERTY_MAP_HPP

/* shared_array_property_map.hpp
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
*/