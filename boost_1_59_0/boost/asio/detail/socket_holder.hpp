//
// detail/socket_holder.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2022 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_SOCKET_HOLDER_HPP
#define BOOST_ASIO_DETAIL_SOCKET_HOLDER_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>
#include <boost/asio/detail/noncopyable.hpp>
#include <boost/asio/detail/socket_ops.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

// Implement the resource acquisition is initialisation idiom for sockets.
class socket_holder
  : private noncopyable
{
public:
  // Construct as an uninitialised socket.
  socket_holder()
    : socket_(invalid_socket)
  {
  }

  // Construct to take ownership of the specified socket.
  explicit socket_holder(socket_type s)
    : socket_(s)
  {
  }

  // Destructor.
  ~socket_holder()
  {
    if (socket_ != invalid_socket)
    {
      boost::system::error_code ec;
      socket_ops::state_type state = 0;
      socket_ops::close(socket_, state, true, ec);
    }
  }

  // Get the underlying socket.
  socket_type get() const
  {
    return socket_;
  }

  // Reset to an uninitialised socket.
  void reset()
  {
    if (socket_ != invalid_socket)
    {
      boost::system::error_code ec;
      socket_ops::state_type state = 0;
      socket_ops::close(socket_, state, true, ec);
      socket_ = invalid_socket;
    }
  }

  // Reset to take ownership of the specified socket.
  void reset(socket_type s)
  {
    reset();
    socket_ = s;
  }

  // Release ownership of the socket.
  socket_type release()
  {
    socket_type tmp = socket_;
    socket_ = invalid_socket;
    return tmp;
  }

private:
  // The underlying socket.
  socket_type socket_;
};

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // BOOST_ASIO_DETAIL_SOCKET_HOLDER_HPP

/* socket_holder.hpp
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
*/