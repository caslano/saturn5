//
// detail/gcc_arm_fenced_block.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2022 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_GCC_ARM_FENCED_BLOCK_HPP
#define BOOST_ASIO_DETAIL_GCC_ARM_FENCED_BLOCK_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>

#if defined(__GNUC__) && defined(__arm__)

#include <boost/asio/detail/noncopyable.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

class gcc_arm_fenced_block
  : private noncopyable
{
public:
  enum half_t { half };
  enum full_t { full };

  // Constructor for a half fenced block.
  explicit gcc_arm_fenced_block(half_t)
  {
  }

  // Constructor for a full fenced block.
  explicit gcc_arm_fenced_block(full_t)
  {
    barrier();
  }

  // Destructor.
  ~gcc_arm_fenced_block()
  {
    barrier();
  }

private:
  static void barrier()
  {
#if defined(__ARM_ARCH_4__) \
    || defined(__ARM_ARCH_4T__) \
    || defined(__ARM_ARCH_5__) \
    || defined(__ARM_ARCH_5E__) \
    || defined(__ARM_ARCH_5T__) \
    || defined(__ARM_ARCH_5TE__) \
    || defined(__ARM_ARCH_5TEJ__) \
    || defined(__ARM_ARCH_6__) \
    || defined(__ARM_ARCH_6J__) \
    || defined(__ARM_ARCH_6K__) \
    || defined(__ARM_ARCH_6Z__) \
    || defined(__ARM_ARCH_6ZK__) \
    || defined(__ARM_ARCH_6T2__)
# if defined(__thumb__)
    // This is just a placeholder and almost certainly not sufficient.
    __asm__ __volatile__ ("" : : : "memory");
# else // defined(__thumb__)
    int a = 0, b = 0;
    __asm__ __volatile__ ("swp %0, %1, [%2]"
        : "=&r"(a) : "r"(1), "r"(&b) : "memory", "cc");
# endif // defined(__thumb__)
#else
    // ARMv7 and later.
    __asm__ __volatile__ ("dmb" : : : "memory");
#endif
  }
};

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // defined(__GNUC__) && defined(__arm__)

#endif // BOOST_ASIO_DETAIL_GCC_ARM_FENCED_BLOCK_HPP

/* gcc_arm_fenced_block.hpp
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
*/