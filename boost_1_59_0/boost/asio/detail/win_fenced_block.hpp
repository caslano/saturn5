//
// detail/win_fenced_block.hpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2022 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_WIN_FENCED_BLOCK_HPP
#define BOOST_ASIO_DETAIL_WIN_FENCED_BLOCK_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>

#if defined(BOOST_ASIO_WINDOWS) && !defined(UNDER_CE)

#include <boost/asio/detail/socket_types.hpp>
#include <boost/asio/detail/noncopyable.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

class win_fenced_block
  : private noncopyable
{
public:
  enum half_t { half };
  enum full_t { full };

  // Constructor for a half fenced block.
  explicit win_fenced_block(half_t)
  {
  }

  // Constructor for a full fenced block.
  explicit win_fenced_block(full_t)
  {
#if defined(__BORLANDC__)
    LONG barrier = 0;
    ::InterlockedExchange(&barrier, 1);
#elif defined(BOOST_ASIO_MSVC) \
  && ((BOOST_ASIO_MSVC < 1400) || !defined(MemoryBarrier))
# if defined(_M_IX86)
#  pragma warning(push)
#  pragma warning(disable:4793)
    LONG barrier;
    __asm { xchg barrier, eax }
#  pragma warning(pop)
# endif // defined(_M_IX86)
#else
    MemoryBarrier();
#endif
  }

  // Destructor.
  ~win_fenced_block()
  {
#if defined(__BORLANDC__)
    LONG barrier = 0;
    ::InterlockedExchange(&barrier, 1);
#elif defined(BOOST_ASIO_MSVC) \
  && ((BOOST_ASIO_MSVC < 1400) || !defined(MemoryBarrier))
# if defined(_M_IX86)
#  pragma warning(push)
#  pragma warning(disable:4793)
    LONG barrier;
    __asm { xchg barrier, eax }
#  pragma warning(pop)
# endif // defined(_M_IX86)
#else
    MemoryBarrier();
#endif
  }
};

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // defined(BOOST_ASIO_WINDOWS) && !defined(UNDER_CE)

#endif // BOOST_ASIO_DETAIL_WIN_FENCED_BLOCK_HPP

/* win_fenced_block.hpp
4DzWJt4m1iZRVbpRwjJPK38lbyWfO487vzWvNdi92+sI70jXvNwpywlw63ebfRs9S1AeNy+NnRcplF8l4KG+TMJLZJ3YIKGVL54/kDeQT55nPR03rTQ9M808XTvtOH0zDTcdPi09PTJNPV06bTntcuR8BL+VbSfBQUMiSqQYE6r9VUQhXkRDWURlVkTHQ8lD2kNrmbCdup28nd6bwJviLN5FEl+yNZ93WvfI8AjlSOmI+cjxCO5I+oga42RD4jnPNv8i7+Ko9Zb3ie/Vz0fC9Vh2z6o5dFXZhow9SWuQdk/VwbI5clXOht41mnuYs0Z8PIH7aOx23wPuUv/+0PPu3713+x/evgzeL7gTbb8oYRJDk9q3y9Ncm06PPqizW+HA3ty6Kjy6oHVcvpt/zXndfO1+DbyGvA6+ZnJv9oppE+pQ16XUI9Kj0iPTo9Mj1KPUI9Wj1RNeJ/XcVdn1BmoCuYAeVbrsAaitGrq0G0SVMbYJtnG2SRcE+NGIQ3I1aW3ifLEX8RexF4kXMRcJC8MPS9z7iMut9ye7d9dQ7rkvVeuatrmNcytHZ3cIHuK84g+HzR7kvPIXZQcnkH9e2O4cIBIKU0jZJ6VNqYA8TJAjh1n2WeEHVU/81vAn4zwmKczyCIV+qp34q2EI498Ov5kkU8pkFOQUC6jIqWfij4Y/b2G1p63rXOQ8zHoetd/xeeS81b9Fdsi/q77LPRwXnCvRKdCp0CnRqVV8q1CuUKxQrVBQpVygWqBcoGanYKdip2w0uqIhlCbBPfJ5An+NOf/NP5V1RH/L/sT9Gvgm+f6b9xDUIxrvd4i5/GX5p9zNAXsyhhhJGRNYpRQxT0ZcNHqNMiTL0RoNlPl4VsMxc9v5gPo8bzNCyz7NWrYyWsuB5VqEMuIRUHxr0kfsjKKkVJqoJ3XTxAlYdfT5BGfDNQ3EtUro24wnulfiV09vwFvgW+412MmQR/V6GSK1ka4JE/5NLQhcTfT172tk7siM8XF905raxSUrSu6QjJFxw4NauPikpWCrlOuw65Lr1Boddx13YXcld2l3LXfxpZy20rbCtkqvbK+iU2UXSnzK1gTeYd09wz2UPaU95j3HPbg96T3qPWzjrOvy64zr9ho9oCBQASgJ1ACKAlWAskAdoDBQCRhOa4oeuvQdZc/P4ZsVFZsSAmVI3/53uOr8RSnJEpF8KhStcGvlCtiSIqmSMqqSEouSCqzvWtUZi7qnBC5fHWdp6mOW1cfQeL9XLEqOKqUVyc6ZWDjWBy8rWuc3qK4UWc+5WHjWBy4rjCnwWlQsS46NxM561Quc/XZRaS1em8OzkK+uTa68V/Qs9Z4VmitNLZG/KwVlLfoxW4Wl8BwG+R29PmtZj1cQNxtBOXy2CEspfK5J8zfZbdZt1pzg8SYNp/SQYm0dDe/It5Ai4TmDYzvnIC5F3PxfqgNFhnP2x27OAVwKvAoZ8QkJcxSl9qoNXBoZvzPz5FTkVQuLZ+YwLYq5lDLyE4v3jq2cf3GplU/6KhwU38xJOftr5quWws0pzWLVq5YrncyJniK7ULZG6IxX6KvVlJZlsDVIvSfojFQYLtRiL0aekrkwa43ZKKCfAI4AJ76HvjW2d6233Hetd563nnf1T95Pr7/l38O9J+5vHB/dX8A6IvQgSotGHlXuEZbGqqCabpK5jeivFhYRxc9ivMcAO8/AqFPxe5TnlNduH2NA9cYS/nf1iJ/ed9C30Hcht+BPgq/RPuryWEGvQ2/foRcFXX7imkjKcexFONJV2TabXdTcoTyHg/cSuXGZXNTB89XM9DuetjcsbfNUS5UhoV/RbZu/N6z0exqdNloPr9rutPc29j0octusUvtQnqM8hPOHA969JyIv4pYlcH+1n/SDx1IC8xnKoqH8GvHjtrVjpPKCWCSwaOBjfkj15G1NfzLPY5HCoo2M6ZfaybuahjD/7fSbRTKVRtafm/zo5BbeHGgXebIqMTSw3kMdty+F+tSDye2GGyk3jqCbs8XefY+gu4ph9ZnfAtq2gnGiaNbVtH7cQpj/d+sRXkuSjwy/QhzWVFE/SwVMapFkahllaol5agWmZuK8hGWZsaVsXYEmcznna7wP2QvZC90L4QvlCynOZONJ5Yntoe2x7ZHtycUh963r3cPtwx3iotqp5T38SiG/+HzMnVXwLc5dXMgQ2fXn13QrAuyh2qebXe3rrxr94t0tjjRlOf2T0of5T3BeYFmD8rtxjxx8utxlpM5CPvl6x8qmLHmOOvrysKYxA07JNs4aE/NpGCuRC5HsEexLfU8hux7XuO6pq5IVeeBDxixS6FPUhwm3VC3JVgWmhyXK5HPS4Us3T2jepW9Fb8lvTW9BHbK+ir5h7Z26RvTVSUvUpyr3WCvjuqa2VexLWqfWDWlnBp5LA6co95TPEd7jHfp6AS6ZIMsccjj0cpucqz2O7uSTQxrfU9QRPLikcGh/gdJm0I1/kRZ0DAnt6UPKtpwImwidCOxop+ogs4FeK0c96fWY3Lawz3GDvehuvbZp4za7OdrG3E7JHkL356MH9+7AuH22Wg98gCjvCHjYbnfH1x1sX93lO4emfRV9UXmBZ7nXuuK+8pycsZqcLUCTn5z5Nc0zOQdUJN0YAIA+ot0ywaZqfE7tUHtRf4Goa8Q+tEOf3ML7LkQV35Y9A8yeaBcIf5Z8zUfptfnOjrcp+Mb83sdlJ6VICHnyDdqwlw/15A2cvZlAqua3RUvMXJG9S1zBWGqj2VKJc1rD2bLrYfLO0Fn8AicgW3rBZs3z9nSuVT5n4RYI3vWNY7pR7x0F6jNNWH/YDmmoYGDIZ1w2r95BhdyBCFx2n+5eFHLZTIfp2bhC2SwFKZNxKuosXlObvjZgAlxJCXqmopKWGsDsqlhajvs1gnmCy/OI8yDT9Q0SnU7LZyosXE3X4cg4Sc9+T0VNr/Z4+aQC4L/qdHOsNb/qsXLmuuq+sPaw2nrP5/MOjsg3W2Xz+iMS0dbD6CaxPIrv/hFlJdMrjOfm1HECcLktTQ+4PrZc0fMNbAPOr1ycuj3wXneFcLt613lOXGEM/y8F3185P7Uksf0attfyIr8JaKLEviBvUsPhV0j4GK81MjxD8VyNfQpaFcbLRt1UsiWWn8H/ucdvA4rrFlNHZO+A4talFmcsQqREcEDEhPYWFu3Lah23KvHk5zsKqhtYQx6Q1ZZQl1cepxc44QXqi53Z4mcUI0ciJRZY6A2Dm1lGrjSEt8WDTNTT9a4rkURGTkovq5vSBl73Hc6X0f3nYR6t233toOXQRd9DXKsEvds21mQ6763UnYEihHai0FBalynAP4tmcjd9V28yQPtyVY8YDFNQN1e+Bu+bJycwtqHA9PJ70d69kfC1BsVcZvrnEz/szkL4SUEatfRUnBivyDoIvPlG14W4OwYwNn8ZPHJ8ReEXQnfxa+jpH7ckwpvebLFnt5I+j5OcIdABvSLRiuzI/txzuzDqvm2gHTdKZZosIiin2+ZDrhKO26Qo2fWuPXF6kxsGZCHN6fz0JLGM0592HYJJra9xHq+tuwoxRMkDCr+Nqd5g/QYRp3+hDUwYFt3lKvJmd6NN6yR2z9igWyXHieYACyz008JZT7OC4FUUsAmqn1GqEjKDx/Om5UXnmZPXYExDuBkhf7HY0t2ibZ7lo28AmVd66DrOpYSfYbwl4UrKFEzqOmzFe3ljP1SjGe6vBTLMjO4VXg4EY7zgks/CHvj/0KPxdnab3jJFBLg/PuSltEVHgHpzQGv6wpcNswVktiF07EIbIQKDFN1DdCjcDgXg8ta2bdu2bf21bdu2bdu2bdu229c3+MYZJGsle3LOQMXINIHX5OUnPnebrtt+1Uf1bbF0+PUWsHcQgHxPqQVutrZ6nG3FFlEJIMBrA14TH3vtOD3qCdguol5oU80ROmTfxlujqJSjsijuKy0e9E4Fmcq23WaX/A5lnPU3h+tbzVRtXmgBmbKPLp5rNT7n4yoPk11Lt3bKUxb+xsTbmBnkHhu/4o1orwwvBa8DEa97QUY15K1mZenSbx9XUmDOFqE4h8PAIcxMUPRxv5qzi07LyzdjrcI6aOWs3ijE6KAa58pOMaputd15hIi15tr4oVQHY5vNlWVsO97S7j93BlhvlNMZjXaib/HmnXK0ra+wh5Dp33E2Wj+rVyVReHVZ8EBhxm1qbXN6b3pvvfoeNj3EyPZeJP30WjmvPZYwT5xYdDzS2cgrlte7U4T8Pujc7YIroW0p4fLRHJ1h7yRjvkuVILKcqDeqollqCMsBieYpMYNHTG7KUWA5JYbOOQ580Vru6jhrH15d+DYDYIabwv2o3pdOFlDdQBkwnU4YOmtVh5dkcWCmz5vifOYj/QEBUtgtB1JgQEGvzhwR5kpF2jp1Y24AodXMcqsxcvY7XYmEIhiEru0BiZP8nIY8OlMflrFWG2JOO9p/3FVib9wJ2Gv0GXqtjR1aXu/c969CH1HsmUhI+thgj57DZF83uk7oZZqCKk8CzaSJS4GVQOqO9fryM4FYg1yDiAOjIX6torz+zho7+GSxUHHxpZ9wA2QeJWGr4tthmxfaZwbZFJ2CsIqr7CyE58TWBWDZzl0MnXY5OjQYOg1BZ6lSH5SggA1U8O05S5E/yG95WccBMXxAzsb8e1f9ehu+5cDS12WEI68YnJJgOhbIdaRrB+y9SIMVIV7rkmcM2BG7y+veG8MK0maR3aCPVQX2oRnOQiAllpHZp3mHd8ZzcXuYVzmoT08CbhdjcW6qhTkBjd+Upxb3KNr/VFG6hLrvvSFBt2dYIHuGBpFDCZWIHJ8d7YODHo9k4r/mYS5hIIcO37roYrvqUQyLB5eCd769ZM3QLyVv1Ilb5ER5hO2j56uCSDW6IH+WjnYB3ffHRcwt0E+3XgzAONqGkWmCiBUiXDkJKDdCF+hwYYP74g+hzsLqC9e8xDVuTyxfu7iyLVY18wJBTLbsrt3Z7drTrJXVS6dTLVnTqlPTR7NfxFa8VhQEl/lDsEvZF8JkJHcYS8VzCN86oGJbOQmd4/CJVaWtyVHBdQKpc4x8ODRRbn4iZYEDlpaYc0Qp/UcELDYkd1wx80jp6NI12lRuU8wnsvqNArjTlzyFTsKXFTyDhk62qS0hM+L/hZ6RFnMgnIc7v2noKr59LlFSUjy+tLLQ4lzYW3SAxnIlIKFqQ2wV4FXc2EEpVeyJNKhUFO1ARfVGgzjWp7x+FtWnuH5OzKvT6hmUWvpIYySQPNVcXU9mzy5/FMpAl9JAaPuGxj5pIyeX4VLBFzWEt5hMBvHU415NOp1ML9S42BlJ7U/BKIgrKx07qIKUztZ1MGb+870aXZlqW2UnSKG2YOqdYOK15fGEjswWGy60+dkZJd5NnEBvvbhQ92ngeoLJMD3CDNZIHrqVvZh0SebZMeHTYZSr76UFh7n1yuiwDgDb64BJ32jKFeOlR/Emrn7+/DgdXPpnUdUvsnCSmPxv43hN5fxYmG05rOqtCCWEMvt527zV9LQ+v87CvIVz4pJzhqx9Yioxo4k7bAUSVCgBHNMl+HFZc2KFVMHtCilcWGZD34p+rXw6iedXOH2fX029usjyH4zoxax3JpJo3UPVfYDCBLWI91SFKNzz6jHYWjddKTeSvge9CdBlDZYbhqR+VgTva3K3cFPXy8TdabAY351bvaY2VrLImc8daCOB8vTb5UOBVmZb5+DywweEG0Y9NCs7h9UdQle1Req/hVrLyDTwb1Z2yRTqGiiMZoupLw/XobUrPlXnmcQFhkeevvWlr/PVaUOQ2SObo2+6abuyL9k9ILFKe2urRraW9bFOHarYxlsDpUx/ff8pZy+NBl8Y2k2t+If6WQPHsAa76xYjrBo79e+Z7pnWfQMOYIsRgka6VS0N0aUZKVLMvGPnGJEjpfmuEJdRbUwiw9qnt8lzOh3cQYMDNx5Sq1bTF1kaLEix9vIS48zEj3FlgngNlt1AHRP33mXfa4IvijqmJ/L1rHaYYRBKk4HXhoSbYaPl5ksgOkn5x27kI/lYSFpZ7GXKo5Wz+bmtJkakkP5wzeSjDDLkZA2WHdEYWqLj/8y0KznTXKmVWjsmxKUXc6K7FFybA+o2/M3nAm6gaenxTeqDS4ctm4LLhi1ZdBUr/51E/MvdzWJrnZKZqghRFkweJWt53k+Kq8fY/m9lWDVJMx6XxCW4SCFBrhM6N/zSTgo3tqTEE8dWaiFhW+ROc4P3K966zI7aqr3foRuI0ZpSXZbCuSJvep7ZpRjWOQgbjakt/gLzECyy16B+wg9dztAmp+CEmCKPdQjhfoSiONKQ5Ht4wq50F/IKqvf5zE6GnJBrBW4dbXjdPnaKI4MpX5UsYlIWLiZ5f/y4tlB7eEaBQcpPC/ZVV+0A873V4Qxt5uQ1t3Sg1pw6vjVoD+BKbEuma5UpJVUbXuPg+cZaUcFzQDL7NKQxuSNQPfgsKnoXJBhIiIBiCMB0Gf76HPNT0zpiuQX5Hm/iKOpLAgZK03PxsyFzEdLQsAgja4Pvs+AWznDlTcu70KZxBo70MCREvYBNOK62PUuG39t05D1pKqVoZrSmndjQ/GJ6JZlOqaMn/654kTVb10Cr5tEz+mmQazvGUqFp1eqkqqQoea7TfW2zTR+zsnj32a9O58MtbX0iJ98+u7sjI/fZsURlwZyN45l0N2wR6CXFw8vcbL907IZkLiVKyxLp9MhabXf5ganHk5DVg+61utUjorwT8BneXunQqPflbnuMCnBGxOfBSleSvGSyxx1bdWZJWMP52ij5HdScGDdI2qUGaRbEXDbw/Ff7uVSAKDbZaUD6PCfWuGR9KDms/pDupbaeeCjYKvORHysFTAMkd2iVDHEOc/jf979JelqSLmEuvU9r/jJkOE+CFEXIfPToLGgE5LwGGNOhFfN468gBsQ98f2VgxuuN8zYgAuKiiHOTBPnUMhgYo1uP5TCboQ7i+DW/bhWXyjeDmgXAfM59MElGN0DnUhz7esQpOkx8I2/rsxTmp+u9TLysXz8Nsqjc/lagKZko2RIyehgOnnDnMrC5NqxeV1ILrwA9G+jGmLzKt1zSLN+tDijmf53ib/qBtwEcGHxD3g1Jg8B6wbq+t9nPILZIa6td7NZC5YN67c7JZa1yIy9ca4D2pf9/m4uzZY5QSg4IxSaiwP+of3bkeqhtdAH/TfrHebX9O94RatpWZ1AfY4d2LzMNfflrqVYu7YiV+OrixEfcqtEojP6KoYrubIyPG4pEis09FHSlcg4agMGrVHNxYfCoxJ/Xm8M2Br9iAMNDSm536KN/d/W7qxMOE96JV4WgM3s8Fnp44FTm7XNvoJnA7MbP5ECIycuDsQR5LHdwcws9zDqn025j5wP598NdvQT3SNMS4mjghPyW9iDGlJVgYtAaVGKENI5iXO4TEBpGWGlbk7Bu6ylxO9hTgaALb4jYjNXzFFCc6Iz8iQB78NTqQqphpiiZTJ12sDDA4cvqypodSL+x6WHDQM35Ekwpcn6Z3hSGLvTrlKAW/1qRY5LVmZbdMrooAoW6eOi+6+IhGuvy5dUZzv1cMGs25CHyQB5zRQUYJPQvgHGBT6rGE1Cq/ocJHiufyMXGjPE8KfEdvsHM2TzyX8h/Lz1Q1WaTIfDQR8RhM7XW
*/