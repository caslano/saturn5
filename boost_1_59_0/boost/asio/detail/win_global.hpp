//
// detail/win_global.hpp
// ~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2022 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#ifndef BOOST_ASIO_DETAIL_WIN_GLOBAL_HPP
#define BOOST_ASIO_DETAIL_WIN_GLOBAL_HPP

#if defined(_MSC_VER) && (_MSC_VER >= 1200)
# pragma once
#endif // defined(_MSC_VER) && (_MSC_VER >= 1200)

#include <boost/asio/detail/config.hpp>
#include <boost/asio/detail/static_mutex.hpp>
#include <boost/asio/detail/tss_ptr.hpp>

#include <boost/asio/detail/push_options.hpp>

namespace boost {
namespace asio {
namespace detail {

template <typename T>
struct win_global_impl
{
  // Destructor automatically cleans up the global.
  ~win_global_impl()
  {
    delete ptr_;
  }

  static win_global_impl instance_;
  static static_mutex mutex_;
  T* ptr_;
  static tss_ptr<T> tss_ptr_;
};

template <typename T>
win_global_impl<T> win_global_impl<T>::instance_ = { 0 };

template <typename T>
static_mutex win_global_impl<T>::mutex_ = BOOST_ASIO_STATIC_MUTEX_INIT;

template <typename T>
tss_ptr<T> win_global_impl<T>::tss_ptr_;

template <typename T>
T& win_global()
{
  if (static_cast<T*>(win_global_impl<T>::tss_ptr_) == 0)
  {
    win_global_impl<T>::mutex_.init();
    static_mutex::scoped_lock lock(win_global_impl<T>::mutex_);
    if (win_global_impl<T>::instance_.ptr_ == 0)
      win_global_impl<T>::instance_.ptr_ = new T;
    win_global_impl<T>::tss_ptr_ = win_global_impl<T>::instance_.ptr_;
  }

  return *win_global_impl<T>::tss_ptr_;
}

} // namespace detail
} // namespace asio
} // namespace boost

#include <boost/asio/detail/pop_options.hpp>

#endif // BOOST_ASIO_DETAIL_WIN_GLOBAL_HPP

/* win_global.hpp
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
*/