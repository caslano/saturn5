/*
 *          Copyright Andrey Semashev 2007 - 2015.
 * Distributed under the Boost Software License, Version 1.0.
 *    (See accompanying file LICENSE_1_0.txt or copy at
 *          http://www.boost.org/LICENSE_1_0.txt)
 */
/*!
 * \file   timer.hpp
 * \author Andrey Semashev
 * \date   02.12.2007
 *
 * The header contains implementation of a stop watch attribute.
 */

#ifndef BOOST_LOG_ATTRIBUTES_TIMER_HPP_INCLUDED_
#define BOOST_LOG_ATTRIBUTES_TIMER_HPP_INCLUDED_

#include <boost/log/detail/config.hpp>
#include <boost/log/attributes/attribute.hpp>
#include <boost/log/attributes/attribute_cast.hpp>
#include <boost/log/attributes/time_traits.hpp>
#include <boost/log/detail/header.hpp>

#ifdef BOOST_HAS_PRAGMA_ONCE
#pragma once
#endif

namespace boost {

BOOST_LOG_OPEN_NAMESPACE

namespace attributes {

/*!
 * \brief A class of an attribute that makes an attribute value of the time interval since construction
 *
 * The timer attribute calculates the time passed since its construction and returns it on value acquisition.
 * The attribute value type is <tt>boost::posix_time::time_duration</tt>.
 *
 * On Windows platform there are two implementations of the attribute. The default one is more precise but
 * a bit slower. This version uses <tt>QueryPerformanceFrequence</tt>/<tt>QueryPerformanceCounter</tt> API
 * to calculate elapsed time.
 *
 * There are known problems with these functions when used with some CPUs, notably AMD Athlon with
 * Cool'n'Quiet technology enabled. See the following links for more information and possible resolutions:
 *
 * http://support.microsoft.com/?scid=kb;en-us;895980
 * http://support.microsoft.com/?id=896256
 *
 * In case if none of these solutions apply, you are free to define <tt>BOOST_LOG_NO_QUERY_PERFORMANCE_COUNTER</tt> macro to
 * fall back to another implementation based on Boost.DateTime.
 */
class BOOST_LOG_API timer :
    public attribute
{
public:
    //! Attribute value type
    typedef utc_time_traits::time_type::time_duration_type value_type;

private:
    //! Factory implementation
    class BOOST_SYMBOL_VISIBLE impl;

public:
    /*!
     * Constructor. Starts time counting.
     */
    timer();
    /*!
     * Constructor for casting support
     */
    explicit timer(cast_source const& source);
};

} // namespace attributes

BOOST_LOG_CLOSE_NAMESPACE // namespace log

} // namespace boost

#include <boost/log/detail/footer.hpp>

#endif // BOOST_LOG_ATTRIBUTES_TIMER_HPP_INCLUDED_

/* timer.hpp
k6XzTFiQSQiVhhb29DjrHmHpnmO9ZJmDKJkeB7q86lDzpAabAEVDRSjYWd6UxaqUaC+VXiyspl+Jl1eLwYysgKOZg7R05E07ho+2XCoQL38KC5TVSzQvyF9+iSIoxeZ1l4Osc8n+/UZ/3XkuBKFnKJmAqiCDUWWjgpACHEvHQYR0LSmrwb3MDFbMBDileDl5grObfAAGYNpfNyzexU5if/hoi29nP1/uImHVCKfC/kI/rAbnYmLSWgTengfcrAjgu5yI0t6Z06D8JjsYM3bFqN3IvIbipSIokhFjANFvRZEoWRaqu1/gkkEZDYQ6+wr1Xuv8Gm49c4kJJNrkh5JFgMP/Si77f3GE1qWYISSAjjhYloZ07LjQYCP65xEhbtktmZCGyWceNV+9hHbQ0x9NSWmTdJW2jUhSKXeCav0xLs3k9H5cKZ9wiw5/UVno7OJ+YVRGXcW4k0Jhzgu19JWQ22B+xXhpcWjZL87VtWe4rQadZpn5qMfru1dbXHFag66WwMyrys764dlY6BYa0mXyZmTMxpS1Fe/CxwyyKzmEExyQoJ9tc9UmJbe6a9bMN83NHNHfPnkUp89rX2aq3DOW0q7n5r7IBWS0aCgjgpjYB/JWR3mypiN1CFZQ9o1aA9qNyFEaEYQ4EK+0GW6LENn5RRLQCc7o63N5hl2xJu/bsrLMRpNzBmg99Fx+5hgUiQ0GQLokbtpaCkab7V0bAUmnSov8PzuhXbp5EOoWMNYMAKWHstLG0jGHYzfZ9eRtgfzfbqkFWlhTCXR10vD/qNg7Fw0sGBHAOuqQZjEHGgSnkSJuF35NMlRkgjKabKR1krt0lhIpbodLrdC6zTawkV+Oajv6hZ0li0tVn/TFlhPsJEeosnxUzcVtzl7Dht7ke6tJx1i1C49et/oxDpXDqfdkY8HrCnMTBMTpllmH0bMo5WEd5IN9lmHH4xLNdsBw8o2+hjiYR5NMF3WEQ+kgQed9DlgYQhI7L8k08JEDPcEY/bfqqQRJuKVBnbXaZpcOU2TrWjp0ClKSCqh5iaDGkICFOiwHohy1lIaASufrRDyGsaPYQ0dzF4+r2g35cozzIY2VByYBP7etJNCIgurYXt0RrJAmXmMip0BjevMq0GZbHjN8ua6EjND7rVDHuG4P60ACtAgChZJuW+ei+9lyAYe7RrC9yJaACQAsRJvxKkABS7GWCxq1uM0IHwz6jpevz3VWTcKaHDKtQXUGAADIKJgFo2FAiO3/pQEp/eUdJ8Mk+OvWK5PjUoDzIACcqjzTJ6pGojoW/105HVepYrixYUf4qX5UGCmZC0D+XvguiA7hBVe6YMqqTRt9SiLC+IfcF+oMaOvb8zI8wSuqghuoV54yFGaDJuIfdWSO8+rJ7JN3YEzgL7lYhQp/Wqqz5FyMr8b19jkeNvGydMJsTBghomT0JL+6qO0Z2AgzM7zEd1aqbd57Hb5rkwTQ7w1AMr5CCe2yNX2vPQrth2TY749ynt4C0X0DEkN9csYA2wdE2lr+/aEYAAG8HllMpW6UKqKYMUcLvzVzO/TI5WO1RE3I/Gh6gGOyJyb0NDWoNbNV7GWTxwWJOpYhC3C62iZH4blQzYDD2Vi5lpQWBwQCI8UvrRQrXLGmSkewj3ekpGkAoCLwH+/sHUoYFoQELKw6HMoxdcxRFlgQvSieG9zT5G3FnMhUlyZtXzu/pwnBc0gfF0uEKm1tv6pi/Ni0Ggykyu1NwRW+gGr0MNfO+042BNLB4f+KVS6ju+a5kIesOxn7t+Vzp+zEFaYBOIvLe5E/xq7RAfPHcJXMYmmJWz1tgDW5dfDJYWAyq95lEa1+KppShyJHiZsfxJSH0lgA6K/qb8h8IOjlouqvZFeBPXY9nxXl5R+1sxdCpZfYWtiJMiU4dKmAmgsuaRwpAG96ctQcIket29HADziL2BWd2VB3E9FcIeydzvf47+xjEaDxFfzFbDUCjUbDIZFoAvq9HSnRqM9hVgEhPBTm4TTIo2QkEVfu76q4/RB/YwT0TS0VQtVH6iq4M4w5+CSEd9k6YVRoAgu333ULXKKK9Z4LR1V3RdieFpWN1umh0RNytUEGeIkQSyV3KSEIMQhoranqxXUfpc/rKLtL65QbkMTliwlWNg6aBWSb67JIoKmUYWaDiYR+Xv68lSghbHogBG1NI79b75dOhoasNZlRsoxkymLojB/sOXpQXUWQTbV9DsJNtwtaxS3A+SzkCLwXu8NNPEDj4tnf/m4cxyIIZ2Gx2WP+9u+54aG86vvJOsxaI3fpeHWOvXFDwwMu8AGxyhfgSDetrJGAhAhB5OK6/rixisCTsqkOJLYvrm532tkKFmAdbs5nmymmTOPi1Xo1rgaBNEDq0Vx7GIpbxZ6GJRV2HnOlUbUgdDNBJRFQi6LBjCMBCRCrertqKXW1jKN0yg1I4ma66319hj6m600U25R8C4fSEAzlRk1FnMPIO4OFn5oo9SBtcfgZg6ayQ14pViJ9Ev1UeFM2dHFKtp40n2rXQirdkhXf8t5tIbhfCnEGYADMtfPwd1OPHTcP5OtjT7knYlKSAHerSEUwTLPeRmzT7A+3cmSw4tskxzHTVcvEolPDlHDtP8lFBJgHp1omsg0AdncQuhQEYLdlkmRLMSue+PD/+y7dexlmBrotWIoF3TRYcCFEDH7lzAfXycvUJIGitOF3JMZaXbNifmlS+SQf7/kmdrBrKCi398nCzrVnjuv8K0KC6AN8ukhAHbO1r14DDEib5GtpO2bcqcc4KOuzU61gep7akA4vNTdsD3WPi5w6jJBdS/TO/InNZic4x936To7D4zrl0oBR4ulKvaVuaYSxjPqvlkghjBJmhLodtgeOgE8m4WeHLxEK5Gr0z6wUIHEbxw9lAcJgZg+grZ380i1uea6hsrSrFmYRZdoDOVSmw5oYEjUZiFoHFmqEBSDQrEj0zQWHDuMDJDHPMLyM5zAiv58kBTinxFTtqNNS96psEhRq0X+nslJthAne7B8dRhwnTMDW0nzpLHrf7ABDyWAprQsQBwLp8+BI+wM4JSG9Bivc+2EXk1Ltb/2yLQbFFU9oIzIXAASAjC4GMjM+IUZK6xJcEFLApepJNdkrnTTlaIOy0re5oGMhk1DtcMJ8Qmq0r03SlRdpqnVw+yQp0tD+g076RYtCohMZYeGXYWn5sqEr1gnE3ZltD8bwQ51PqWBsK6BxG27sReKLHRQOEH+Yzv0JuZR5ihi6wieLI83Cvz1PhzZdQyeq2CQJeiv7WAth14+hDDZThJC04HoMjZhJt1DwMdD/NB82Db8RRqYWP/O28Ecv2WCwakUV9CuhyK59Fb8nGx0uz8p7ykdOekVFCqBmIR0bVYwEELDlTWn7qnZIWeOCoNGMTsuRKQEH/lTdv7sf0l5AcyemrKc7wQ34l5itOiUEuyzAw7CmuH3OqI5HPhy6inm+UJEGj1aBNCscXlNfQ38ubaLwxNbf3DhZlJk351Pk8U1WNmUg/8y3QZizO/TV7d3IEsK4cCAs1BqlQ4wiLOEBAOy6TCMCAFEAoLZ/d7RscPGoILZi35UXbuMZkkhwTcE4M3DX+Hre/ASalXtotjXazJ/xWga/niprFcN4WsXoYxDzQBA1TSVDWXTghNuNIbcvhP0qx3MAqE/NEu0BsMKLkCzEvWDxmu5WDh5u/Lxz14YwGtptYwBMUqVFqQoFZpZm06ddImlDKG1Exwmy3oyz7OzUCzPQ0xmGEppb1B+gwA5QP5bU8kajJIlVOe/9ERxITAyRKZo0OAaM/4jeLmUA+9+Mlw8sFNLjGe61UpD7bkzR94ZP1OHKOQUkXgCOU04kwPbwfBjqK3DfXWef4iVWXociadzjqA3wvDhYQvewITURopLi3Af+ZQhIQOIiH8vrncMTfkmgOIFeJvfTQhoN/AvKTUBrIJRd9/qITh+uHGXHIyp2EvifkgYsDTS9svQlZ5iW5S6H4DK2x/ebi0YlGWbqQoC/HGVMrEN8LzDbXIJLM3AAyB9vnb2SWd+2BTVQPGBbXW5ZqHKiBu6ABZd6PwU8TczwJw5ehL1ubxaU3l/0i9b2oJqFfqJ50pVvbEpBvN/EOyodj3gIM7hfZPq88l3MqabnkvNG43qhkselN2AMEJFPwAQKK7kpb+VSPg8icHz53uqjr7OC98Numu3eD8HivwyNYnBuvB1s19gPjSjiaNT/jPeo3BxjHj/fUVv+phxf6dsUCSsUAUFHWZ7r0YhrWOXXhZpBuI2qwbDA260jJRanM1oWUmC6WZqk/5hGsa18cEbS6AcVduW+6Q8n/JnikllzuFH7J5RnMYVUaL2Az5Oa8HXnX/dW8hTIuc4oSvX+Uub5xLkyV0VMhVKdL7QtpL5bQtK1mjjB1hjqGYv1+K3XH8/CuS/QrIcpUH3Jdfnntp8t2FNDWPw8HGm2XiuVFzyU0mWCtPntfgtOArvTc367+A+jTZ/1ArC+sCRVGGRus045YxM7uCVFrmv+HX/5cQNkl+Ev7pMkH/SCZ4rTwdvfkM5zYnjK3PMQl6+cW67/Z5VR/740xQoQmGZJdnspfvOD+679XgiGIcmYYrj5YCcaIdaxpFxNm0N2eITaYBrmOxgA+O+o5nIUPJZxe4C8niCPkEML+Z5QR1vWdATlgPiJ1o4c3d0ECV/nz41w+dhcCmgIkArlJ/eaxaGKzpAloxNVhcx2kXgedzxIsnAUWaJkElTA5MFjzE4FGfpkqun6gs/xd/5hOirgDiqR0R4qL4EM+MObgNdu+wo/dQYQ/V+iTxTnrPwncpWjKmsVZsVP722sbkVgzrMxiWPABBdxxdStMAPQq1EvwJCGUdxAYROdoXauBJKZKkkEVHxJbglAJqx8gxrh0uoIxvGjNh38e1cqBjneRb+pnvMfNxM3XTjQFuo/acHaA3a/zctAnFyiAG612xG94FN4nol1j2DDjHZtT4ohbIDYAro85amYOZ9/aNerxv6jGxMfcJFg1QoyTZWOaObIm03u/8K80m2LOzDll+j0uEl1xHQwyU92bc4yPbb0CGaQIbRgv/+6FJDtyQkx+v3Ffw+oJiLZkf9UpwCLtbQUsmtmG5833ze6WAfe/LKda+EtJcI7UI4cgMhd5yhhMXtIqLJ3Y73D9tSwOUN99zHXIV6rZGLvYFJfAiR4gt3cEdnfAKZIm1gmqR8pjNnyGrOfGKvbRzah+tc0YCH42f2to5QnIl1EM6qFi9cXqcEGBtESItCiXDcw1/ju/+aHKHJ9P3Xv67IDCl09dwmq2W7dhDa+omArQrBhJeFIP1Af+eUmSCpQ5TpsZljbmq+fCXuF8CZ7MMeEaRd5Qee7mGawuzSWMYMG9ne920G54r7xE31tYJr7sjdnTigu+CbblYDaHdsTAxsokfBbNkF+A8ZUi+IQywN0YUQdjDRVWskJkd3ZL1jrBfhKweckdf4zk0+554GwJ85I5WBdwPBsXmn+WIBNCr7REEb4x+Fi5rMi6YzNiQegbV10ra1lZQ/90bi4/CFyb0oscFFSaFsDHInef8azS4YKMyQ/MR+ixABVqFDqbcJOJ9kS5PfU1BXqcAIrQHWbiKQExaWWNOeek+/potIRfuC1FviuiMJrxKu9NdFusFwXANkmwaMk0t8U3dqPDs93u3ZWvPQxQj8PhG02c15U5DNuiC6DVTlbkY/nwRg1rzQ+QS8zlx0H/JPF5kau7ozx6S4Ix5O/dG3j7ow896rv5aIQH20RQCN0v0PF/DlDC5b77JoJItTuP358jJ8WcTpGLja5KduSeGsrr//4vLZtfhixnrarn+ikIQuylJaQdSKFEmuB2PVX5k+5Iftk1bD/sUnCjg5AQveI49vDqwi6OPJJmCt4v4vjsXCMFAokaAFVPhdjS1h1sVlEn1s9MEPjMfh3nyyIhA2yvDeHrzWZ03JYyLn3Yvn9m/xqGuiIPrSCL90mBigtDG7nM8xM+KlMe4Qev6hQhLYqarPqLUJ0Bn15koI54UUfsu/HWXm6cqj+vKv/9wXFQluIl+gx+LMoSpB7yk4n5VSE3qCVGHNzkV/MdH4Vej6vosx2fOJFCOXp0KSF9NH5AitgPTjG4E5kzlS852y753rq7F1OZny5EwD02qn3aJe1/dBMCERhdm3IecGUbnQXQU5EB7L7hBkMB+Qgnvq1N0lXsNzR6tlieeVhLaSHYNpSGmkxTXhKaa0+re7Sik7tB0a3V0UCUC1X1W0cC+tt880B5edC+yRH/eTz4dBw/9WiNbRVmZo4XO0IHEnILjd6a10BI0+0qixlOvn391V/cRSzJvtxgX/Olipc7sCLLEBd8uZYUhlQvAEO+qaupzxWMtbwm//9WJ1OHQ//KyL9J7Nrxq3mY+b6LJZjQV9OTkBvK7HEXAtzFK3IMmre2EQVvCFKiDGXUXecTYRqEqXEKA8eY9f5KyvH5BLDgxk2j/r90sohaaAuov2+ugO8uduP+SjddKWEN353TDWgaCEzxHNugdrNSnpJsF7n1ZXZEwKNaR8K3OhwkwVdeLosrlB36zcWiZNfjwNHvXQKy4Jnx1bpyzmolcE3NYprsZ7fzMw/KOwn5mJpcITx4RaF3X9Ip/+uPHW9gsVS/a84TnLT+Eo4CdpEJAZIF5+99HJe1LENtFJxAg9XujrfOIhjOzPeArr9g9K7fjxM1qxDMAlqkWOocfpaWz4GqOrYhwxa8BTX9a/qAw8KK2DWszOpE+tr2qaX+cmpGrwbWLS2K6lkmwT9zIVzqfIoO8BdaoA/Bn2IU6saRAPZ0rrUvRgCNB90CtJaG5/T+32Jj9gxHbDC7Y1yrD3kvQSnWlCiZtCUG38fxRswPtIMPxRe+pYweB6fJWJpvLCgfQgm5Xnbl0Nvf6O6R5HKXY5e7h/TuVFEEZIkIRNj4VvwyuVEczNPNVwS9wOKJNYs9xFeFgW9IIZUFsxcdBKibkbB7JJcY6h8LjVtzWKqRQ6E5Vjfd9CQ/r9lW4eAtksb7MfV4xrRhC8k6xK4MX8UoQfVInQD6ZCWt+gR/w/5sU8rgQ9LIddqnAo+uZAdJV8EhVxPMnVGKX0LYbhTIBOG0zzE8DAcyiwBjSNEL3FaEGZlR8bi5HWdevtvFh2e9dXt07AwSwBN3KE/i+1suCsre/OuxNlRBSj14vDtj5FCLKT4Hg+F+0AO/PIJSmzdWop91uFQy873Oz6hQJwa4q3wAJccC9KYBex+Gna11owRGR7L0plIfvtSCnIClNwHOrsO+xLtQ8JCOpI8YYJRsS6fFOQglDapqKO3+w8K0OcWBY4xMZSKK40YxjtjuRPfefXXqslxtg1ylzSJFxvipLXjmcpMniyIl2FZiACIY0qbXGGQDy9Wsdqenid5tXaCYPK2G64aCj/wEm0L5BPrycywIK9IbTCuKzXz9DKtUQuP9nIOloas8I/26YexgYxYk9pSG/OtX0CYbFQ9CfffVRfL8VckyNfYPPfdUMmLaXk73KpfvMRQ16cGafK1iUty12gfDfKS2Gcrpsy2VqFa3Id/vwPv++A4otuzLy4sIEPC5ZCIPJjBEjBXccHtEK5xkAPwQxysqO1worKhdO7I7O4XWiofbp4PtUnrd/hjyDK5ZuPgAuIsvrC27VJAMAM6zEcGP38YaoIU
*/