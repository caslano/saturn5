// Copyright (c) 2016 Klemens D. Morgenstern
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_PROCESS_WINDOWS_IS_RUNNING_HPP
#define BOOST_PROCESS_WINDOWS_IS_RUNNING_HPP

#include <boost/process/detail/config.hpp>
#include <boost/process/detail/windows/child_handle.hpp>
#include <system_error>
#include <cstdlib>
#include <boost/winapi/process.hpp>

namespace boost { namespace process { namespace detail { namespace windows {

constexpr static ::boost::winapi::DWORD_ still_active = 259;


struct child_handle;

inline bool is_running(const child_handle &p, int & exit_code, std::error_code &ec) noexcept
{
    ::boost::winapi::DWORD_ code;
    //single value, not needed in the winapi.
    if (!::boost::winapi::GetExitCodeProcess(p.process_handle(), &code))
        ec = ::boost::process::detail::get_last_error();
    else
        ec.clear();

    if (code == still_active)
        return true;
    else
    {
        exit_code = code;
        return false;
    }
}

inline bool is_running(const child_handle &p, int & exit_code)
{
    std::error_code ec;
    bool b = is_running(p, exit_code, ec);
    boost::process::detail::throw_error(ec, "GetExitCodeProcess() failed in is_running");
    return b;
}

inline bool is_running(int code)
{
    return code == still_active;
}

inline int eval_exit_status(int in ) {return in;}

}}}}

#endif

/* is_running.hpp
/Enm0/kFx3i1/Punl+Wsg2v4vmuLE2xilQq+hBGOElXldHBvFLx1ah+TLJkPw4Cv6wlq73Elv2A/SZZlmIcNIWUMvizCCfx9WAEutiYqCWygSnze062Ecuvn+qqH5T/2uiOQccNLN3kLogWOC7Pe8m3zSABbq/8lyQ4xh+ytWUVvtlhXh84ekKV3mmQHAd1hk39hErMvH0MfNxX3mqP8q3s9JM6PIc4OImZgcVbQxdeR8EtH+tnh3kfop8ZxrH43pstB+N/u6roj0xWR2A0fvPlT7/CHP6KLl4OUxZ5rWjjmWUF7JrcwN9aATRLIAAW5mLM85uCzh1tEobStqaO+k2WTccFLrZTKeqL00LGj988gVf2eWvDOLNavXkDx+X316/B2JKcDI9tOfezr5Bhe73HiCbAY+Gdgrb4679OfrFo+lBFNdRzQEmhNyXmkvQHhX3+s2wtQAfZAHnsyyynfeP+Q+Sv7uCy2KoR7ucYDmvUtYUOQUg2E75H1bVisB78XOPga8CmlrMFukBpmarstf37+DtEcmb6Gm3JTgiGLEA48ztCk248Zb5PnkzPsNQKf0Xy7mSmVAHXodMd299KzHqKkasEhts6W1+9bQMobcBDoPYHBIdy9Kq1HqyDUY6Uwxh3m2XeRsxThcS/GmX1IxGzHCmlT+zSUPxeaBH57SHi8WvdfVo5Uzjw5csEo4Gf8+tTkRx6Q4ViQ2NGUwn+l7up4uWVIAlbBHffyJ0P7Bu9sHO9nW8xZ0dALlH8P1+mXNwOb9bqL3sy9kJmJ8zuA1WH0Qwbjh4HFhurw7WNlZAeni1SJfYh8eeyqi1T4OrUQ+GJjptstCuy+0UiFdJG93rRyujauuco6HbRXZR45u8Qrhz5kSQ+aePN7IQpXXv9JUfwKqShCfDt8qFbxF3iIePLkluZNFrkbvRPLQJjMyGSlucPqby0Y4jNSKeZXvk1qeF9nzn3YE2XOzUGABfPfqfY/0IddTU2FXAQ4y/7H+zmnCgiQVNVvYs9/Mqu0Sbrugx0hQmCZ8DtX/htL/xTpUkZ301ZSlYwc3sHtETOl9rkeczSzgMYY238uqt53sWHHWIwR8bAa1fRZl/UtkTlGzFIX10TQ6Z33YZuUKnQlLu821RzNC2mtY0S+85dTr9SoDa2cAmcmc2tUPNdJqq71DeqxsYKlcTtDvgecHPedP4YmpGCKR8A4wb2IL7jYJ8COeZmzUIkWLeHGmNXJyuq0j1CVToRQFOzBA10wmqH3Q3uKMJl9YpD5Ol4ZXNL/sAIjgskufTKXHeOF7h7PONJZoyk8b2Bm1uMF7WD9fIO4N3RPETcw2Jz+8Tv0qWbg+rMIqHezkcNC9XIGlSFBi9YP1rlFGAYkT4RbQVnVchumq2RKMCCrWQSFCvIjLnv+/q/hVg3HDR0t8OHTfwdXq/J6pGO+rOnZ3q5LzeI15rJivKt08d7dfxHHUrzBuDdp59wkH+HluyH06Eq8E+PdT5k3r10Ztj9qTJIxeWPcPq7EXsNZ1SPdGPT2rBU48+fPMFOG/RPRLkbCzmUkbvngw9LVCqSSzJ2t0M6Ig0z9ahLpvNreffXrxLSJLHnYxpQ0M5snt7ks3Kl7RlOdfkWn+lonQPA4SKyr4fk6PffY1odJMKeyabso9Wcd0+i5nWEDYiXw9t/ESq/k1GbDrf4gMTEutTdgkhTNR/o+WnOkF+pTOgWSkJElydZWhpmggw6h1sxvErOdWygAw4sBInmVcDHPgKtOk3wFkt+BA9pZi7cqHwNksJqmNSDFjzhreWrdAsDqPfbWKHWZ5KvJ2+KwCp0ArvCpo+7XxpPrxYVwwKWLaD37bOwbESIvzxtS5ohFBeavsLRighMWX4G56BG47e677f65ykw2OXWiu1d/z9qyc9M25VNMClQJGccvl649WLozVTevT9sXPlz9B78DuxG/ujKM0AMkaXQeFv1Gbp2PiMjDBlnDqiOGoshZrbvYnqhLQppHPj+jUNe0krB6L6cQoPurccd/vgZeeM2S2jd/FxR5+PYwkuftj66Pkvfqt013UcckIlJmEu/Hai3cFcdZxpooXqctzPlO5WK1tuRE2hiO9EAte5o1pwrCQjd1w0lLckN6kykzc5dWL92BCE1/jWH90IAxeg1+2fMPFn2fbnobxR+A5CY0AsgkZuIvEuC/LHPhmG4n0xDp/fA8h80Q970KpRlDPVqS4U+pHIqGPcXr5/f1WqrtkmRQU8kvh+ObXOffTTAvMSLOooVadUJ5s1lur2Dtwm4E1Mdonr9kG4rWFu/0XJ89mN7lF83jBApr/49oPziU5gb+euXQRvMGsmzj8zk75mSir9jxVCV0lhEf7xnGEsXjJGE4ae8Jw2T/TfOzpp+SQo2wGB833zudLuVkGkXkkbamWwXkTf/1muDe386rZacsnOu/IOJeI8weA70BA9VCv0fK05BR2e3c0FRKlas9sTjX6JfdLC1hr7hnWqSB/ucC2mvABZd7U0YvzeE6/RfU6cK+nM2z6CvQ8YB09q4P5cMeJShDA9czz9lBA0+jfQZ7NZD0TZ3dXGJsUHYRGqFT/58YuldDFirwX0S2Awns/Z0fqhZ6l92A6+BAuhD9D/aeliL4FOxKAnpXKTUibZnBjJOA98pcCD49Rlm5MPerx7hE24phMcoeqTRXSIjSS39gfcblMe/GJgu/A4ut+3n9Res0VG2br3YmPIq1aIvWT4n76vLC+v7+OoFvwetWupsaF8nO6DcSeEK7K+NWIF4xDL64PGsR3108OrB8+Kg2HWb6DuYGNiITkvoTQWUqfs6rrcxFjyoUhKHavp/N4ujFdeH4/u+XlbrnH9t2h6JvWZ1eEoavKH97cO/iE+x739jiR+7xMm/ET5Tw2wbKcGtWvVk3eTPSmpWENW279SX2PZ/J1xVxFy6Za9clvvSaf/l0KdjdyCXwIf+XZcHa/77xG78vzC+8XaZ7JqvV9xAPpdX5+GBG27Xy4HMe2d8iMOTDiEYf8qxPMAreAUWnksO/DXrfoelmwSrvNmDMD8eivcIkJ3fPbgOPSTShVqCncOiIlNXibKeNk/luyM6R707fFHUGRmzf+kQ1uROKOnlZXpwO0b5fTxzIQ7gWWAMK0Xul3NCgIif6en2aMKTxGEvK23Qf3sXkFbS/NQGGvyc3BtLNz6N/gNFf9uDKyZmsYOSVXdhxQr9IF/xvrh3wLP0mfuNrcCd8X1HmwAfhxrDRZV7bxExk3yqCZSykhOmtY5JaNJALBz5EoNjWVlH4Xl0W6PgqVIyQXLC1K8ObsIWQ2yce1hPPMdO0djvTROh6J3TOj2wQi7WThShPIi0NMHgDYeC6wIFjMKf1j2Y5aBER+XaS0Y5oQ1K9gq/S9qDAb8EG78nJdzRrWJws8C6EpbOAstt1BjVtqwWbfK/FZDbZF0RN1gL6xj8zrMoWfp/8RVJX37b/R8j/0d4vqnPJ1fI3lfuc13EvIvI0NNohJiLGdUiMAsNCtUr1fArfgH7YAbuLL+56nmqye7+pNRC9gNgltSl2/vmaUmVbYYZvcDbombxkr0l+DUtKTIGm4JB0nUCqpg6yDnTWf7nqZ/KTmqYGJjBbiDzZN8krtSvxF5NECPX95myYKSQzGI/IIC6Lrye/RMfbodTW9PjbQpy3WxxQBgc2vseS2w84JWCoE/ZIwybrM9m9WlfPh7BeVh3fAvg3XkwDWonzUFLphFugAM6jyTaJkuY/2YNKIAL1IhZg/u8cWG7+YhojJrL0DPPzEJd9IyNmCWZ6nOVaLvkWcvugXWQd88HGyro8u0DzpnzgHZQDFGBkoG51jmJQbQpCoo/eh87GrA7LHwnpYkZDgkCvuFCL8bqooj0tHsf6KurbOYejD/PpC0wOP9jaVfAPrbdb1bsXS3yg5Z1vYHn9zspVaUYz7spzLOFjIZ11P+lreIGjqE9JC9UnWNUns/0bXS32x7889lnNSZLsuJuQJrOYqi50KqqM0ydvMqoXIZhNXP+KkVnUD9iVPtW0EbXPOLgG7jIiYgn2m+fNPSV2Hk9taG8LzBbcCVlYE9oyAtQ2kCVKeE9Z/9DxvPtf3GFw3b2dwrUc7ZXXZw3gwWdXA6kujJSZe5E5CkMTL8hqMaXHd+dOHCZLkR1DdRijfjDOH5WyblGTYkm9Ubmun/86eFjG/SbIBaZic54lS3YaMC2Fjk3nK4MfliWvKKce/MFVgD/IlXL1HkPZtRDq9cDZn6nZc3uPZnjy8u1+QZOHQD9Y8ahZ53XY1VW9NSrMt8do4s2vijHBZedkZ+LtGL3IJOGTxvYfObeff7akilWAdqzyIM23ePfvi0wlJoLcY/vCPszmXl9JFGu3f0puwkpXCglMynk5AR/iKqVfobKG3+O4vdMC1gC7zA+SsPpdp2dM5WaKxOJGbQ8a6Hd8Z1wTk067poOQcug/Bqs8vUq0NoGdW0m+FkpJAjvucoTh5OCq3eBRqQSYZs680HIHak2yqYJi2RvxLeMLTOAeSq3R/geKPLOLGC9Lu1UbOX8oY/Xj0HdRBZYwqYtPudeUJ02BftBgodM7ZsU/dubt+x1D+GudanLGIR+3EGBTuNd6WBXWqS7035Oar/aqIIBr4Hf43Ne8nW6svFytK8lz52gAO955Yex3lnQuWOjYPCVoDh5V9ARjASsrrb/NqN+6lqfeNO88BVehPuFnaCbRQgnjoc3TzP5R7kZHe9nK9L+my8w9oUgm5zrL7Qp4PIpkwmiWd8DPyo8Df/DtAkHHfZVfhWSLnz/NfH5iPyLz9+WujDO9OFSV3j3InJ4GUz4NIwG+JQQr8orpHMKMv5zcPERr8S6FBQC+dKs37RZZQYU1r20DoTzLcfSQeCd6y+fmctgNPooykvWkdzF4owV9XMdiV2b3puJkO6TZXmYhcMFBKSR6kOoERfxjCNk4OhhJzUrl+f1LXg0rFiH/IyfGyTHsGxEbOYjf2V//W//hjMaVtqNNM9FDszLEmou5sdwmd0NAH7oZ3G3QI26bc+RSRcm2sPPxMQHLF/wpvQO9EVuOkLW81aQOyNf0ZO8minulGNqAGCi4ARnjq2kqprjPtY+8AhsBOfd0LAQuDsL11g4S7t9bG2wUPG2PPKPLynwZGjp+IrtI83Du4SpYbyAkQuPhvq5ZiK39eeRHSvoC/YmdGwSqZuN1l/nyq9H2MlV3KUIY2nc9yPfoiVQ0orFDkadW3emoNG2qc6n6hM7GxUaNObPkpX//e956ORoTFGv3A1Z940h7pXsDuEzgddIogrenRQgPbuB26RzsBLvrqR7tT9XQ2b6djRFidO1Hns+eJMp8FbwFgm971QhTVTw1HP2YMsTaUTFPUvT6Qak8k2s96wwxeOkrhFkQFrKjhbJMTLFa8eVqX3isqoM1nILrnKMCDKxmqq/j/xyqtGWpk6H3r0ouDFzgTe4uEqWlJXqJ8vpU74VgJXgR3Mtldjcl7btqRxcsdHS6zT5qc0AWrTvb+8J0SX+Wl1zPFc3z7e1eHWItFIeEiGSM5O/tegK9VRNihCJ9C4R4kzFC2KWbtfl2FjpNM31iCEOdptP98LyYRFKr4MnQoD37I29gRgq4iCcDAzObnJ122pYZEOyCjlht157dh0mN71lG9M58ffvXVPPBzvhN6B+OPE9qeGzC6hXYqd+mb5SfzXvC+TfEY3+apxYUndIKvgl64ilBMhx059TkoqdO8j94sPHY85fduz+l7UvD9v0ue2oRAjnjvJQnJywUJOq8s1Ja3h00e4ueAebrFi2Pm6M3BsyYIVn51wC/ZWoTbxQOE59SS1c8ZQK8uXrvlBWV1uxD5RJbhAo11C7N3GPOFHUOtbyxx/1ID+vZc+6zJPz5zGx7bw871/RVB1eE+VorEk0o1HoSmU7zLGWYlQpw+1x2/RMRzeo9k6g/ZvDpocUFUtHzq3PBIyj8CnymTD8ufk6hABl1OKIleGH7LD6i8Ywt6d7T49d3pGECXhF9+jtWZ/LftzxU9fnPJDEbnLe61e5LkSMoXh97ejE9iqbyU1i2wGI99BFMk9J3hvHn42KxT+C9xrp1Wpa1doUOK/ZgvCVjrCmR7jPamgIGrnn1sPRVi9yDbl1/H8Qzb7Je0a4uJ1PQ8BPpdurDs2OddLJSp5wM3q0oGH+g/XXIp3f9d06w1e/b+8irrrwepjIKxV+/Pj/ztXdXokrBoi7qCVXp9bSucoh2DyvcQ26RNueVGq+Dyyn1yHMoTP+2lUOW2wi+DeVpnyYrRkLL4w9hAjakdwWH2TEbds+KYtztxv1qRu0lEjcSNtM2xSSe+gybOKYefF//bJ5H0pxiRUMPT68Aci8RroUM606LdArJeZR9udP71lOOkpGMuEp9eh1Pka3uPDFnaFCmtyWxORvUEuLIRD7blczVWFV6FsK6yRnnuS5Umot9aK73XrIhYwEYK/uh1lVTwulQbrE7CfuQ2jlOTTMnvHBd8b4gYeTpY9n9bgZLvp+IvbX7Zi2fOXCUTDYnaW9fL9i74JhHevMY7B7+Vj21fbL9q90ZOBkmVvD0NePhgP/veygjAWMRB78RUYt1KEF3bH9Af6sxC5p79WH9zwHzzVHtn+uyufiKjMOwCdPgkdpnj7PNeehFstFwxFzyGk6OHMr6y/8jbv3GOODDVfuDjEuJ8JmNNF8PqfHjQVC1/JrbM4pxXRc8q7LboHKZzgULtx7uuptTbC9I1GZe/JzcVoYpCjazd//A7G5a1U/mLpqQnPXI0MeO+mfKVEDjGFaQA3NPgOl60bVt/wlvsAExbeZqx6r3Z1ofmppa0WyIVo6/CSOHMbeEkm3O4ccZfMD+7dAjK24QAn6ZcuhOawNW+s5FnEBImVuforU9G86uzxy8yx6yvP1SNGf6JHysqagMPjaud6ba9bS5eKDgQPjZ2XpgdtUd8SA6tHEXaulVEsFJ7PMIngxl9C6yygm3uHHjH4oUoqEaBm+T2uyjhUCv68sYo5RIk+zsDwHVTFU1lOqiqQqLgBiEv0xgWacwVcPDFJ7AfngQ5q6QTLvJo3WwhgtH9ksy8mdgP+LOsALewiopo5fIjVo2A1lc6KpePI/5zEnkZHSf3HY3vY+/FdJOOvUNDRl5tybkbbrq6XL4NOtePf+9ercPfuqw2FUpt5MMxciFvdv1SKOlUSt7OYgsaN8aV3kmVOEKorS5qWYserX666GVLtgzbS5pFb4ZpLNTb1vU5GHiMMxKqNB9rGSylxSXlbjz2Er3KVltPC36hELriCC8e7Zfl/NKncq2934dI1IaqP/kLXLdi2/TMrVjRYp1o9iA1uwXgVRsAXBoT7bKLZpy0wu2xfaWgJqs9EXgGebfGvqHzvk2v85X4a+aAA3RWy3Uwg0JLWY5PDJQsD9NJS8EcoNfHnxmt/ayAv3HKXp7JOAjytmDrC5/A2TmxFXj8Af/qe+unoSVvcbslUliNr6FHmjW0nh0TpJgiElO0dkzjd3LFiZ4AU1XJLuwdYtKO4RWxOLerLr0erxDa1KY+G4K595R4B0QuVhel6zQ5H36bECgxDdaYLbgrqJkV9C40R0YYAjO1CkE+4hv/32bdOYB93FCm79cgBmtR6pNk3VB007KQAnwXePillD0TGrA2aDr
*/