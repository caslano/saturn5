// Copyright (c) 2006, 2007 Julio M. Merino Vidal
// Copyright (c) 2008 Ilya Sokolov, Boris Schaeling
// Copyright (c) 2009 Boris Schaeling
// Copyright (c) 2010 Felipe Tanus, Boris Schaeling
// Copyright (c) 2011, 2012 Jeff Flinn, Boris Schaeling
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_PROCESS_WINDOWS_SHELL_PATH_HPP
#define BOOST_PROCESS_WINDOWS_SHELL_PATH_HPP

#include <boost/process/detail/config.hpp>
#include <system_error>
#include <boost/filesystem/path.hpp>
#include <boost/winapi/basic_types.hpp>
#include <boost/winapi/get_system_directory.hpp>

namespace boost { namespace process { namespace detail { namespace windows {

inline boost::filesystem::path shell_path()
{
    ::boost::winapi::WCHAR_ sysdir[260];
    unsigned int size = ::boost::winapi::get_system_directory(sysdir, sizeof(sysdir));
    if (!size)
        throw_last_error("GetSystemDirectory() failed");

    boost::filesystem::path p = sysdir;
    return p / "cmd.exe";
}

inline boost::filesystem::path shell_path(std::error_code &ec) noexcept
{

    ::boost::winapi::WCHAR_ sysdir[260];
    unsigned int size = ::boost::winapi::get_system_directory(sysdir, sizeof(sysdir));
    boost::filesystem::path p;
    if (!size)
        ec = std::error_code(
                ::boost::winapi::GetLastError(),
                std::system_category());
    else
    {
        ec.clear();
        p = sysdir;
        p /= "cmd.exe";
    }
    return p;
}

}}}}

#endif

/* shell_path.hpp
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
*/