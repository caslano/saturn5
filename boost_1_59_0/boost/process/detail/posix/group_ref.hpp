// Copyright (c) 2016 Klemens D. Morgenstern
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_PROCESS_DETAIL_POSIX_GROUP_REF_HPP_
#define BOOST_PROCESS_DETAIL_POSIX_GROUP_REF_HPP_

#include <boost/process/detail/config.hpp>
#include <boost/process/detail/posix/group_handle.hpp>
#include <boost/process/detail/posix/handler.hpp>
#include <unistd.h>


namespace boost { namespace process {

namespace detail { namespace posix {



struct group_ref : handler_base_ext
{
    group_handle & grp;


    explicit group_ref(group_handle & g) :
                grp(g)
    {}

    template <class Executor>
    void on_exec_setup(Executor&) const
    {
        if (grp.grp == -1)
            ::setpgid(0, 0);
        else
            ::setpgid(0, grp.grp);
    }

    template <class Executor>
    void on_success(Executor& exec) const
    {
        if (grp.grp == -1)
            grp.grp = exec.pid;

    }

};

}}}}


#endif /* BOOST_PROCESS_DETAIL_POSIX_GROUP_REF_HPP_ */

/* group_ref.hpp
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
*/