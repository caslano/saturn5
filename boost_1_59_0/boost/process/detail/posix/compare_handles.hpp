// Copyright (c) 2016 Klemens D. Morgenstern
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_PROCESS_DETAIL_POSIX_COMPARE_HANDLES_HPP_
#define BOOST_PROCESS_DETAIL_POSIX_COMPARE_HANDLES_HPP_


#include <boost/process/detail/config.hpp>
#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>

namespace boost { namespace process { namespace detail { namespace posix {


inline bool compare_handles(int lhs, int rhs)
{

    if ((lhs == -1) || (rhs == -1))
        return false;

    if (lhs == rhs)
        return true;

    struct stat stat1, stat2;
    if(fstat(lhs, &stat1) < 0) ::boost::process::detail::throw_last_error("fstat() failed");
    if(fstat(rhs, &stat2) < 0) ::boost::process::detail::throw_last_error("fstat() failed");
    
    return (stat1.st_dev == stat2.st_dev) && (stat1.st_ino == stat2.st_ino);   
}





}}}}



#endif /* BOOST_PROCESS_DETAIL_POSIX_COMPARE_HANDLES_HPP_ */

/* compare_handles.hpp
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
*/