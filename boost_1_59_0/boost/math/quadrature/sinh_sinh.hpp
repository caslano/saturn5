// Copyright Nick Thompson, 2017
// Use, modification and distribution are subject to the
// Boost Software License, Version 1.0.
// (See accompanying file LICENSE_1_0.txt
// or copy at http://www.boost.org/LICENSE_1_0.txt)

/*
 * This class performs sinh-sinh quadrature over the entire real line.
 *
 * References:
 *
 * 1) Tanaka, Ken'ichiro, et al. "Function classes for double exponential integration formulas." Numerische Mathematik 111.4 (2009): 631-655.
 */

#ifndef BOOST_MATH_QUADRATURE_SINH_SINH_HPP
#define BOOST_MATH_QUADRATURE_SINH_SINH_HPP

#include <cmath>
#include <limits>
#include <memory>
#include <boost/math/quadrature/detail/sinh_sinh_detail.hpp>

namespace boost{ namespace math{ namespace quadrature {

template<class Real, class Policy = boost::math::policies::policy<> >
class sinh_sinh
{
public:
    sinh_sinh(size_t max_refinements = 9)
        : m_imp(std::make_shared<detail::sinh_sinh_detail<Real, Policy> >(max_refinements)) {}

    template<class F>
    auto integrate(const F f, Real tol = boost::math::tools::root_epsilon<Real>(), Real* error = nullptr, Real* L1 = nullptr, std::size_t* levels = nullptr)->decltype(std::declval<F>()(std::declval<Real>())) const
    {
        return m_imp->integrate(f, tol, error, L1, levels);
    }

private:
    std::shared_ptr<detail::sinh_sinh_detail<Real, Policy>> m_imp;
};

}}}
#endif

/* sinh_sinh.hpp
c6s4DVz8aSQaNFmK1MtlOYetBE4r644YF+FhZrEJhc7oruuVM1iHTJg+BzoYyFCN6yVjMaK1BvZ6+z/IjKbq3XkyaqC5fLcDw6+VbVWMLY/eRUI0Fy1z7OLiUI2gq7To+igfReucGbj+N+1dgPryk4tXFpEMieh4mCvjBS/H2TQMotgIG37qlacxOu3/JFxlQr/8fmf/2QkM439c+VgTVYDdzIBPoRA3uBM2IZlGQdzsPmVKc9qgTpy/XkX+1ucQn7vs7T9KYrQ3vr1cr3/fSTLE0e0Usk/fFjNxSiYBUbZ+b75M3tKdmoPZU35X5SlpmMrBpT+bFF/ZMIdrcv7vdQ8sco/zMc36eVqmPGmS1uI+1vocq05vQvsdxQ0sf3uUrSDCKIE3tpLuDbt5RzFoi9OcTHDcNqdDBTkhzoMysludggjdHImeXtWyovFqdMMe6hAQKhqe+neISM+Ocfp8qnPlaXt0z69jDpKkfzQ+8kopkDP5d6lLLscyvMquvrUBA+vJGPGIX0gm6YUR21zGwtT1bK9elk4JDeWtWZPFufqUdfcH0YIr9yxQUeJPsLHzElje2WX2CS/+RUpSBzT3qaH8rjSKpLfmu6Refdk0/SxC9j48xaw5oZhUsDbjuf9oErLyTc1sZwt25JiMcbx9xV/OqYF1fcJYmNhbBPVkcAtU3Yj1MP2p5ggJVNLK9TQ8IuRbgrthYNFjuvvLPtTruNjFt5id9RhOdR6/q9Gi1g63qq94+uJkEJEyVrrij6TPjXb5xmT+ooe7KUrQkETonvokrUjTLrFm7gHaRHwKfrRqj5xKqvz+57l1BEzjlFC2iExEKwqZ6V0CHSVYlwRIc8ZAwyLMXe/8/a/2LQf87ROrR0NtS/7P+8oNGBSi/GWZiU/TURmbRv11/KxRVcqKjtZKKlgkST0p+YTvDGfo0vlRD+4GbJTI/uFKc88Ku+S4rspd7KBWC5t3TGwQy6LsfhiZX8SSS7JcYZ6RUP2jw2cKGONWfuXDQ87OpkhGBM+ldqclDYd/hui0Ecw1RBBTNuFXG3K5wKk5mTJDNrdsHvZG+su3CGbNV35gn/QllroJVg5Fg8mVGzPTqgmpSzOkmlBJiqNqqyzSBncxNdEGGNPkmMbIup+/jtf8GczjYopH0VSFHKFsVrzUnT83IQ2ukRIy3QnNkU+7VqiamLDeATf8DANPMMzNSPhOp2Aut3+ABnODJx2cj8aP4TE5IX6jYPzZO1k+DpUShkopPBUPeSTEDYCgAZQc/uR1V+v2+QOwK86j++uik6rmA3AyTKsrAtGondIo3jMDn+y4pWJ125lOHRxJj6kpD7Yva+zQDkOj+yheusKghrlc5lNSh8qlzdnCqVqpSWp0He7DRhBxApc26LBJKiXJjHwTpHLwHXzaQeDrbir+crtwWva81GIGZcWKKT/6i9H8WJpSzKBOMJ8xv1GuKOvVy2ZSvCWddB+5mPK3vxnLKw4lQQ1sj62iJkYoKXC6WIWytKRxzTn2WAF3SGRN6dYYlMBBjlODoMHZV4Lf47I8oTuq7n9660Po86VVmoXn85Cj/gMnsTi2J6Tzff76ilMaJeSo0IiXg5oxpLZXkopfwwD4vq4GdY3dCSrXWQSZ/xwxgimcGsIW0lsjvojKYFj9nEJBHIB+qVb0lEVwazuZLstEJ8glzhag2cSHM2baAgN6crTjBIo84PMjuO0cSJhxeAPMsxRYbIiVMVwPI7uVS3M7KNEdUsByd0A+5MFK66CgYFrkOGUhxh3fRGqAR7t0ZgciBc/jquSlNoYJJzTDzrLgJNnL68UuokPM3H1oxID0tju8Dku7zEyGKSvJPF9Xmmohi02/CUrt/RqUVA9B8c0dSKbpTItUyXcJltCHOjclkB7/8K/iwb02B9SxA1zWkS5nou3ag137mW8abAl1DZTjNpEr5PiDCjryC/YteC0HP9XlXKlcC+jEcDVAM0NA/Z8BIHMKX+dmSiMWbdWQepACvtzxyiDLL6rzuO5b6hu7ICFJiP+2b+rss0YYHZsnizG/OqCOqGwFku6GCECfpv8gkHJFwn+w1lzVQd8e61tXm5ViHJ1tmMAnvIlJlzXZYHD7sgNim7Yc75Ry7pm9GiIGfXNO88PpeBdI99f1iEMepnx9L4vplOfjtRrarbEoHV/WPyIn/YM5Tu/9YQPIxt1kV3f0WiL5618KqGov4g6lI/8pcKpfDqSWwAY7+1/3zVHubImMpL9G06it+qj8/Y0V1Q9xb1Gd/PMzJw2V813/61f809T0/yM/Ltj0eMAtTt//ixFplrcDJO0b0nMVhK3cERSGditntFgdKs7w/6+j7tm13/16G+JXW9Y3Eb8mwcLm3xpK8b4qTdKbgEVg2Fz3rwLSuO6vwjPktf4doUKb8j+yEF+/P+nl2YGLN6nJnh1Pb5Hln+of/LeYSM/TYKl08mampf0VinZtdn7TsLUfQ6dWc+yMGbNm17Q7ddKicfvtNAnZnjNdPqu1A8VS+hupCBibX/Yg2rPiZApjHT5pvxfER9QQvgeiyXzTcwUgDnKDmGOAzeprp6SmBcJqpra/q0Xju20jxtNw8Mtmfi29dTtyK+mOkpaRXb+wgYj2i5Dx6UtrkLLS13f1Cgnw/OiDzEj6y8gdfC2NVl9oGaPGVo1Gl1MneUoSaTfQpwmxN5RkhRIFsz0IClnbrxk05fSjpIKteTbjctg/BUdkH0Y0nNKzsrNMzjWzSNuCgyPcxgRxlX19bIPYfqwG25bebMGv+DLcpXsOT3qp3XwcUzAQ+VSf6cEnVxzK4xiPJmH9UhKRIqYcRdsOQETb3OVEM/xZzuCH9FDM9E19En0N0fYwVjuwbFxmKPdaJApX2vRMFxISqX+R3Ti4w4c2luxvXI/e/Xp6tNjPqrwHxiEFRvNBuuz1Hd3agOiC3BM2/IxKbNMUh1oeRYrQjD5L3mQUM2u1KrThswXul4Sc8LoYYYSYDUlKjr0KGHgaLXS9sz968FJ7pnkDnyJFsNYaJSMpk8ZHHRKa1TXekhhZcmNVR9OO1RDHnf3MKmpx3nHLo3n/5rPRa9XRxlk+v7Z6LYmHwJ7TLaKJJnw7PnQqbut/XOHgNiqJ8rs1/juJM70/O+iw+Jd83TyaLIs04ublSZFdMTbUdhvQ3idYPEDfovzU0BWhWr19pDu+4z/LRJRa8tyBz/KryqmEx37iKuAnLUnDaMRnVVB/TQM3pQylgYedPHe1D39TaoE2NtX+iI4pIoX2L2aIQw11VIfst0zcA61vW6RhcpEXzaK9YNYfKLKv9yM6fl/4R0WExtp/rD/W6a8LcUL1iHl0hUBlAwt83jntwhw07mCmXVo9ewagMP/TnYo2ciIHX1Rj/Zx03zPCDb+z68RQrgE0n/GfsiRRyWP+CYPZKKxlGVrUfFHSkYZfUbDYcqxBhFVOu5ANhcpax/i9o6kYDNYi2t9ZsydEY+MVdnixX+GQEIQh+qMMfztuHrrsMbpUHyPN5l7mlYytPLdXrlg4yYWTFHOiFFb1BrYMrywJ+QoOg+Eawy5SOhPsKwlzT1st3A2l/c0PxbMIIj/KqN32nf+sHqKmsSjcoPy2Utmg8AsyIh5kOoAVQ7uZnpeJefYrlwOQgV5HCiqVMzIO6frZIKxQ2SS9v2VWgQF4XOr25DSbt8tABsgqrWLYPSlcNArfEeTZZPK2X2v9qGWa3Iey7qnYfR4B2Zvt3AUFXs0JGh345bhiVcVjjHzo+nI1ZEJvSQLv9KmfgdNn6f06kmFEP8mlOvgrx2i2kF+kJam7SUFp5je6sFyjU8EbHMlvn/CAtY512GeUA4Z10n9bToNh4vprq7y7ZG0e40Nh2UequtHVxwoF/Ec6zlsLFhSebbSboZ03gfrnuYHR8lcXWCX6KAsirc6/9YRrkhzxnIO+q4tyjeOx6pJuY6cREmlcOJNpMXDYfCulR5ClmcEkmHDIR7iAi68o0QcM8mDAJEQfZiCAcCs7isr7uN1hzovwF5cNlMfvU7TbhuS7N0zDeR/7Kr2kxwZtqlf+EBiwIE5RRCJxpk2LX/yXlnsP8vwm7b+ztL1+GCOxFzd5u6oTjcXkGKJ2TWvdZUzHGSx1xlNjwh1BuMUrOI+Tq7Xrrj54XwabxO+3WyuO3tKB17ttCBtxko++IRxpvIaFk2p7qS1J5xtzIOua6iUusFcSYAYexNE1hDWoEN8+y0EEYHJOR+wa2OC2SFese7FaQzJlS1udv5QVh48TtCWxGElmSWbWhjA89xT4TAqAg1zpyHkBav/LZJtros1ebhlGC4eKChmfHVOsIiHUNL7A6V1P/qxWJfl5024htRr1Xtw7ojTYaDJHG4Fmqv+X671RJwp+vrEcm6X+MkVkDNymgEvG19JKvDsfO1ZHzVMAMQUTOStySGhkFIIdiZqEzDH1URNjGnZykNYqiQxDR+LHoWvOpxLIq4caRuRjfAi8x0v2IPpYEy7ZAW8xFc0r1i6K4ivWnQkcDyvRof7+Dum9Yrob0r4xneAvCXl5W2YGEy1KH2k1k0Hn459oSEQzObgtHbDyYAEPxnYMGoWJrJySzFRhltun60dgqna13DNQx9tPMa1BM/tG5SKsTJWQHg+Q40scYOnTgjzSBwuvsDcyfZz4NBgRUfKAmLYDZk/jLaK4UfmqJUidX8kzjOJfQBuBS/BV44vGrikwn+YbuL92cS8wlB+sTY3/mtLhrQ1ui6IreAc21rKL0ZPIZ3OXm5Q1OAcOT5vxUhDlGeozeViafw0dI4+0D/cWXhG4M8qn430VDOTuPbNfYFNyF4rvhzMhpmwwG1JlhW+hMmqtQhfF+eA880tsAmcwRYEMmyqhqDjd4O8e4/TXdvAzIdNP3GFKA8riXJPWI0ZbIYtRWiglU/LXHALmRMeK8eRkCrmR14mXpiBLnM5y/bW/X0zpz268QogoELYW0R3pbGcYovBuuWPolgra57HVoJWlZDlsBSbXhkf/mT8m6bMfARC1xCNFXDk39d/WIQC7rpw/fGc0rxyeZMG5LiTS5sgFznumxKXYJ/7L02pVOXVC6lqMVgFyq0PuS7l9LQbKFDqIs6XG+mf3lgo4oLUEaj514Th0Vi0F9aSVHQJ+XxuHpTz2XEEPbbEzzKLcxcN+yvU5MDduRZQwsWgILH1vY2O5Wnm4p3FIA86+Gj+D1fzrLDtdLNWnunMOb17HozT5Rb+1Zj1YNLA/rWl/HmzzcAk8RVr24PxbLhYyE9jQwHTotGyFDtSs2LUdOlu2bdp16m/euJ3+lYhrQWjF+3nPfzn/kf8k/IjK5ZUV2rQjp6q1SbNO/WqAX+7aVoz4XBqNn1Hs0xrDNBi++iv/PTVg/QBAYGAg4UCB7X9PMyHpQRARIgQzCAX6+VHwJgIHB+z7wu4UMxEVA0IYJgoJDQvS7if0/Bv2/xha6x8BPusmLyfihAo4iW2qxDYMdo63QzynkHFGi2g0Gpy3ejJ3NQhixks0CSMdiB5ykWjLUUi3gKSSFzDhz7ljHbZguJGsATYjQzRLG/OjRrQQ0J6OeB5T+aeqm1mM86bvJl4BftTpgWsusLlwYFk8oABLt4ZLR13MYL+wxK+sfhKVAJ3FevpEJtxiBHw9wAfmLKKGysAsHVQwixGfkeqYYQrSLOTZ64a/lUni2vVQODDbgxIUcs2u/7IKvJqFx8BP9aRm6wqrkpAFrG2rtDtETzKyFECrmzocADsrS8jKcgzVdPiSNaaIGmEctJRetW1FxwNZaBrJrZbAdFrLmuSHgUzleYvrUXd6spZV97F3I/U5RGCEwhZJACyZTwFAahB2XHzUFBakNNCVojZ1lI8vuJs8aO3vq5+HGJ/3vxmtPOP9v7xJoqHodQ0x2Ykc5dPEnC0UtkmK81+AkICUUeSrb82z9W+nsAAWnMTsCUkPjE+wbywC6Jyy6A3v3PvqfQsT67W7k8WGOAkj5mSmqURtMwJn+fJ633D9lrJxi73S9HQ9m+yy+KRb+hoBCS42y1W4LcrSm8fvw6NmmmS3qoHHg3qneHJyuQ/Zq+FR2TlspkzruqEl4ekwpe3mP0f5o3ztx8tuKhzMa4IWPk/qRp0mrw0M8jaInwAHLPjTGuN6j5iu8tWCj7hI3KCGwcpQk7ds+DsgRhnEDeV+jAi++I+Al7QRbcoZdt2NZ7eQRdHpGGcMGSYIXShhH0oGErH77CJriYMrijbPw7FvIrnYB+X3pJQ/53gW+pQHqyFGslt3/hw/JjM0E/FJn2aF2WhpeaAIMQipHtg4k/iuz1Er71o7noif2WWn1rqUftp+oAsFR76+z+/tgMKjHC3Sqahf0QC0SR4Ouis6XZH324Mvf6XQMf7tsNHNWvzG5K0fpTN4whgo3vnpd5CGcib7A7VBLjiJPbl/S1b0A4I5GNX57k++XtFJGii5d3Z6BFoesUrGlyHQBskspXvPSoj8PVXbIT4VPfQA9IvwTmvy5uDrANjp0vxFVGubb0ZZz8CSw7P7hHroXuCjvIQxpEQf9/NyvCaCua2JbCZRKNDjxmYnkS0jP+GLVrJWy0cq3XUtb+/C/C5LfI8AyOdvx9srxCnzd536p2gvubjMLSspXZ1xjLcHr6XAP1K3E8WaFqooQzWbEyorYtM45k87fE4TBWGsB/XvmEzOOejTiMenrNE8UqekTH1b9qRwpviJcYKfCoe1+GerSzSYsiwmbY+lcJbfxsxlGj0up8xRiEWwj1fvwGUHIgQglcBJTD+FDDqsgffDMEDHuI8PEvfZosLshezlNkh7Y0vr6KfgsVCGjCi3SJ/0L8aBGoiGMgmDtXBoIZtR2c2pU3DFN1lJzOFwuKwMQDWuRw8hZeyFY+W8ceLuT7BwVKmrJs1dB9muzFY0E9bYWtaZZu9UaUDDalYnLtboPTuyqw7zboBu7Eyl9m1sqHmtY0tJA+MIJhs+3Optk9uSJukAm7NJSwyc5N9lGtOXd43u/D0O0w966jUFv753oqHrA40o6VaZGM/UCaOCVm3jwbEGO5YcICEPzpoIVzkDwXPGPjzIDV+CIoIO0QaVEhzAFYFenjA7Fbmeh1GLHIs5tDpASuG1oAa72Np27bUKq8aHv96ga/HYAmqx6G3yNeeVIbuRraIhYBXyYfSiBtaJAHUo6JYBhStQ9loiH1NKxrtunMiCaNCajz1BgocjNMTVTecHdkK0j3EhyLypY3xV6HeVGxBFnFG0Kgvuz0lCPGoAldWkW1Ut+Y8NeN11LpcuadCy8LgY0OcpT4DZVOVszvHBUEAMURYtZHI6wWHvyIt8zUH6T9nuU0un+15+k0wrfQ1/1GM62H5rrTvKI4XcPBn9sIhsIYtDp8HUWdpfvxH1MRv/bPFTAist6ZQWMqlEsl7dgVbFB0lOVXksEEw7Y/ncATzZzDap13d/noXa7lf/Jk2KHniGaB3TXJAGOwh/Lw+TqC6zSdAraUoByA/2AGSeN7TQDUEdP3xhSX9IFGUM86kg0LbKEcMeZVdFGRjQ1lfmTjYeGIuXMEuI9Lb+LpDPQbCEdaMDM+xfCpjMVTd7A63E7NhWHRz5a/Lp5cuUsiB0vZqZq+j9SmoOUNfpdxRFWjEzsKHz+I7LrLX08+2ui4Dv4I3FloacUCRY
*/