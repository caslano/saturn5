// Copyright Nick Thompson, 2021
// Use, modification and distribution are subject to the
// Boost Software License, Version 1.0.
// (See accompanying file LICENSE_1_0.txt
// or copy at http://www.boost.org/LICENSE_1_0.txt)

// This implements bilinear interpolation on a uniform grid.
// If dx and dy are both positive, then the (x,y) = (x0, y0) is associated with data index 0 (herein referred to as f[0])
// The point (x0 + dx, y0) is associated with f[1], and (x0 + i*dx, y0) is associated with f[i],
// i.e., we are assuming traditional C row major order.
// The y coordinate increases *downward*, as is traditional in 2D computer graphics.
// This is *not* how people generally think in numerical analysis (although it *is* how they lay out matrices).
// Providing the capability of a grid rotation is too expensive and not ergonomic; you'll need to perform any rotations at the call level.

// For clarity, the value f(x0 + i*dx, y0 + j*dy) must be stored in the f[j*cols + i] position.

#ifndef BOOST_MATH_INTERPOLATORS_BILINEAR_UNIFORM_HPP
#define BOOST_MATH_INTERPOLATORS_BILINEAR_UNIFORM_HPP

#include <utility>
#include <memory>
#include <boost/math/interpolators/detail/bilinear_uniform_detail.hpp>

namespace boost::math::interpolators {

template <class RandomAccessContainer>
class bilinear_uniform
{
public:
    using Real = typename RandomAccessContainer::value_type;
    using Z = typename RandomAccessContainer::size_type;

    bilinear_uniform(RandomAccessContainer && fieldData, Z rows, Z cols, Real dx = 1, Real dy = 1, Real x0 = 0, Real y0 = 0)
    : m_imp(std::make_shared<detail::bilinear_uniform_imp<RandomAccessContainer>>(std::move(fieldData), rows, cols, dx, dy, x0, y0))
    {
    }

    Real operator()(Real x, Real y) const
    {
        return m_imp->operator()(x,y);
    }


    friend std::ostream& operator<<(std::ostream& out, bilinear_uniform<RandomAccessContainer> const & bu) {
        out << *bu.m_imp;
        return out;
    }

private:
    std::shared_ptr<detail::bilinear_uniform_imp<RandomAccessContainer>> m_imp;
};

}
#endif

/* bilinear_uniform.hpp
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
*/