//  (C) Copyright Matt Borland 2021.
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_MATH_CCMATH_MODF_HPP
#define BOOST_MATH_CCMATH_MODF_HPP

#include <cmath>
#include <limits>
#include <type_traits>
#include <boost/math/tools/is_constant_evaluated.hpp>
#include <boost/math/ccmath/abs.hpp>
#include <boost/math/ccmath/isinf.hpp>
#include <boost/math/ccmath/isnan.hpp>
#include <boost/math/ccmath/trunc.hpp>

namespace boost::math::ccmath {

namespace detail {

template <typename Real>
inline constexpr Real modf_error_impl(Real x, Real* iptr)
{
    *iptr = x;
    return boost::math::ccmath::abs(x) == Real(0) ? x :
           x > Real(0) ? Real(0) : -Real(0);
}

template <typename Real>
inline constexpr Real modf_nan_impl(Real x, Real* iptr)
{
    *iptr = x;
    return x;
}

template <typename Real>
inline constexpr Real modf_impl(Real x, Real* iptr)
{
    *iptr = boost::math::ccmath::trunc(x);
    return (x - *iptr);
}

} // Namespace detail

template <typename Real>
inline constexpr Real modf(Real x, Real* iptr)
{
    if(BOOST_MATH_IS_CONSTANT_EVALUATED(x))
    {
        return boost::math::ccmath::abs(x) == Real(0) ? detail::modf_error_impl(x, iptr) :
               boost::math::ccmath::isinf(x) ? detail::modf_error_impl(x, iptr) :
               boost::math::ccmath::isnan(x) ? detail::modf_nan_impl(x, iptr) :
               boost::math::ccmath::detail::modf_impl(x, iptr);
    }
    else
    {
        using std::modf;
        return modf(x, iptr);
    }
}

inline constexpr float modff(float x, float* iptr)
{
    return boost::math::ccmath::modf(x, iptr);
}

#ifndef BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS
inline constexpr long double modfl(long double x, long double* iptr)
{
    return boost::math::ccmath::modf(x, iptr);
}
#endif

} // Namespaces

#endif // BOOST_MATH_CCMATH_MODF_HPP

/* modf.hpp
Auu1fFcjpeg5RABR5z34alE7f7Orcsvd7XKf4E9M9Yk3eMP0+HdU59mPB3bCz2Xh7lQ5sjNEEvrKHYfTfSqJHsw626aRBB9KbS5c2wfgGHQNsoaRmHUn8lt3NCsLqstR3Mao/NlpaMJWI7tn8xa+TnivVNpH7u+J1qb0y5CaqlH4FZddninpIK2hKDtCai396/ZmZD/xlUQSfm3Vj7ndGxyi8nbCOmpZ8Hyx1T6KCMfcALeG+Xb32UQuD2POdbLDr4E/4KLNw3mFDP18W0TXR3TrCys9PD5vHP2Kx97CyT2xT2YKZqVJNZkDvtbv1gwiyvd4EgyReE8Ajkze+vhX2wAYpvmfQY0M/CBdrvtzutqftRObD3y3E4JOwnYRifBS5x5y2LRpWXJDtELrOsOvQT9XK14R8tOwZHVbGGxHZXMb9RGpY2kEPYq+/tObnsmq2n4EFw3aORK9mk2LtjQtMoYvswfF5LraGOl7iyTDN1X08ViLS+s7XLwl8UMIZt0liC2Xw9FoVnU6qgaWPSwKZOPcCD4dlA2ZckGLJzBGkWW1ksnbSHaGqVvkmXucBhrOrA3h9c5DIqH3F1rqeN3dhk+1FXW4brpXIeq3/gmlRUuLC46ihmmGj3WmoIY1HwcVl1+SUuPPJVSOuY+zbgNLJ4RcvifFsQLV6eUdHASuuo5ny55aLkAOysb0fLTdsjHMCicijgSinvJ8w7KmwpIfx1/HKMrRCsuJM67Kr9u4ovlgh9VOOqro66O1fQwNNwJACtOIPAa7zqgcA9WXo4hLo5vScSs8SMJ+Vw9615XxrbJVcSTwFmxtgKrhfO1fkaMC+CgaknU939W1Tb0sm6bF0jv9zgN9xTmHkN9knH2jS2dxq/Ag2a9guopra9q98Mo4XfV0jJM3/ChNcpUz4zjWO9kIRDRd2mZ6E28a2W+lTrlcu+GO0cTP8ZDGzb9fmeP7SIjaJmQnSY4VI9Z5bKnLMPWYzhx60wM5sYVfIy9LEZrg/V/vHH9rRMt8sqaH/CGk+17tAIvdasv+5OV+m5OHWtqfc/sNX4lGVQ/sF0qNLGD6nbAZ5YheOtTXHPK9KlE56m6QmNlSrnhw23B0ERUSN2o7+YBm3RT37iayOZcUYVoltSnx9xK5Av7QAgKk9/e/zMFjOsaPTsUTqa9f7LGMceBgE8VAx+e3x26E57WLi39Xfprm/0yiTaxqC1usEgWIlJC9rpsHX27muL800ja9bUvyjZn3EkqfZYzTTX4fz/v9MD/u9rGmY4RKgSUl6X5YphF6lcs96aBYduEjZDfxEkfSPId8dFNts9tuPMPqQ4FHJ7Hfio1CZ5s2e77jOapUsInoW/eXLPQlX7WSk+7MNWrgHXtT2nVlDpbnkTYQKnTuFaot8kYhQTuH1tC3GYoZAFkFvjZFkW9JYbDJ9Y3dj0d6hOwRSHKb6a76j7+8fWVzjTcsp1+SczezqPDA+Pn2PZasTbtqbmYanepVOnphT8f8P8Q+IAXIO10WZpxGxQX7Y2l9xYeer774z3Xio80h8XibZuYZovn5XtOP8KSWEEW7+dbhLas7kCk8Vn1PC6PIpKS0hFqPffqGzY4jnVVAfZ0UQni2HxNOaFT6f+eczm/woPf4/9HPm3qIn7d9cBIuGZGrSPHH5BtYW6xUuEnCTnx8Q1UgixJw9bol91J+DwGl6/dQv4LRxzFdnuQRVD4xej3zlE+PHuvG8JW37ixTMvPdtLWRaaekl3s1zpxW99Oj62HAgvf1erI2XyLPXW+6svFcK/VzK1ILQrKmkCThlkw9l3pf7y7zk2GZRvgktrQ/07tfFvbhPC1Uf7+6qUKU2vWmjkttty9Da+9fYt++8s9UiTEN2N5457BvKpz+uZ9/WWKXeMvG6efYpeiG93o8legel77BYFO13x3evc67G2J+yiWzG7nza9rLZezeh0veTo2XVVsUDKNFSSkllAYpSUkBaRhBulOkW0BS6ZpBQqSkO0a6u3NopLskhu6OIaa+9/yDc7ef/ez7vVbu1YkzVdcDFfYYDJD7yaN5aWvhZrxFmm9kVjbIqFPa9SP/CKPzsB7NimfVMc0LzYjilrLDQ3gxHyGvdx1QDNZRRdRVLJyeo2aNSru68xle1iJI9KAdnYreJn8cYdONIf7pqW4zOM9OXvZVlb+GVbjBWPF177ktRV5JntLqJTvks7o3VRdeGkjY+pr6ZUyTd0BnSnKgqEd03kLdJ29WnDyCvI0GLp6dWfZpm47chcquP9+o49zKOaMxuHjf3BmYuTRLKZk+pH79OqTU8F7MUM9q5d0+hdLu3HeA6A0Wn8ZG4dL0zFNjKVt5FdfKa4gf2taDhXt18PjUeIjm7ZRDskddRWGa6AP7BiqokfXgBQmfHvSXJTNb4/DvRcF2hW+jc3fLw+fC5nEiMPhCd43gckOGk11qPQXlso/Z9Init+UcasQBYqUDnlrtqU++Pomxn5AzaXAB0CbIhSYpMQUtLgSWDMRYkZxs3qIe7S42kWtOubbx/A26CuZxJAW5Iu/qCWCnXPi4+zMx3tfpbU+c3w8yVKAPPPr7lKbDVU8FlxwGmCTPxF1s6KKc4xrVe90P/9nx31XeXWvXFPoGB2igH5k6k7iIeD9q9ApxLdYslo7VjMLvsLt+E2t25lmkQarZy4YT3aKcDXQC3hquJpjf5PFIKINnjIoCncSo0oKjJpS5HoIMXFr6btKPcmS8xnT/HtCit3aYuzVtPy+YG+NEGCcGig9K4rBkvpx+68mj2tnLQ/FtvSPFv76OZCPRlA6sAA02Y44sk1heZWl3pbQtqCiZtlCiDAkfHxI4+8S1GzHUX38Sd+ZcjXKmIyvbt5506D8RFzAfqWS0oOdNuU1wlx0ZxHcfcs0bfmvGFg15sF1um/A3RVl1jPzFgQ8A41yucK9f6IccBxHP/XtjqFnwLJvFmE31DDwQEKKRUXfTkmhsZzfGYdTGsXrpGLC3zTaV71dG1JnbMF7qZPFLg4SSTMLElGAVtwB7ks5Yfes/xZtVVaXkqgjVFeZu+KrmrWY/uzzyd4vjC0eqjV/rec+mz5Hn8Td4ccPVZy8u7xkUTTKDyCOs5SgEhJI3AYPXdpWTc3z2mVPHrtYqzhf1CpEzOzifDGQemigDvJ9iSJqTthayjTtN1uPau9sj3pJkFa0toT5DOHrxu6VT+lYHZA1CYA2NhSbOHmlZgexUGvVSdB0yGgzzWa+0FhTtn0YatpvYdFcdjfv8tq+8xahlzr6submupn3dcUwcWTv97uO3IagReCFDwjPWcHP+su/+2sYjVwzqUiKfxjh9sZ/V9Sj8ZCr4ExKSfkmW+iqFcm42hZa0pxZXHWPc0a6mmx9wgKqGWx2eMt3e7gH2MUUNDEELWqi5sweu5IWvnSTdP1bp4VPAFXtUFyPGUORlN+SPGA0jPnrq89EJJv5o7vdkyVi4mdbtIl/1VvyqF+YUbClAdod4QP8P1wiVrpmZtE3jr0oMkWlbRyEOpbXlgC/mPBpfO++iD7pVmdw+X1Fv+H89oaaKXVkHLcXJHNdN4lLT1qkJ8wv/jvmVGiknoiqnL6GZqShj/oXBtc9vjW1XHVporZqWyVsCULFbjP5Tkp9ZflwzM++1fHLA86bDqTtHj1yn2ZQsbxraa4fb3RmMF6qxDRru+jvY2v8n10Dv4FrSn3OGyBbYbl6T+EcBh5e1Kqeu6+W2hUfJLXZkwBlhKwohDz5aPj66QbkqneyPvnmOs5RH5GOYg2UtXKG58Ql0/y+oxSmiuUqCcCLpuKDOFbNd6el6K/TxJFWR51JjCLWPGSCiK9oBMnIQfbF8oL+qeODGW3ewdjZH0FJjfz2G6RUIbxPPeBb4qtQ0OrMhbXVjJKjC3VDpmbHBKTAlZa5Ne3fqeSPe6boLUjks3u8PnXdP56/bicH6uXH/A7+xIL71TrfXdN1nMjX/Qvh4pdejB2NRCpqi2NCO1aELh9vjLQ/nm8t1FSHmexgdWbBF0D5ni6OioP+yaC8ar7Wlc/znLH0FLczVxTxiCF2tDnBGRDR8s23sf8vkXsFAa5f8zlG48WymCej09YbGpPArh+UHiW/lGanOmHlrKXlNg5tv9hXAfIvnBYjzZzK3dSRsPO/gwn3oNA1ZcWS83dZI+9wg5kJnUEeGXPZ8O//eycdS+LPicnmM/rwSPL7055DnXJ8HM//igaJzyqWIqDCmaNtzFt+1+5Cgn0eqAxr2cEEL+4gAmn0m4yHKAQzg/tMy27qc1P7Q7BJGEbXJC6Iz1ju3KhRrrjZo4xndNxkfqDHxgBftPsFv+lA+rzLsMN+10bbcRmDg8FTe/kRPgxKhOyQu0k4pMXmqH5MwP1sRVuUnhlmtqioU/CFCGU/Gv/ZO8qa7Jz6mlji/B6P0d2CGAmYp94Z5nomYWIlMZnDMlc3Aq3DtxOZymsOZP7kCuRYTnT4RxJQqPqURHSZtSiWpoZYzQ8McFxy11BixPJFYdVGSKM9vPmddVGQh07GTzwxBnHhIkSb5Py0KUr5PCvg25o7/7JwCz1vxv+sd7Hb13SjQdX2W26BzP2sbliU29NVpp1xU7BajvPRoCzQK2crh/ip64Qp8uw4Sy5jO8Qf/qhId3nmdz7wRwkLcFad6BY14eF18txv/dUWv6ckT5g1rn/UXBAZone1OHH5xtvWDmz8ouW12hFPR0X6+tTFPOQT+5E8lyvG8ezZp8aG/rGoM9t1ZhEZMvHLYn3SyGg9puntxkclP9o67XICfi6WCOQ83bBkVir9xioe2g5MwAaGyIZLXNn92Oe5JaRMYZpk5NWIn9TMkizPUbcsUPI/IE36dEewp+D80qgZ7ruEYlM/JRqanzbBnG+mpJ380gNzSOA3pf5TMYVCcIXf7vKOJT1OLiUMusCdVd2VATKDUoDTIw0nYHNmw0y51gM1EqTW+hCvxVi1EpkGNjPtwp76w/h3PjmdFSqXZqeTUW9at2xWSECnzdza8qBbTWM+HjTgmoTQ/lY9N89OkZMzc0lxtlE8TeTtFAYx/S6Ot9DtVjsu1d9aSt2PaXWfyFYJAMzYycDyraAmNymPSt4Xesdo/OF8ULhB9tW573DLzSlhSlCPpT2HqDymLeI1lFmXyXmaals+mrWYUq0XVmbMjQO7xRmXlJk6ZsGj1jTLXBsuyL352aJWrHChKThWfEB70S4gqySDzA6M72QLnTjs1fLdEU4a4f9FQI8qobGV7CyoKT+K6SRoflUiXmZHGsh+ZeBMbOZBBgFwCmrbmc8v+UlCX9yxP8MMx97V3Kl9NrMmKdB7JOHEPgmeazXLL4xXVWHdrSFvNzTY+zsU+029g8qdJDIHKeb4bQdLxg3YJyiOFaMy/V/Qc3r+COyEDr1beE/291FVxGYgQyP0a1F7wmcWcMKoYq089Z9YuENKmWzCsFGUuo3xF/Biv6LLITrmKN8ya+Tz3Sb2HwIT86+zyFLlbgpjDbg4US6uk3KzosoMtbOGXKZHbTET9xaNYlooqC2+olnrZ0SsI3ohH+qPjE2RXrj5ndCFQiDogte6dvkTRhrdEyRui9m6Jk/NmTk7vlEkl7oNJQ7Y0Ab5Fj4bBF9ilHfefTn6oNcukfi2XkTXsl+FrI3VaZzDfENZg8Nr2zrtX963ACKU23ubXMhO6JKBKjwzQ75qlsDjvYY3cVaNkl8/mMmKF03bjf6rj0+PSZT5fLPmar+y2pB9IXl04by7dbPzllURy2yn5y3FjjUFAIatCGklkvmb7qF1t5sznAnv/qjnWz9VZZsK/ZZjwZxgRg/3ioSXLJo0d9lc2s770OCoySsvGxwK5Fw8bjcH8wWo3O68O6cmObRe1MQ9hQp1dbCMncr5vZ58lm6joENYo/tMp2e8vH/3D25+mqZCDRzN1J9+gbOQqN27+iBebsR2gLkrh5+PZoixF82K+ZQFySgDW8NbyG9G/JSVhux7wFZ+zjQ6uBf0IxUIuM/+kCiO8BWviKBOq1eDj1HUlIcTrONWj1NHUTwHKRBbATRk66Vs/fN/0pNdiEXDn4lCHMc82VGB+bzKtONf4JMlb3S2DwaiDzKUtgaQxVUYMFNvqwrYQBvkTvn/+U3FrTsx367dFwwlSV1pxwC6aMEsLLsZcA5PYhuNu53j7Y7P0NImQJ9+cJA2NAX0WFZyCbE5Si297Ez5rNTCu379x23gw+hzyWez5aoLtWBm5E6oPc2LgyakHS5G0PjxXbB1n8Q/7Yv+M1B8ffgam0GK30Amp7RqMk2oV+punfIi0dpO0XvP+Y9U/SMafS7hIoUyIUHvDCGMRmjCICxGPzEuepcKnWmlYf6zM0ouMNnD4plCX7aucwcB1IdhOSYxlG6nY2TjlxDBd9tK734VFQPng/I9bpo29Y2QJEyGNtcvZJVvilL+6fwCAQ0udu0OwKE0Trrts27Zt28Zetm3btm3btm3btnW+f3QH94xOD56MynqzqyIqsrpzkDV5Yu/4c4o6EoxaeqdJyAacjA+w4G/3VrKBRqFAdGMi4g4srkU+S1BHYo+/D4EGy283LTY7MdzTVg3U2+nJq+szozBqmfPw13vU/L/zNrh4eXecGkYQ7rHH36ZnbgHImu1Z9KakRVtbqfjonYggMgLgHPCRNi8I04g6nmVYYeTfwoMS0akse7zqi5UjI4GCp3rmHAA897ld29ixCx5IU1NAGsCcH5kMKzWMRmSvZ4lVNFX2hF3NNDAyzrZDk7tfIsDiGZvVuBe4xGVJrql72j2gfpHGCRlYWKw05T0aBT8MjBoK8VwLmWdVn6X9/kkPzQ+5T3qt0nicIY5fQYtZZog/Uqc4pFCe/hV+oJJSv0wkBl9lEwYfxYsiKZQAZxH5CsLaZkRpczIGVHThU2/fFAgJwTJs/ttR/8qeQF3bxkw1wpnN9udQxhuOk/EDhruUD2ZGC/nOT9fZF9KK0JL9wm6KFViUqtQBCVwLT1zwKw+4gWc4UJloJykKoFLa7PrcFR+NlEASyPATqqLRU0pOmpouhc52sP+AfsObO37lJDbYp3wMut+2lM0c3I23ahJLTL1d+T0LL87HjyjL107jEzvjusOiLU/rrf2ehiBUPJO2QUYbvjy6PnfNLM05grUNLrkZAxitAHb4uSNSJcPWZuMqUA1QOd2OZxsg+1GD7veIkziLhuVWroCeM33g2zRX0mFf+k7O1dv5G3m8Kl30XCMIqb4FMeXyieh1ZsietB9tOoIkQzB8enNi/GPpWHCzQXIe3hlRU9H6Q+Yin75/cgFQJiAojNLPAfn8A4MWuk0iVs+LT5CaMQxzIGLC+mlnXfpOuaKuaBIcAYq0XYlNH0/W8Ods2XUUYArpMM8E5XAalW086vbjZdBro9adDLO81FtygFXWeLQQojHvKyJEZFmEUFYA2zj+cXtE1KoLyl+cZErMCmWRo/veLjsTbjbHAliKJOsGDqED6BZ+I2HTWqVj16F+GgsrlVpYG9CdKc5vWc0Jg+UK5kBMiqyhkhn0PfB/QQfmmcMb8j8Lmzgypi8WLAejpVOZDoBMy1Cvx+lsvuQEYo2D2QeL33o42RnNTEYoAXNMoQbiDQKAj0NUk26ze5LhKXz2EiEIgpFqLouz2w8poLMqg6/UxJk2
*/