//  (C) Copyright Matt Borland 2021.
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_MATH_CCMATH_SCALBLN_HPP
#define BOOST_MATH_CCMATH_SCALBLN_HPP

#include <cmath>
#include <cfloat>
#include <type_traits>
#include <boost/math/tools/is_constant_evaluated.hpp>
#include <boost/math/ccmath/scalbn.hpp>
#include <boost/math/ccmath/abs.hpp>
#include <boost/math/ccmath/isinf.hpp>
#include <boost/math/ccmath/isnan.hpp>

namespace boost::math::ccmath {

template <typename Real, std::enable_if_t<!std::is_integral_v<Real>, bool> = true>
inline constexpr Real scalbln(Real arg, long exp) noexcept
{
    if(BOOST_MATH_IS_CONSTANT_EVALUATED(arg))
    {
        return boost::math::ccmath::abs(arg) == Real(0) ? arg :
               boost::math::ccmath::isinf(arg) ? arg :
               boost::math::ccmath::isnan(arg) ? arg :
               boost::math::ccmath::detail::scalbn_impl(arg, exp);
    }
    else
    {
        using std::scalbln;
        return scalbln(arg, exp);
    }
}

template <typename Z, std::enable_if_t<std::is_integral_v<Z>, bool> = true>
inline constexpr double scalbln(Z arg, long exp) noexcept
{
    return boost::math::ccmath::scalbln(static_cast<double>(arg), exp);
}

inline constexpr float scalblnf(float arg, long exp) noexcept
{
    return boost::math::ccmath::scalbln(arg, exp);
}

#ifndef BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS
inline constexpr long double scalblnl(long double arg, long exp) noexcept
{
    return boost::math::ccmath::scalbln(arg, exp);
}
#endif

} // Namespaces

#endif // BOOST_MATH_CCMATH_SCALBLN_HPP

/* scalbln.hpp
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
*/