//  (C) Copyright Matt Borland 2021.
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
//  Constepxr implementation of abs (see c.math.abs secion 26.8.2 of the ISO standard)

#ifndef BOOST_MATH_CCMATH_ABS
#define BOOST_MATH_CCMATH_ABS

#include <cmath>
#include <type_traits>
#include <limits>
#include <boost/math/tools/is_constant_evaluated.hpp>
#include <boost/math/ccmath/isnan.hpp>
#include <boost/math/ccmath/isinf.hpp>

namespace boost::math::ccmath {

namespace detail {

template <typename T> 
inline constexpr T abs_impl(T x) noexcept
{
    return boost::math::ccmath::isnan(x) ? std::numeric_limits<T>::quiet_NaN() : 
           boost::math::ccmath::isinf(x) ? std::numeric_limits<T>::infinity() : 
           x == -0 ? T(0) :
           x == (std::numeric_limits<T>::min)() ? std::numeric_limits<T>::quiet_NaN() : 
           x > 0 ? x : -x;
}

} // Namespace detail

template <typename T, std::enable_if_t<!std::is_unsigned_v<T>, bool> = true>
inline constexpr T abs(T x) noexcept
{
    if(BOOST_MATH_IS_CONSTANT_EVALUATED(x))
    {
        return detail::abs_impl<T>(x);
    }
    else
    {
        using std::abs;
        return abs(x);
    }
}

// If abs() is called with an argument of type X for which is_unsigned_v<X> is true and if X
// cannot be converted to int by integral promotion (7.3.7), the program is ill-formed.
template <typename T, std::enable_if_t<std::is_unsigned_v<T>, bool> = true>
inline constexpr T abs(T x) noexcept
{
    if constexpr (std::is_convertible_v<T, int>)
    {
        return detail::abs_impl<int>(static_cast<int>(x));
    }
    else
    {
        static_assert(sizeof(T) == 0, "Taking the absolute value of an unsigned value not covertible to int is UB.");
        return T(0); // Unreachable, but suppresses warnings
    }
}

inline constexpr long int labs(long int j) noexcept
{
    return boost::math::ccmath::abs(j);
}

inline constexpr long long int llabs(long long int j) noexcept
{
    return boost::math::ccmath::abs(j);
}

} // Namespaces

#endif // BOOST_MATH_CCMATH_ABS

/* abs.hpp
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
*/