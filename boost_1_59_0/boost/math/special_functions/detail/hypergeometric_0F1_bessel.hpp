///////////////////////////////////////////////////////////////////////////////
//  Copyright 2014 Anton Bikineev
//  Copyright 2014 Christopher Kormanyos
//  Copyright 2014 John Maddock
//  Copyright 2014 Paul Bristow
//  Distributed under the Boost
//  Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
#ifndef BOOST_MATH_HYPERGEOMETRIC_0F1_BESSEL_HPP
#define BOOST_MATH_HYPERGEOMETRIC_0F1_BESSEL_HPP

#include <boost/math/special_functions/bessel.hpp>
#include <boost/math/special_functions/gamma.hpp>

  namespace boost { namespace math { namespace detail {

  template <class T, class Policy>
  inline T hypergeometric_0F1_bessel(const T& b, const T& z, const Policy& pol)
  {
    BOOST_MATH_STD_USING

    const bool is_z_nonpositive = z <= 0;

    const T sqrt_z = is_z_nonpositive ? T(sqrt(-z)) : T(sqrt(z));
    const T bessel_mult = is_z_nonpositive ?
      boost::math::cyl_bessel_j(b - 1, 2 * sqrt_z, pol) :
      boost::math::cyl_bessel_i(b - 1, 2 * sqrt_z, pol) ;

    if (b > boost::math::max_factorial<T>::value)
    {
       const T lsqrt_z = log(sqrt_z);
       const T lsqrt_z_pow_b = (b - 1) * lsqrt_z;
       T lg = (boost::math::lgamma(b, pol) - lsqrt_z_pow_b);
       lg = exp(lg);
       return lg * bessel_mult;
    }
    else
    {
       const T sqrt_z_pow_b = pow(sqrt_z, b - 1);
       return (boost::math::tgamma(b, pol) / sqrt_z_pow_b) * bessel_mult;
    }
  }

  } } } // namespaces

#endif // BOOST_MATH_HYPERGEOMETRIC_0F1_BESSEL_HPP

/* hypergeometric_0F1_bessel.hpp
5jtFnGaQvIR/Y6WVcE6ZXLSxrzbzdICZWI+Wr67tmdLP6fwxMg6SHDQO4weUb37rNr90dn0OJPwXCLIWEU9OGiVkisA/JpT5JYRzumTHAXp7LXFuur3dt/D1wFvdOtwA9Kzr8E+A1eIfMVzRKT7J4DocZ/6lmqUJjTRHLVyUYfki++RVQiD8EPS0wC21DOhIGbC0RAA2e7X8l3MHJa+YX4mpTE9yGSdbkqgaGMF/0WfaaH42uvk5wqvuoq17iCk3GKsImSJye9gmLMTqFOZsMu3FCiGYss8LpXDYlMuOSeBzqHcc/12/fHu4/Gtu6kMiysvmcF3AVy82d6ccJzs4JpDywgwNEyHnaGVv/EbPShzk6TFXZjtrS6Rg3QpMtJG2/+v1lhk4KNqb0fH6HLCTCRHxYg9Yk5yZ0PmcSgu3CnarZpv6qwK7JDzDd7yetHY3vf88Yty6tDG+WpiT80uSJJM4BHZqWW0DB/EwD7qMnkGRYszOjB8rqa8Cvep80VIKbFMX0rZtO3jKX+uqUsOmjAICEJNbJwLL08vyFeIj16TpsM1aL6dPYjtFdnWG74QGoTpzRzTUVxDE5+CxBp87qk/DEo2kQlQDM2eYsZdECxULFCqpfDBrJVQi23EmjE5ECWclYMA4qOpMmwrT2xOU25FmtFCHA/P0YGlRmTI95DqaC5gZr7s51A5m6oCUPu6DwHfXFDiIapDRBGiCXDVsGjbfddDqMmxGYnO3oN3dN5mU4+A4XuqH9xKajNhiP247gjJxmW4TZ3Wlpwe2OVNmprnITqqpcTXq25EXmqm+chuEXLscAV4pFbC70Ev84E4sXj5us6MKupzGi9/cgmyq9nn3bn+5ZqWho17j/RBYZAdQkn5QYpR5dPUlvoJArk+LxAvZYNx6XZLxHh+qhbx3vDgOdQO8/IboEdaek111cWt9NTrY1B3dcq3l0687yVXHbo+7P7tGKkpNRnmIvT5WcntNKidna6R8VSZyQdEb7JHQ1qzez35+aYGyAfAMG94t6NBy529vt19TEKPr2x2cnfD4AhYdgtmaNV6XLpCta+CnYlqr8x/zwc+Z1WWeBGmQ4MWR2nA8Z2ZZ5/T9nkvr3nBBeXX5wBkPMT3LM2GzZ2n4psRhHaDlerhHeoE6afjF1bI37sN+af8TgHdtBdG7FPgFtyRwFyoAxm2dn57PP5D77/uSt9pWgPA7cTp97nLrF4ziFicg8ieUtK17UpJ8WLaMbjHy5uzQ7wjFqnryV0U653x2Op2kkZLKfkqVNwCezaPl53DfTPKSOYaAywTFbZYzPlHNT2Wkjwz21ohOZW8yImXGbPpBCAMIh3xLSO9lXptKO4HyivGQ99D9XUrmzebXV6DR64u7vYI66ZnL2xxP5ln61qh0ymPMje9aVQpOEzdkDU6m1Qcst1Vs5MVDa3Lp3iLOz9WXKIZVj+ISzstha3zDewVveDnGp9WSvfjH9n72eq27tyB1+MebbdDva/qy9nPB844X5y4UCJ715Zfz+GZdblh2O7Pw/N43TPHHzwMWy83bA8/3aiXz5kcm/n0iVlrMbPQ1vOeBDtnisNGP6XqQLldl+dnNzwmMEybX4vbm9m77vveDUMfIOuzN784SNSSNlzqebpKqtjNW36KggBRLwPHw1XIetkqhqugr7fsY5IYbCaOX36feF/xRQZZ2duVlvWXxbpfFbrtrS9+36OSJ+b8jHWsrulevGFO668BvI3lTKSVYs3t5EZ7HVXPVgGfll5reQ6twfHp394jfSRe029de7QeU39WKwM+BH7bmrMnL71xqywe9ov09QtirfJweGwpTXIz+uK4pKkfqpd/TBIuv7zdocGhw7N6TQh/FiLTH6Ik9x5Mf+FLDnJZkbf3A/fMEbwPxf3z3I2kVzJxmwSRmVDoMFwdgpVIAg7F2WICF/6gTHyTVO2wtBFRzZ+vSFwmKDSjqKZd1HcbGN25bOzO3s/g85ea8OeYXW8hRNo4SeGu7MtmIagtfDyNrkPqDA1uaJTyEh7bajbZT6HNADhEBb7+JkC77WsVJMhT1k1A+TbsG0l7SVtHoYACxV0fhSF7w8jaNvCM96bcNcuasoa2PQDVcuEMFN2izw+2Ii7kRAtZBAtX/E3fp/jhsATnQPF/QrkwpjBQb8k3ZkUWuxLV+0FzhUuSEBrxk6eu3k88ZAw6Q1PoozaT/kQswVnc49tceTHDn1SfF4bWiAnzrQlDQUPXYQUKW4EFZ4E7KBtop3nw8sB1m6WQWhXObAv3CQ+ehg1/SAp1YPODIJBrde7t7a9q5vtqmdtp+Ebm5tZFcJQ9LXSHH6aQbwNKwKsU8NMcb1K68j1WT3UWcwNf6r7cxtHmTjAAQLO/Tq0rJT7HVWYc17kHRac8CjvyCxVTadRM1hpRC0cOCiKVnOt5ucJa68/awlbkHj2JCh9zvfS3wv5LDvdmBI+F8yX0uooP+0joCGwImpu4bIT4Of/yCxd55bTRNZ1iHSbOXo/5LxEUHz+xTywTRhLpU8RScHU0VWjq2GW3sFNDFWpMDePvQClsql66/Uxl37242mjOZNxId7T10s9/nHBrBdH7gGQmfCxvLSB86b6qpnYPdxHzzmdRoT3vM3m0Q3FJJyZxPLfvmGItUXqvMQK2bnaWNA1YiX98IWgg40YJl0FsCYBlTSlsNIsMq0f8Zn5UkB5KM6he7Ib7+E1VmOMCmYnwxU/fKiEXbGDHH8ZOUYa0pnE9FfbVQc997VUh/4Kp0vpS3GU3qgMIIB6ySWZuYUqrIZYo914fZeRGro0NM5fbEMabh91BF+VrbpybAQwRiHIpw9s7dvnzwFBSWzb4A8RpmN3su7Re7eziSpLzt120SiKJ7/TiUJyeVQTsbUn3MAR9fJ5heORzP26GlXUtJsUE/ErAnLbm5ySTuzctTKMA7insa0BWitXoybpWdPf1JFhwz0txVI5cYt8CleQr0RDw4QCqp40RRedZKT62ksuyc7kvBTE9RrGEYyL7jwdDpw3IXeVqC2hMjGcAoKbnRQAgDCLtA6K39IXgwwWCq0lq2QtCvfPl+8Q8z2XPQxjxTTaZVodcOQeT+RsGaZt1BmLyD4OnAMDwdwxpsMnUnGalwukOE4OO6uxYZRWTHsRGqPlBPG2URzgQWEPENtpcuaGjkNzYXf2U38PiNd486KJTJ9GHFy4kjmu5eFWM5Abz2h1G6NPCsxjW7UqQgIXqSsqRrMN5bPLUqIVL8FbnN6BzkKcXtPCMCvu2DCPF6MZ6JGQB+h2WC3Z6e4JmLHXvzd1KTizrALfOwlvD8jJgYNd9FmKsGDz/+dn/RoLyL27Ik63Ffsu5UfEkWlJcsuAE5WpQeEaIoG3rhC5em4bMf4gfOTNbut7Zux/MWrDVHeEUcAiyHIGbLoYYujCOM7Qr44c0xi0uH34uLavWcMgRHxbXkZ7VWe2sXBAIpilJ/EQcyqiiWVygmQjB1Pmz+lnJObZslL3v5aR1qO+toVaCn8RzL+42RMxEHC1XTGIIIARGsHVt9lEfCU+Z+WRIm+oi9+11x3ZbHgpqK2MO1VSLxersHWWdnPGzEyrICZvPpo1A63ARPfdzBZdZ6UUP2kGWe1h3Zs+nA9j+dc3W6kDAt93ZOsgrtQ+eX/4aYCX3qWqllqKGqF5TYC/PAJ3gv6zXAbEXhxBrXokXrsC/OXjF6RLUoa2Su3JFhN+oHDX8ON4tx9fpBe4wcnddRag+vAZY2U2GmuFkkMSHb4tMK7l2H2N0cqkPaHsFKxWj6DLpn+kxV1WPpnMQ3HLqw/lOynNYvEWuOHFoqsZyzWU89h/oA/UHgN3SVP/ROiai3U+a4Ucf0rmWRTv1X9Z4utQO9Hn6BmXG4/6oZNcYqvrtdTw/goJOA/jmLl8gB8er6+OZPWgcnYSh14XphzX5UhxaDVrjXqJtcf3Rs3M4e/YEaFyZ3FOG89DROY0RYNHButYNnbVHssRRzst8depNLe0MQyn1GcvGa8Zock9bbA4Wut2skXV9TJ0/D2L9f0rXWorpm+4xMLme84avBfn26x87TW2kz/nn1fE9y/0TekwOgrLnm1Gepn9Rap+2CyKqhKuLldW8bQHXN9yp5dWWriPCmAzCGKirCK3fOtdcVocvqoRqhNzDeZGGBPL5l8I83tcfCZ0XBw0u8pRPDIaTRvT8z4XUCcs0/mW7yVTasewa+XYA2SiPgNkjO7d7mSJzEBKRHk6K6C9Kzyq0kZCz31TY7PTYILWlevAm55MXTldSAhTo9gTuILe+/ESmzV8H/tpFspiKpX+j/tXEsFUjlBfFeVgeh+tdm+F9zchVpL1zLTJWF75l62fFbUrwhfDVyTw47TZByfElfXtjgVFEHdNDYVLyLSWwURvabbJtgkLYzpNx1Qsmh9kvmYPMgCn2JVIV/TUa7RvwPFoDpfw0iPSfsqCeWCKgwyYgzb0W6drgaCEMhduA47wwtg27PRiZU+FLSE74wdoePgNwRub5HqTWAfQGo1C4qez9jlxChzau/nVdz2fKa1W40EVplG8bmiA2zI5w34eo7nSZucN5/rzPcv+38YXNZK3UUpbLTQAOMM/u/ZOvyR60dneU/mWTG0LkPuvKN6yD1Z6iaragkME2KnFLpMEG1tUvmN1YEa2CJwPcGGhONOe62nw/cu8FaoEQ+wucvQwmQ9vWZsj2c9TshqDrFV0cyOF31ZVelPG20PZmq0liX7oGJZIkUHSOSRNmXoCkd952BrudLDNxFRBDLDM8tBWgkdHEeJxfRESVcs+w3PV7FJRK/DfYfK58plc+t6WhhUNMFVkF5LDtKPi1MwwMHMle/NWwaY+cq9GIG0nztl+uE2oF2eIyhX4k6LToZYQumfqBqe+u1pbmXp6BbLszbNJezSl7TOuhLk/7TuYM6PWSjF4GgH/I7DVGDu2Gr8FAgIkaZ9ZClbMs0nGUcaWc5LdDKAweW9878olhZcf6SiceDXUmqe7UPINlfgKvlfWELvpNEe+1FJE3amzkT7cfYUYNBIIxKgYn+kU3KZxq4VLZEK0GyY7QJ2iqdXwxMhmGCs9vP69OPr2KLdxtcndQgGX8GmIsVt0cBi0G63Y/D/2gSqDaXhr3Ek9OvmiaXIcS5xwGksIqcxLeYdzGC+QNplpo15hse7HJa9I6H9gKv78qec223sWevzdL89qFpD/SPN0xTD9Hy5sKZxx//NembCJT/f/Pbzyln/AKefNgzHXfbvAFD//nZ2MPlMITF2+dUCC98+QxHstDYHq08MVgKz/jSPOH5EdXSvhYZpMtmADzcFz147s1Yn0h5q+X8nbtJ7JS971l3u8/PNiYU/zI1lW7j0pc5Zg/DsZ00n8+jMnTNjg7uQKnHE63JxeBXq33noLYjrG2YN7hj8aFaXFcvF2jEZwZKdiBzanz0YRnhvtm6d62bF5JFif6RzF6XxVVotaOnEfs9VhbaN0axgKudtRgnpe3MIPb+isSV87miwuPZHL6JRgdYu8c+s5aU/wpRyYqHZx/Kqe6Lj8tRh61waTtdwxkAJBAQAAAAAAMEABQAAC8Aqqo1NBpVqqqqqqqq2KhVzVVVVVXDUFVVNVRQVY7aMyJWNABgAAAAAK3ty8bZFWWpIrLSbrmjGxiI1mtvnlFTzdB69U2F1bb1fUirrGQ9/xICrbJ//yQFoyD/2CmmZENRCbWRDJFTdKInYBqsFp0lKZpCKFAltkEUQRRABAAQAAAkAGBUYATt+/bdm97G4zIs0DMwxAJXRON2LqByF7rgSuhctV8iceD/w33j17jFpFyXU2d5J4zWDLBY0c511l1o0ByWabmSkgOQVVXwjsO5ncTiP2MSqUmsAPkNZB096w3e2Vz5an6fgb+8g/I7QB7hwIKAEwOay/9aQ2/UHQ4PIdlyCGJfT9xN4Xo33Pu8JaqKHLxzRsW0+jleb5OcMBPIo3YWF9z95pi+ecvi1bG3FOO56blFLiTaSTKFJwpxdffLKrYzf5Q/UZ8Pc85Pwhx7QmJpO9bkY4dQ9dk3R1GWtK7CSUgWLxI3PVJSq1V3MfAZeLaU9ZQKpMOZtChX08S87ULvxVtjSiSVfqFj79xnjQRcM84wal4+/IY5Rj/78njw3E/IejRLAdNGfjIcTsqf4SOsETju2F1ZTctZ+NfvG+xo94wliehzFoXMJ8s78wNJxw2UeE99g3xWqSq1jOh0trDRr0nelx0bYdabTZPMaJmXt51JZMVZ/m0MK50goH1PWv8b4y1Pd2/T9WVTIxHtdO6+ZJNLlSTEnRBZ2eZBea5efSv12WTmLDOoFrdykeK08jB+JhiSYvfMzbgwmXaNLfgtGrLww9Ek9Um5/z6Qo4bHdtX4XqGMMh7RP8aXhNT1wzoBJYfQgzE7uX1dp8tBQSKDpbisq+WWji5s9JI207y86XU7LtHkJbvTCTUEOyVaa3+QTBWbr6pOq6KtsYtewuzBG1P/8NkBMCBQdt2bo+BE34itW0/m1Ahv3bhIbPizyW6CwQPYp+HK5VXU3ra76zOm4nfuT8/8CuNYq8e+bovHs0Mqo7bac7t/xTDrvv+/J9Vj9OYJzOZx8xrv9U72vik5QRkBwJGAE+a/ThqJi+FQmgNg2hzYEMBRu1TnQf60t84k4NinzKHeIwuSOW3tiSOjjHsOPw/o5Kx126fOWh3bNpcB79PH5O6aPONwgjunTTJ3s6xptkNHWHR0+MGuY++LjJlPSmvP/+z7paDV2lRhrsIJvufH8D/rqwrUiYrbYFV3B/tABqSIxzqvtTTxD/HZCk0p0UlC/HPzkeK63ub6zfAIzaQQGsOtV1zvhXlA9dI2ngOt0y2ljYUkJHFxqt9Q8O9CLzBPoKml+y2P7XJP6Tq2yhMHO/YxCm0goVt76eB9h3hQkBs/i1XpOeWI0/aPdsk9Dc/0HXkQ8gqVTnGPOO8Cl+zClwmoIFqF+M2GoPfV6AHfyLWrW5QyZ1KloMdLl7OSPsJdR+rWozhJxB4nWqe9zvpqKeff6BbJafRO0q4sWW4V5OXkIZfq7udnUgUpNrAn6lzRpklCIPJJ5p/J8rH7tdiz4+kpTI/GnDTM89C2oO/9+VjIlKgu8MATxKs/KhGsXwk+DKNpVWwEGMMP5Tib1NxRGTIbdTlmTUfla9dWEvJTT0hU0lHYtMh33MOWJim3Ro02Ss+kdrmiRKbWtnft1UOsRFqVTWUWkuAP57eBjlo+0piFg/BMe3y6y3LJqEn2UQtqsCMaIDfEPoMvdSfGTNrMatMO4G5L4TKQqE3ccKixwdROCvnpLSVZPaoZ4kZmsvs2bgdgHffduWbZQ/yNncO9xJErtPGVUswSzzqfVOeczlavVxaxYfZWcEw+4XJOPEb9vupMRaS3P31rkt8JwdWFV2mWfTfq+yMqC4EZDeTJThjBYt7ZBvnXvMujS38vLmA+8g5fg+kNsYefr4csvX/zV71iRhvnqbby5ufRaL/7mxsV79hNpz8K54Zp/76twgn936c35ts5cnVXiXoBIta4N9+yvBUTALy0JbiFd9HeM/fgsXrE6pfjSapqZGUgPtrVAgne8FOuzVOb2qO9qEXV6b53UJ2G+QkvBbW/zoeDTrTbzduCeSzRrKB1Pu7d1tFPejwU
*/