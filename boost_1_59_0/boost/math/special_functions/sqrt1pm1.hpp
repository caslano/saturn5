//  (C) Copyright John Maddock 2006.
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef BOOST_MATH_SQRT1PM1
#define BOOST_MATH_SQRT1PM1

#ifdef _MSC_VER
#pragma once
#endif

#include <boost/math/special_functions/math_fwd.hpp>
#include <boost/math/special_functions/log1p.hpp>
#include <boost/math/special_functions/expm1.hpp>

//
// This algorithm computes sqrt(1+x)-1 for small x:
//

namespace boost{ namespace math{

template <class T, class Policy>
inline typename tools::promote_args<T>::type sqrt1pm1(const T& val, const Policy& pol)
{
   typedef typename tools::promote_args<T>::type result_type;
   BOOST_MATH_STD_USING

   if(fabs(result_type(val)) > 0.75)
      return sqrt(1 + result_type(val)) - 1;
   return boost::math::expm1(boost::math::log1p(val, pol) / 2, pol);
}

template <class T>
inline typename tools::promote_args<T>::type sqrt1pm1(const T& val)
{
   return sqrt1pm1(val, policies::policy<>());
}

} // namespace math
} // namespace boost

#endif // BOOST_MATH_SQRT1PM1






/* sqrt1pm1.hpp
W+Xan+l0ZJ2qdUrw9veFikhMfBnIXAwP2xFMMWpS7gBQ0oW3+GLC+CDtzc6R6i04OYDMycHm3Jr1auja1KOko+IuQ8aWXrClFSetvrcp1K+uZGqnDEEyWINohsmBjpsroH0jrGAe0MLBK11vjk9qj4rfDi7nPGPemolS7mNY2hp0vNV0rPag/Y3I+xe1UzEytrz66G3VhId9hEroK5I0NQ8XBzOreI2Puli9hKJXaNpt61B0P+JVd+3NIhvmhWbxovrg3lJtDUz153BuQC9lmuOy3SN5oVf1QK7stC5WbLZroN/cuPKJusExT8Stp2CtXSUTLKC0MFeTWDPgL5FCPCz1hUygCZY4HDvDFxTnHV03TKmKl7772cG0edHA2rBWwsNZMapK3rSl0dlfljT3Vq64DZ9mb7VVgzNs3jk+IaxhexpwLt5WqKmop6oiBeHGu+TIx2iM6c1mxPP1wjlkqQLXm6WFyVUKi9F40qMTuDxVGosBStba5zpBuzJJXXdogZZPsexT5FelWwKWhIozK5WXaoG/W60ON491NHXhg79ad7No+LwhN3QnR4ZrZgRkwwKadMg9k+DyyJ6Q2GGx29WUv5pjfM66qZV5dipL0ZHZbac9RGlMcdlA+QMVWxwNjeGLM1KDWXE+CiL52w0Pmbk2wCzG2i2SMJ5u/+Mh977IXJ0uvnSzObqX/WTYD0TC3s/LA1qyxye9hQZQEwU3dZ99gGiNmxBxx0O03u6ZGXFhYnkT5ySpIOHn9lWZCUKU4DLR0FwybPOblNKyYh6Yakk6Pc3dWCO8LJcJKNNiu1QLRe3leTWtG69BwXCIeNTfziHiJr6bbuIJ2NtMcZIipOpyLtMaq8LxdxOeDkezXUdI6CHCFY8GhvPGcIhhtPJ6KSLx4zLbxanpXBSy5jq3iN0149nxdrF0p1IJ5DYfA6b05XPXnEfbjn6dzxds7qVkM8BtM3frMeKD/XHQ9g2z40/j3uhmwdFBJLbXccpmgi3C+YMEQVdr6TNymK0iwZyyZyZ1XYXSp2yKZifpmxcb0BwTD5gSw9P8qWaEHz3wkGTylsZwIL2UucFpttSBdIiqRzWwpFOAGvCuUI0mOEzwm4UUG38jFqPpcwtoBqoWNmEjYaMicBdBMaNIypDfkmVw8T6JqA73BRzGYuKgdY2b8mXWlVWKdRLskYpiUPkIA92F7mljj3vgLzK5j6cezabggmFWNSQHRx6vIm5+No8rDtiNkP064R5voOzIyjFWgCH4iQDwzLpSai80ECXBlqzXTV4TtscbgjnD1JR2dNvhICn2nvUauiiSWXKYulb3zaNP3MZSOuyeT0KLiUKMBHcCUxekJmI1fnkBqVbrHtg9Rsduzz23VLOgcb28tjrbJobBW7GMZ92CqVBWlStjOU4mRvHKDmUMZV5OwC4j/BpSciU74+OgmQ080WAn4HoC5o+K1HVU0LY5KT7xq53l8yxFMq9ujERUWNGHthQovLcav1tEr3xFOo82YqeOVd0jO2fOCY4pKSzx6vo7tvxwV8kxht9nhJaNVnFm8tHoPqo/DAVSmxF6ItNLU8VFO7J9C9q+hosPAw9AKdRE4fB/XrblTtfYtk635AxALNk30ImQfN3xSZ9lvEti9xybTlpOkM+v1MKWR8Lwr3ffcgBzKetqUyq6YHZx63Zd0tMlBhoU1xpwNeWpLlgXrdzTgiu0UkC8XWdXd2YnRSWFwguxl7+P4vL/PgJjKISGdbmdIwtsllkGKnte70BKzeuS+zqQEhGv1q9Ws8aDs7ELc1y61RWYLCR8k97ADUd6d3lHflCEaT7ORneX0knwDoylqTTIA2f1/SVG7buFHj5GywsDhlQKUFfZWMv7z1uA9BdvJEXBGGvewiAk8Se0vZslY2ueH8w8qsUqrVK1i0ap2T4EiKUHDuaytyXX+xOIGgamWCVmmv4oUD+iad3h3u+jYVd0WmYLu7DjzRneY2hAlmCeXfbcuz0mOktMT4RPsaukxIPAyJVCi6ifOjCPjrJ7lv1MRX1UNc4Ka9CD3JUQ/WLQt1zzMfjyUB2zEG/NO6pX9Qtj3jq8vNkVDv2l+iXIxmeLl8KlIKfz7SXbcuS68f5RWhg4y5V5C8AH5Osz/9tPeZI+IoyIywmbzIq1Bn5alUcRasrccYgKsTEmuOs01sxFqvSG1goeVFcrmJ9vvIFZv8jhawI97izR4y11OsTrZZd3g1Ikd+flb6pc+50IAZNlSx9VWLJek5lJxentqRYnTNywZyN093LUZsTe58NtXqZiQaqF43X650PRGkLOTtU8Qx+412m+4MbeCc78FYsZcCWzNP+BD0u4WmNSHW5xhcoCg99NXWjzCUChHBItQve4iUxKoiSVHSlAzE9H/Te8xEZQDxCgjJ73tw1eX8h9uhb96Z/PTbqd9DwGYJjcND9DDNDj6/+P0tyD/+/5dQD8tOafv2IsHKDwYzwIGLPh3V8peoQeYl8DjxZmlPCHWX5r/stx1nyEwn58Cv0mKoxXEunSR7hTKXNu10pPbhGO+k2SBwdkWReqLQbJfZWwb+r52X7GtfvOLogoU26lUxQokQFOuEmmUwbBi7uCUKpUvRvt/gpOMlVk72JI4+8WxSER9Uw2a4Ep1GDx25aVl7K2q2S9Zb7uIKedLEvDFloBmw4JliA5ox6MD4OCk+tzwlmxp3kDPJjCEhpi0x2hRAkTPK39EsMbFKfU1JV/FzfH1io1mN4py6jKF8WIJ3rpueyagsgP5QzYSqk62vQ0Ey9bpkttaDeEE45zdRV7/DoupPgO8YhZ+6R9tkxuKZlenDajjma6XO6CnZTQyoTe8v0oshBOKgnwQtJwF4C/aiVNCmkbHRUWQ6yiBjc9kGOcdV+k8joGa5BA79f9DHgo+zUeDZWv43iBWm1WNeY+NAbwubAg5DS6bap4k5B6883GkEOoOV6FGi/8BPPAIqLGQAu+1oLeDF+qb7VKUOpyXCUJSRN9hSglt1Nq8C1gfbg2ceCBP7u/+C189S55hBT0p8qEGAmJZO5CR33+uV+QCes4iw/yGu6a7srbh0ehMBIxlfMe8gDuYHciviB9lE4RLL8DKz5oEv/xTwmqIrjSGn7/38vXgIeosmqJe5YUAi0HBwJryBPoT27RU9eF/3b2jUJbN+GAHl/4VsvhrRVOb4c2+ZnIrar7K3v4Q2IkfiLsiJDY3udZ8c9xQm9d2VZ4rYAY2T7w63R6PyF+4oL0MWCTh1B9fza258IYy2F5Xz/6e+Eq8QHNW70bBtRoskkST96o75TLH8SQzw3XWHBYSYnORPKWvnIm+d/uihtS7NH66PQKCXH6Pb0kA5PHQWsynapKJSP0ZbTRX4V4QSUio600vDi3vC1Km1MizZyuPg3VZX1vPYVQ5QbXbL+LX+cctu1fxPhN83h5xMaSFQlw/hkvuFOphLML3HUAAOOM8kzRoncL/wAGzT9fe2X4/fseYen3BrjEwl+BHeB5c66r9971zVZWI3rWljdtJh8puE/EXRsqgBV9HOsK68bWiXAP2wt2KrxmDSa7rrkAKJl6UPr8oG+bOWi7Gpf0bICE0d6+E66BbKbEmEPTE0cHI0GNWIOExZ94+d8KE0nzCYliTQ/xCD/TzXb7zj2IQO68c9wMcL2YrnD6fv+YyXcxv/z67YvSgfwMBsOoO6hoZy/k2sYz+09h3PGIHOT7sysXSxJYcU4mME5lnbbCtg0/3zEKBJHbO8Oyke8Wfh8dPfGVvXN8f7Tbl2Ebsw8VX1U3lB8fkF20+DXdUY9DJ4G6wjO7Dn72mO9pbDunfVG74cpM0G3vla5INjZlJgRhYScLd+Eh2GNn42QkmOQSY0PjXUJHr3daL5P0RpVZtI43vyblBq+3vIbBXYNzRaQ8mpa69H+92BTPoYFpqRk2HGKB5pVIq+S6bXSOkZZaSrsFpCUedFJygV6MznXdMobBttpdCRDZ9ikWnlTAhs3TIzU4YXjgxAkJr0xzUxudrX6F+1mvs2lvn46GydGwKhDNBtw0RXcJI2gs1HWv0OykfrI/GpefflwDMYXhrhlMXMBQrZ1MZaX2yQ/Vgr312geOe0PxEfjaom6H+kS/XMmV/J4UE5fA3Ct4bZLq03bplvkI2T3Nzl6EhgRyvZEufpjxniqNL36MnFkqmVpaVty37K1nF11Fo6ZXSOZ7pRcIilSBJlNbTqTSQGvC+n6iFypEO9BuKaBJ3LRDY6hhhIlf1+D+KL8TeeLvxh7i8KTSF/Aaq3PexbfYIJlr0FbKHscNVLjcVALiwtzavtbxoiMv0rcbgDVmknDRaZjaz1M4+KhfrWSr5WrFtfaFG2CVOpniY9ibDYxs713s1B0Ts6s4HsZKfS07l9iUTfm9GhBnwZg5sSMetrJbwYgcWF/qqlARbJyeTWfIdxNq/GgHbNxVQR4e2IEwBPTjaHq5ZrkQHoe7nQi1leuEBwwL6bU4tJVe1QvcGaX/8WWw/9nA+RhfLva9oW0YZVhGxM21dhNREu/6UMJ9Iw0Ytr9lYESK9jq+DHpc/HJ+2IJGT82ifwLsusAABrNE93kDL99PR8LHHj+kkiRZTvA6GZV1tkmD1mhzsJ3PmqGvdxASPecKQRJpLYZuCViEY4zzBdIh/41Qm03un+bSjoFxortcWiBfrKwO8bmdKVK7LEtIhs0WSOgxixSnwJKErFFa2coTiX39S/sze3ZfhIOTlJ3Jcvthq1nKC89IzYVmOKFzWIQwng1kenzXBAGgEYJPxOWRpXtPAAjIDKJ7Ta2nJx7glO/LAZcwmV1LlCvFvkOt6iv3dVo1mPGOduiiEbyFUWUUhA0z7hcv9ef2evcdRLUARXfyfDcPyYxe2N+Ji2OBsUUpy/U6ytbJ1pvsQ0R1pTXftb0TBIYnOoHCBeGFrHU77aHGpht5ucpEiGzou1wnmR6jE15+6Eejv8EJ2Of2Iy61Fm2eC4rEwUSE4gD0M1L3gigskGEyvSS6EYSV03sfwU0LxMSeEhOMrrOEWD9KPV73NZ6eKjMrrmdL18fN0qa61ByqJPhHYqHA7LuJi01zeanYhTr2PXgEeXbIBwVLh22XdmbpN36tdIUiwk9soepnlsKlCqr6g/Fzpcct7BRzYQVgKiWImJ1WckIhh86TJdGwWEBfUF9ur4bJ9s736SCqMNOBSpouQXRh6t2dLbX73F4hjfEkDdYHxAXaXxH2vTfjyvdNRdNRq1uTKS/SjYIFMEsNXkkC41SVrOZ2I/QxCzUKN0hqtpRoeOm3KS7Qm1AQSarHKioYVl18gqLVnJRUe1HW3++2vF1cOauyzSddJtbb5tSE/OXrJctKOlGbQXq/hcp/ZnQbzm20j9YapkAi96ZCDhI2YdS9eIqPs82HiNlZq+24bewACoPwxhwbVS++iy5cAAss9NNeZPqSIyd3A/s5kbERESVW+5dCsRmGJBHDhFUD/kSkMwe+FKJNw/xmbKfKaZDPBPBPhmmESuCN75Ib3YqWoKEV98zKNthGlCCwO/vUohWlRmtajMdUg/LQQyAZ4KYD9PO34+PIJ75sN8gSoSu9YZCSviJdr5q9s2tMNEA5sCuTZ9LhjHVw6rXcgUaK8pmpFnk1kX8vjOKLsqG6YbjP9q8Saudjme7DBPYJl9pom3SBtPp05mLnl1W+Zcz0Azawgmg6D/CYbd7Bg3MPrx/QydIHoAfXKAb6fMDrEn5cfqB/yOXShjHnT8OD1fl5QIZaZxIBwsdmb0tnFLJVFGreYsg2+OtWlJwjAGYvdTJTauYxyk7C5E/cMalYcPGlsMvTaOUlZBmXZLKmOidfU2Ve12EU07lX0yrgKl2HfTk/XfcO9CAIQLJ3FsMM0l15ys33y63NKhVa5CYm6C4dS8j3WWpbsHTcgvDOdh0qDFw9PpVqeVOY5OI8+XMVOvdbLbeEXqAQOhY9oIb1PV7sPP1rZzh9r5J8xaRISjWZMjVweQns1ApApPXrn9BYO3Fnun63qtk4uUTqjfvJmWeHplexyxAY2PpuLf5KFkRyHpyuYhzP5KSj7PXN9LYStUjIPVygz7F1UzyMvitLaTMSy5QKagKiSbKGOXhyb3MDYI20+Zn66nX9y/pI5Pz03TrOt3P9hVWv5ry7U6XYPDmXf4cFBYwVOBJt1TZt0bVgIBAQAAAEAAIAABQAADIAksIQlquwFloPgg/KayFWWLWwD62qVH7QghaCFtAPS31aWsIPsNY8tPH3mRmjmgA4AAAHOLre3tsHiEh4n0JexMS/X/j5wIeAAfXVJy8CCKi1nm7BQcxRe90zTWyzb62pCdr7S7TR3veFjgRdaIy0pOPs6XRQEtzs5lRHgClmgo4TahRElLX2o2Ku0ebthfBiwDYAEAAARAJgZmAE3/v3vi3Pd7Pcbc3NTOCVsTYzJDJCKBGlTJwlUa2cErpqF1/ifoncBVe6RyJukPxdy3obwPsZE82RNrf7PEDGvzEU6499dxmEeOmokNL6yA2+hkXdCBJmFu/EowyV2gCOAZSAvFtXICI/buJnYELAn4FwSVdLex/WzltVP6pRAjmrQJ4XZLG/aCtgcQ5miabz6yibRuEoyopl6o/nv0pK3A9Hl4NSNtnoDQMxex50DH+Waq0PaN6MBiU3Btg0mCheBO68UYu8GGjLPjtkndlQBnk2NTq0/N7Yj5/Ew9ydpPMiE0c1CFQO8yLEoFTlS9PAarEiOy46ymTqtXeEKEQSECmPbz5rhAlYa7RdcqZ/pb1uThuZzcEjDTfllXKDzktJhusdD+kjW662OIguazrpaoH4yYKBn6/vwfx02xOK9lt9GQY0fUTRmaaJWOCurtr2qNqFZkCpXW7W217qAzbtlGkTEfWkXUp08V32tFP3MXfugnkThcajcYzDfFdchd1cvUhF7T57/QZAradZ7Ueca24PIj5cJ9ahq7kyqA/fxC8IEceLvNEJ0cw/NB2Ip1SO5nTjryPlkmPHF7FG5d0FJ9Cm0PhSoZIR9VJSHsltLj1ukmP3Bm0qV5WdflYrnX8wmRtJ0HmR8Ot2BYU8OmDMDEx1rHWIzCvH0mCyUqXYy7FsS0/fRhEaBfjjssCbBUf+wXW7a2QpFeVdadGA3sQvNis2bNvwDovH940K7MxXwx5+6HVGLlhGBK/zSHT2NwNBfd+IDViDAU3nmXb8Pssr4iJ/VDLqR2zDdiMH9pzYvQJg9t45kqiPPZ5fz16yFW07z2q9sZCs489BdStcpLUpzwZit5F6BLs8f6uXHI8+dkjnmcimMte9TNPOvWA3TQxETYmtE5GfGk3NXOcZ5zqxDFqKEgoLyIodvDB2oT+U2k1bX4Y+cD92lmQaH0D4bBa5qwHwx2LTQf8bWnLv58tqGISlXCHc0K3om91wNCTY0IdkSUnRq1Ztu0rqRUPRHOLJwfLIKyVMeNJFCm7R6ZutASyBkrZq2c3wE9lOGzocTRvahPv5TNJRwULL/HS0VDqvFbRLNmwewHstB5cnClDyfHw4gnHFjq6jib88VCzjSjbsbm7j6fsGT029jOrKCcKsS1LUdcJDbkE1rcA+9EjqZCs4vGG3KQWq1oOdrWSsgP6uOUyEFZa4DIm5R6JdllMJP6XYoJS3R2Njfwgmp6P9jtjhVG7f
*/