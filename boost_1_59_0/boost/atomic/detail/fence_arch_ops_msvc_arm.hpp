/*
 * Distributed under the Boost Software License, Version 1.0.
 * (See accompanying file LICENSE_1_0.txt or copy at
 * http://www.boost.org/LICENSE_1_0.txt)
 *
 * Copyright (c) 2020 Andrey Semashev
 */
/*!
 * \file   atomic/detail/fence_arch_ops_msvc_arm.hpp
 *
 * This header contains implementation of the \c fence_arch_operations struct.
 */

#ifndef BOOST_ATOMIC_DETAIL_FENCE_ARCH_OPS_MSVC_ARM_HPP_INCLUDED_
#define BOOST_ATOMIC_DETAIL_FENCE_ARCH_OPS_MSVC_ARM_HPP_INCLUDED_

#include <boost/memory_order.hpp>
#include <boost/atomic/detail/config.hpp>
#include <boost/atomic/detail/ops_msvc_common.hpp>
#include <boost/atomic/detail/header.hpp>

#ifdef BOOST_HAS_PRAGMA_ONCE
#pragma once
#endif

extern "C" void __dmb(unsigned int);
#if defined(BOOST_MSVC)
#pragma intrinsic(__dmb)
#endif

namespace boost {
namespace atomics {
namespace detail {

//! Fence operations for ARM
struct fence_arch_operations_msvc_arm
{
    static BOOST_FORCEINLINE void thread_fence(memory_order order) BOOST_NOEXCEPT
    {
        BOOST_ATOMIC_DETAIL_COMPILER_BARRIER();
        if (order != memory_order_relaxed)
            hardware_full_fence();
        BOOST_ATOMIC_DETAIL_COMPILER_BARRIER();
    }

    static BOOST_FORCEINLINE void signal_fence(memory_order order) BOOST_NOEXCEPT
    {
        if (order != memory_order_relaxed)
            BOOST_ATOMIC_DETAIL_COMPILER_BARRIER();
    }

    static BOOST_FORCEINLINE void hardware_full_fence() BOOST_NOEXCEPT
    {
        __dmb(0xB); // _ARM_BARRIER_ISH, see armintr.h from MSVC 11 and later
    }
};

typedef fence_arch_operations_msvc_arm fence_arch_operations;

} // namespace detail
} // namespace atomics
} // namespace boost

#include <boost/atomic/detail/footer.hpp>

#endif // BOOST_ATOMIC_DETAIL_FENCE_ARCH_OPS_MSVC_ARM_HPP_INCLUDED_

/* fence_arch_ops_msvc_arm.hpp
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
*/