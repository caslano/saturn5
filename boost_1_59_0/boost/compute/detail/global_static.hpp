//---------------------------------------------------------------------------//
// Copyright (c) 2013-2014 Kyle Lutz <kyle.r.lutz@gmail.com>
//
// Distributed under the Boost Software License, Version 1.0
// See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt
//
// See http://boostorg.github.com/compute for more information.
//---------------------------------------------------------------------------//

#ifndef BOOST_COMPUTE_DETAIL_GLOBAL_STATIC_HPP
#define BOOST_COMPUTE_DETAIL_GLOBAL_STATIC_HPP

#include <boost/compute/config.hpp>

#ifdef BOOST_COMPUTE_THREAD_SAFE
#  ifdef BOOST_COMPUTE_HAVE_THREAD_LOCAL
     // use c++11 thread local storage
#    define BOOST_COMPUTE_DETAIL_GLOBAL_STATIC(type, name, ctor) \
       thread_local type name ctor;
#  else
      // use thread_specific_ptr from boost.thread
#     include <boost/thread/tss.hpp>
#     define BOOST_COMPUTE_DETAIL_GLOBAL_STATIC(type, name, ctor) \
        static ::boost::thread_specific_ptr< type > BOOST_PP_CAT(name, _tls_ptr_); \
        if(!BOOST_PP_CAT(name, _tls_ptr_).get()){ \
            BOOST_PP_CAT(name, _tls_ptr_).reset(new type ctor); \
        } \
        static type &name = *BOOST_PP_CAT(name, _tls_ptr_);
#  endif
#else
   // no thread-safety, just use static
#  define BOOST_COMPUTE_DETAIL_GLOBAL_STATIC(type, name, ctor) \
     static type name ctor;
#endif

#endif // BOOST_COMPUTE_DETAIL_GLOBAL_STATIC_HPP

/* global_static.hpp
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
*/