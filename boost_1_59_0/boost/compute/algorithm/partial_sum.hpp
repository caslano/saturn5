//---------------------------------------------------------------------------//
// Copyright (c) 2013 Kyle Lutz <kyle.r.lutz@gmail.com>
//
// Distributed under the Boost Software License, Version 1.0
// See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt
//
// See http://boostorg.github.com/compute for more information.
//---------------------------------------------------------------------------//

#ifndef BOOST_COMPUTE_ALGORITHM_PARTIAL_SUM_HPP
#define BOOST_COMPUTE_ALGORITHM_PARTIAL_SUM_HPP

#include <boost/static_assert.hpp>

#include <boost/compute/system.hpp>
#include <boost/compute/command_queue.hpp>
#include <boost/compute/algorithm/inclusive_scan.hpp>
#include <boost/compute/type_traits/is_device_iterator.hpp>

namespace boost {
namespace compute {

/// Calculates the cumulative sum of the elements in the range [\p first,
/// \p last) and writes the resulting values to the range beginning at
/// \p result.
///
/// Space complexity on GPUs: \Omega(n)<br>
/// Space complexity on GPUs when \p first == \p result: \Omega(2n)<br>
/// Space complexity on CPUs: \Omega(1)
template<class InputIterator, class OutputIterator>
inline OutputIterator
partial_sum(InputIterator first,
            InputIterator last,
            OutputIterator result,
            command_queue &queue = system::default_queue())
{
    BOOST_STATIC_ASSERT(is_device_iterator<InputIterator>::value);
    BOOST_STATIC_ASSERT(is_device_iterator<OutputIterator>::value);
    return ::boost::compute::inclusive_scan(first, last, result, queue);
}

} // end compute namespace
} // end boost namespace

#endif // BOOST_COMPUTE_ALGORITHM_PARTIAL_SUM_HPP

/* partial_sum.hpp
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
*/