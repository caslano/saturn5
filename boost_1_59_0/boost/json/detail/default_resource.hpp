//
// Copyright (c) 2019 Vinnie Falco (vinnie.falco@gmail.com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
// Official repository: https://github.com/boostorg/json
//

#ifndef BOOST_JSON_DEFAULT_RESOURCE_HPP
#define BOOST_JSON_DEFAULT_RESOURCE_HPP

#include <boost/json/detail/config.hpp>
#include <new>

BOOST_JSON_NS_BEGIN
namespace detail {

#ifdef _MSC_VER
#pragma warning(push)
#pragma warning(disable: 4251) // class needs to have dll-interface to be used by clients of class
#pragma warning(disable: 4275) // non dll-interface class used as base for dll-interface class
#endif

// A simple memory resource that uses operator new and delete.
class
    BOOST_SYMBOL_VISIBLE
    BOOST_JSON_CLASS_DECL
    default_resource final
    : public memory_resource
{
    union holder;

#ifndef BOOST_JSON_WEAK_CONSTINIT
# ifndef BOOST_JSON_NO_DESTROY
    static holder instance_;
# else
    BOOST_JSON_NO_DESTROY
    static default_resource instance_;
# endif
#endif

public:
    static
    memory_resource*
    get() noexcept
    {
    #ifdef BOOST_JSON_WEAK_CONSTINIT
        static default_resource instance_;
    #endif
        return reinterpret_cast<memory_resource*>(
            reinterpret_cast<std::uintptr_t*>(
                &instance_));
    }

    ~default_resource();

    void*
    do_allocate(
        std::size_t n,
        std::size_t) override;

    void
    do_deallocate(
        void* p,
        std::size_t,
        std::size_t) override;

    bool
    do_is_equal(
        memory_resource const& mr) const noexcept override;
};

#ifdef _MSC_VER
#pragma warning(pop)
#endif

union default_resource::
    holder
{
#ifndef BOOST_JSON_WEAK_CONSTINIT
    constexpr
#endif
    holder()
        : mr()
    {
    }

    ~holder()
    {
    }

    default_resource mr;
};

} // detail
BOOST_JSON_NS_END

#endif

/* default_resource.hpp
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
*/