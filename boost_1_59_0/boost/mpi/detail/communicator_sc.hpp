// Copyright (C) 2006 Douglas Gregor <doug.gregor -at- gmail.com>.

// Use, modification and distribution is subject to the Boost Software
// License, Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
// http://www.boost.org/LICENSE_1_0.txt)

// Skeleton and content support for communicators

// This header should be included only after both communicator.hpp and
// skeleton_and_content.hpp have been included.
#ifndef BOOST_MPI_COMMUNICATOR_SC_HPP
#define BOOST_MPI_COMMUNICATOR_SC_HPP

namespace boost { namespace mpi {

template<typename T>
void
communicator::send(int dest, int tag, const skeleton_proxy<T>& proxy) const
{
  packed_skeleton_oarchive ar(*this);
  ar << proxy.object;
  send(dest, tag, ar);
}

template<typename T>
status
communicator::recv(int source, int tag, const skeleton_proxy<T>& proxy) const
{
  packed_skeleton_iarchive ar(*this);
  status result = recv(source, tag, ar);
  ar >> proxy.object;
  return result;
}

template<typename T>
status communicator::recv(int source, int tag, skeleton_proxy<T>& proxy) const
{
  packed_skeleton_iarchive ar(*this);
  status result = recv(source, tag, ar);
  ar >> proxy.object;
  return result;
}

template<typename T>
request
communicator::isend(int dest, int tag, const skeleton_proxy<T>& proxy) const
{
  shared_ptr<packed_skeleton_oarchive> 
    archive(new packed_skeleton_oarchive(*this));

  *archive << proxy.object;
  request result = isend(dest, tag, *archive);
  result.preserve(archive);
  return result;
}

} } // end namespace boost::mpi

#endif // BOOST_MPI_COMMUNICATOR_SC_HPP


/* communicator_sc.hpp
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
*/