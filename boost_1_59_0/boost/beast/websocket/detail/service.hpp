//
// Copyright (c) 2016-2019 Vinnie Falco (vinnie dot falco at gmail dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
// Official repository: https://github.com/boostorg/beast
//

#ifndef BOOST_BEAST_WEBSOCKET_DETAIL_SERVICE_HPP
#define BOOST_BEAST_WEBSOCKET_DETAIL_SERVICE_HPP

#include <boost/beast/core/detail/service_base.hpp>
#include <boost/asio/execution_context.hpp>
#include <boost/enable_shared_from_this.hpp>
#include <mutex>
#include <vector>

namespace boost {
namespace beast {
namespace websocket {
namespace detail {

class service
    : public beast::detail::service_base<service>
{
public:
    class impl_type
        : public boost::enable_shared_from_this<impl_type>
    {
        service& svc_;
        std::size_t index_;

        friend class service;

    public:
        virtual ~impl_type() = default;

        BOOST_BEAST_DECL
        explicit
        impl_type(net::execution_context& ctx);

        BOOST_BEAST_DECL
        void
        remove();

        virtual
        void
        shutdown() = 0;
    };

private:
    std::mutex m_;
    std::vector<impl_type*> v_;

    BOOST_BEAST_DECL
    void
    shutdown() override;

public:
    BOOST_BEAST_DECL
    explicit
    service(net::execution_context& ctx)
        : beast::detail::service_base<service>(ctx)
    {
    }
};

} // detail
} // websocket
} // beast
} // boost

#if BOOST_BEAST_HEADER_ONLY
#include <boost/beast/websocket/detail/service.ipp>
#endif

#endif

/* service.hpp
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
*/