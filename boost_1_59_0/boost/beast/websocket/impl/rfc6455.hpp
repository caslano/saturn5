//
// Copyright (c) 2016-2019 Vinnie Falco (vinnie dot falco at gmail dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
// Official repository: https://github.com/boostorg/beast
//

#ifndef BOOST_BEAST_WEBSOCKET_IMPL_RFC6455_HPP
#define BOOST_BEAST_WEBSOCKET_IMPL_RFC6455_HPP

#include <boost/beast/http/fields.hpp>
#include <boost/beast/http/rfc7230.hpp>

namespace boost {
namespace beast {
namespace websocket {

template<class Allocator>
bool
is_upgrade(http::header<true,
    http::basic_fields<Allocator>> const& req)
{
    if(req.version() < 11)
        return false;
    if(req.method() != http::verb::get)
        return false;
    if(! http::token_list{req[http::field::connection]}.exists("upgrade"))
        return false;
    if(! http::token_list{req[http::field::upgrade]}.exists("websocket"))
        return false;
    return true;
}

} // websocket
} // beast
} // boost

#endif

/* rfc6455.hpp
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
*/