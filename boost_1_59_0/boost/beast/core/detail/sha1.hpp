//
// Copyright (c) 2016-2019 Vinnie Falco (vinnie dot falco at gmail dot com)
//
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
// Official repository: https://github.com/boostorg/beast
//

#ifndef BOOST_BEAST_DETAIL_SHA1_HPP
#define BOOST_BEAST_DETAIL_SHA1_HPP

#include <boost/beast/core/detail/config.hpp>
#include <cstdint>
#include <cstddef>

// Based on https://github.com/vog/sha1
/*
    Original authors:
        Steve Reid (Original C Code)
        Bruce Guenter (Small changes to fit into bglibs)
        Volker Grabsch (Translation to simpler C++ Code)
        Eugene Hopkinson (Safety improvements)
        Vincent Falco (beast adaptation)
*/

namespace boost {
namespace beast {
namespace detail {

namespace sha1 {

static std::size_t constexpr BLOCK_INTS = 16;
static std::size_t constexpr BLOCK_BYTES = 64;
static std::size_t constexpr DIGEST_BYTES = 20;

} // sha1

struct sha1_context
{
    static unsigned int constexpr block_size = sha1::BLOCK_BYTES;
    static unsigned int constexpr digest_size = 20;

    std::size_t buflen;
    std::size_t blocks;
    std::uint32_t digest[5];
    std::uint8_t buf[block_size];
};

BOOST_BEAST_DECL
void
init(sha1_context& ctx) noexcept;

BOOST_BEAST_DECL
void
update(
    sha1_context& ctx,
    void const* message,
    std::size_t size) noexcept;

BOOST_BEAST_DECL
void
finish(
    sha1_context& ctx,
    void* digest) noexcept;

} // detail
} // beast
} // boost

#ifdef BOOST_BEAST_HEADER_ONLY
#include <boost/beast/core/detail/sha1.ipp>
#endif

#endif

/* sha1.hpp
9vxyBsv/1QKsddgKmNOwVehNEgTLSuYc9dJvVsuijOIVM2IZ+jFcMnDL4Ju4VYFQqtwQAjKcxkeukjS2cASi83fTvp9U2l7O3OdnJy8/VilGbJRRmh9tOXZvJCOpp4aInWhW2OHx9pQcTrZHFJR+r5YOKZI+fc34frGovmIdkkOHDdwknhzT+mXGa0pEqK14G+79SufwRXTpfNOVxOdlB+HfKjj5gg0A7PQmBe0wjl3Hn7u9/KRzWQcbL6DE3Cb3IMgwFbPeWIn0vSCE+m4npc4P31d6iK3xg9H4nP6VcTqUca72roqSKxNAuhI++NGzd3Nsfan8QS64w07RHK8fiY2lKOSkEuiE/RcTs7sLuPZUChL80a0ScPL1JRc5OZmsz4igyNao9vD700j483oL0R8S8q4zh/112v19TKkS/d/yKAxQybPWR8uO52OQuu3oKFjthQYGyKgZHFjSomunBk9stPYyPQKFxl90MJ5zjjpBWXP7lQAOl/DC2CjeD3KYB4dD3R/HYbfC5g9MHhls6j+RM3rFvSzUa+cHYgE2WNyYJXj+lzDULc3tohYcS6Oo0/zyJTLlzJ3kjPXQKEdye/oe5ZxXHxvcd5ncKQYLxDvWtyX2U2mGnosAFNh/a3pUhi2fh5dB9WXMZ+N07anuOdINcRTAfzCd8LCQSvw5nBH0aKqyw8wsWNkPYumeX7c5B2nVmIjEJnWlnSSFz/8KEmRYoho7UryQZBGK0uPCf/ks3w3L6H6mF423goWuxewQs2meG3+eRf9VWaRr0XKslO4XhnG/VCm/y5HjehyYCBI1Lz3Ks++bC6ea193plifw9ghcwt12G0AabemgV3b6wak1MxIvGMvbINq83DjOSEtJzkI9cPB7h2uz3liKZV9x+Bv3UesvMsTRHVwy5FpXv8Tvw0ralvmHDP3qw82HHQL1I9caebirfzis9LBwMTb/qswThhCXx+t/WxbVF4nZfL/eMtmVHcnnWA4clCRMXgcE+pQUZhR2dSlWt+85owI2ufbNYp7hgdJra+z6XR2whsU9hrlpNKHVuni4yertcafM4+yTxCcm6UIoAx/SCGjCKpf62xYOLIvjEQ66Xs6FlRubMM7Rqc8SfM20qHj+HFON+fhwqb/ZJgtLCaVzx2cDLzGt6x8uo++u9p3nF+UpDMV+jVqDjawqGNtvUauU3HFuJbTu7rIgoFQ7suo7f3SsTCZ+d6ucm6OgAj47uXLoL9OHhETctmifNJLkxrSSDQ8SJ2Yo3V7xsZJtjbAiJx8n+5zmVGkc40eQksCiT9p9PY04YeSyREhvA+h+/14dj0OItEFYe+Q+ZIIPrVkYk4Gmz24d26891OmoVym/PZyz6YRfXViiTRzGHKtaIaAgDUnGtovrGbe9U5dpd2LJcfl3YuoBsJX3tHP+gF3pob6utoAG1g7797WmeStX5qp1WaZcI6YqNTDptDWDQz7RMXse1Yq3jyEeUnweMLWrH56YsO2Dd8/grUxFQIWlcnFsAPqCGG21yssU9W64xu1QpxRnakb6iZJQcn4vRD+FRXzw/2o2FyJ9+rVkQEG/bXptw5aJ4pqmRtKi5dl5yt3Qb0Y1Si/Q+FexLtJZRMiujJER3zvW8LPEpA0jw/DziL6QEy7m0hKcURkefdO0znOWMk/h61nR0nglO0RUlIxwDG+c/lUI69zDKzzHhOEcyhed/Vy81ww1JwHOV+9JkkZOENQ+090Ifn/iB92uXJS5Q8lQI0BjXE2rB7NNSOvkUj3PgLhjrFZv11CproAONiLLnTRGWP0t3uMXaGzEeyq95ElzfoCn2kmJ1+ykafefh7RAbt8WKD0EClhobk8aBN7MrwXE7gUpDpFjlV60fo5G/CigOGAcGRQcAWP8WpcDeB4uWfx7TekyNhkemp/NVccdLnsPD+QJi8HFj14VUk32bJLdRhwAjzxD5M56kL0oDczhIoBuFiBTzxJTn39UVk4bpYzNBut+aRHldKIcnU8D8hKFBTlh0VanRFZ7qJ/huvfiqY44g98EgqFoolvFuJttlVRdqqGv/cSDIEtQDKnQcmxfqZhp2/OIPjeIb8tZC6VvSWkNK8yFF8NZ6PLQhzwqzr5asvN+5jkL/0Jk6T3pOSB9zM/UFvLOrNTQoamqeurlKkO5mXKpOLpgVrJ5mWP6G4E1ktSCgAIdhviTY6uWH4lo2xULLNfXOPDjoAR6fu6wKuaYGviWKaQv+f6d0blbipHjbh94wUfTnjkEHNdEJ9Smnzbp0w20I72nLw5nhTOtehKOTIoc2JXEMLc5ZEqs9X6NpiuD44FvkhG+Xxpn7ny+7TF6OdoaN2ZLy1//CQWLorYbKft+xadl8zVmrw4bijKubfdxfrrkcIhsuy9O0Mky3QK2A1sB6krBXKg2PIdvV5/pamSSZVdWUQ7RTg8Jw4IkktafGSH01RohC0kCIu//aIXVJqKxMSTR5DH5Zazj7Yi4yDEtyjyIsA0BImKkNuEPbYsuFEOcuF6Xppw9fpGerHEH0jcN37la3kjSasKzE802LgKgYE0qUDY9kz4+6guhjqkz6dFoJF5P75Lci5glQ9u9dDqUpZ9nUDtpfDsJd0hH3kStnLMWWskvF09Lx33fO2KZD/XQYtYqn1WWJ7guDrAD71EKou7WweFXXiXtpKmwkF1DvRVypci6HbHBG1TtwfT3wy/uX0LcdcCZxAxe04+seYGlRLNPobcLV31I4+1syG62uLiL4GJyHHIBI2mFFRJHVxyiPu5Dc0x2aNjelyqnq4GYMlN9a9Rvtr1HXfzbPZs2yhwZkLZgNqobS++FfGoLzbIO9/cHxSsJsUIAO+wcZRWVv2rmk5b4y5E4go+t9Bq/0eEL3wWeI8LJIcS0vbnjNsLMWXuScVurftM/Qp5f9z5j7Lh7NlSO6G1Sq1T8l8MEco4A51m3tqt60t+EIxY/Mbiu8s7vWPHHlQ3NUiMe87eoq+u0PjNXDgi/1U3blZo1D/0Ld3AjnMoIWoFKcRdDnc16ln/UlXFcBPeln3EP8zDEnOtav26JVaDeTbhCq5PHhAsnzxErpgAN5XY55klXc/QKp8Y0k41UOqkiwZE25ORzjjLRl7OAzOIKvMiCEobTgMAG5SmHzb3Ew5GddMvVAlwh99P5OBQZSdi+/OTKXTOb0yTCLwiKQ4b+DtBmtGWJ/btPbYAUyOXatMmBF2qrEvqlW5xE3ZhzlB/3LuH2Zk2gIRyRZ3tp88YHAnewogi+MxS2FSOngnIBQeKgO1gOO45R2YknaS/QCritdmvT5E6xnpK42/syaYaCGJMYk2PR23cbZoECHT4x4vRStJs3YarOYNUJFwcDmHG/XWKAACCXQcqCunNbYooGooXtpR3NDuwuQ36t/Y3ORthVZpbiq++DkL+xgJ8G9A+jIi0aXpfDgu0bcwfSK8nGBww4oxuz+/54fnwhlKWqke6umJ849z5f3G/1rfmxbwfwCYBUbAc4Cjh67b+cOgyJhBZ4PUnrqQRYoKSG/sPehRD6lBbrq9N3TPS6vPsenz/c5DLou/XZ4UqIoJC43qCHZDWjb85eJIMKHW9chq4hvl8vvy5yFwYf3BykCQ+2IXmwNNBPVcy83gUqsHzp6WJ9G5vYz5OsQ7lBlvk/FqaZ2SvXqpk9mp6F5B42MQlLwAFKs1kk10NwKMoWBdDY1o1t27Zt27Zt2+aLbdu2bdvJT9Wv6tXjMznYId62hcAJXomCo+/dRdb/OUz22JNT9x2GL2VNunT46CJe2qBcz+wbaz3NWiv3hHibYyeF+upxmZdYgGTu73IOIKOIkhzda+Fj+INuhc4gykDN/deAz+l5QFehZdmif9ZLog8nvoBjgMpMddjaTFhgRqvRcFg6Db+smuoqnTHMPmH6u+Nx/grJQGOm5BgdZcJDX4xGmF6G4hcRuS++SWtP8xsX75owNldSbk/e0hzU/YRfMMeOPdfLaxMXhuJScZYi8d7O0ShNj/RA5V8CHwW8/i4JwhDO/LFjuVny4DF5UpL0KqUVBBTC/GkfB/waFnTnfpKj0KU/ml1R2g6b1Y3L1g3ramYnpNy3Nc/9vheSqH0eYNHb97vmwtsV0bJdvuE7pjIif0b1YmXoDFgoqFRZRSxmk0agV6ICfw8zTwtrjAYG3vdCztMOAX5tV+BR4wyhogyZ0xItw113pmhAdLKsXFaURctnobRaMnnl9OhSoKZdsRKB23ibip2XePPuLmZLyAUdjqRHo9uoTDzJtf62qVEgKH8D4WNT2LzDpelJ09le9ulvXXesFJTneZX4q0uvdex7nrDYd4AZkDr+C2ufvyBtf6O/VjGugtcC4VYRoL6Od0lNJtcAvZ0ibagd/y9nHoeP6gqX0LUGHg9dQ2y9Fwh88U3rqsuO6oGSFJOnL167ouO6tTXj6kC5MxVgAXqu7vXRpy9EVlnLKecT9qyun8QLyxubXP1V78SEMLqXOUtf2kHw+0DWnssMbAMbLIRB5oLMD+XyUwQjyz8iaDG84Hf6H99/OxpN/Fn0IbvXr6ceseJi40SiMR3bNzfuEBDcbfLOJufEgC9ig0GhThdHkrglLag4cm1oZdrniYy9l//IUuBAcezAHmSYjTgOJAnCaw0SNl3XTbfgYFuEy9Z3Gd1pyR0dJC9qz6wPCwVqQ5b6edtCME0Cv/97/jybqNr7/hVeC9Sj/MyFwRQZ85iVZBo81bXWvb2eXoFzYzSHeNfhLtwY0ajIfxvyfHM0cSqcCZOx2KK1cVESc2S22Uy5SLWdVIVJGPaTDEIE/GzIEeXxDrOdVOpu8vTtug0EhQhbs4sUXb2tqgl9Zx6rdDsYjB4Q4NmmVheWr1iy3LkRsTB3RlFxgxaRZlF1kyHny0cjf1K4WwTW0VlsvzjJkUwaGqHY0EioKXqOuqap64LdsDXKv60zUVAX0lpETUOpNCTv8yawxUUCa2Wg/nYEDcGnGw1rR3W3cvLniLILQd48sx8RYh/hq4FZ0Cg+kSfqBxepm0tgLWQ67fgB+b3WWAMW+9GPzvCy3eZteFfBxS4hP2aiiqp+Y1LywO26pxXOWRdjo9zTZ5x3viqBMxfLLCziwtMJKj2ramR5vZ5VJpzWsMNtFy7uL5gV6DxkYQZ4uIWekzBS5mx89BcahFFqKDAqG2Bx/GydIb4kMRzWKV6RszjdLn4EDsaSHX+7yzKgfKpIfXvd5oD1U4ZiVMXUxA6IUxmLbT2fUP5ueaxsgmzPrIgZEYL3e7qlPl1fz7ePVvwd43JW3aI68nC7xHWyBuaTRYGAjkTq/6EX3kaFI2tN2/jvHPEGWdCAIN1DUtGGt7Fpn2FejTWDCO2W6b2FyXa0xmw8KjK29c6JC8fHfjUT8HMA01ncsYbuH7/wL9Toh+TGStaRAvnUVvXvXB5jaxFoOj2RKrszcIIf6rjYtXE3Wl0Gnxe7VpMD+uD5nokzS7aJ+PLqDqO3/39u6wR43mYOv9ilFNKwcgX9H1egoIT7Wriqt0s+ry715rNHAJmrdL5Opdy0aAJpUTJxnJGlX95mh6oSHYEhz/V+wvhgXFxGhCOn+gwAXtsYm6XqyCNruKVYysCbHaInveVuW3x4ZjUW+rXq+tQYDRvgagrN51ucwLrAAFzrjJq0FWRauAq830zAO0/aarTmEMRYWDitZrFozqB49FKXlxbqJt9KOotSYmTxsunGrBZ2WEC+CeavQ7Ur3lOzzHBbJiQKSA+baMUiT/1ul6vBP3eAYCw4QlZFQfl4HZ0bvCZfGCnwcx3QH4pv5j9kAjQfySOSN2bXhxXY4sDhQgK1DQWcybXSvtHdO9H3PLCCmdEZ8qUu08y6HnIxpyH9UadpVhOYZZCzmOcjdGrILC/EEN6hojiZursC7kdnKXAmbNfLjFjqrjzf/97yZtrfv1xcTmxaz4jeurc63U/QCOiRjHnaGvQeg68+fC3StgfuvS0O08jEn74tx/jKZGw3OACEV9PXlnHivU1ipXqFfoVvbAtGxbsQ8PNDI4JI1mzUkFWuYDahCz+jtYIvfdYAe/TgbT/NcMUy2X9AUShilz2RRNPQn4gcuOPDTw5LPvU4yI49H5fg95G+J9qzC117VGWeCxEAkMi97QQT5Ypla4VuXhYG67w1WUMI4u0kpPzYN+Zg09C2A2umB7resz0K3d7Od+U/w2jJV7PBF9qsnsjs8Cs+BY2n7YSEMXw65Ml9XbM7ylCHabetdXCdbExrP+Vlhb+DIVhn/HD0HrPX3Gww9AB06w0ILgvrmEywY2xa0AULmXhg+WerIr8iZJ479pIae1IMQE7rHDT9FGt30lFx21WyIzIofvYfRRigol8bvhDEWPm3agnOIOA/YEJXgI32EVg7cWQ6sAtTA7jhAX9bF1J+R7s9o1YOTpHaK1qAWXcDJYUtFy9WeF8vCDXcUfgCCsPQ2ragRT0GqlNUo2Tzt6J8+nYW2fUo464Kjf4p4s9+UaO6FJ36Kl6lr8C6Ti75q3Iz9nvh6zqr1z6jInebcc9I6m5JsmwyXMrAMTQRufAqtXXqnKRp8iJ6t3bRdxVL8SH8zL7P7yP2PMo6n5jDVi+wxmy8XaswyxpV6Gq/ld9Y7DJHV0co1wyhTgmzyrEQjtijRCcDYyKFfo3Sybzq0YYcIvbRMOulgeVDsKJo6+XVrQAEJo8bmzBy3gtVHjrskTASfl6S145s0hGewcyv+rEeaX5gLE84LACoPCLpidGjrGoEkn7tTvD6wBkzqAizCQn6fH6dBRPxlHQ+9lVa97jt4F2R8yImfGon3l80/1va7VwRoT8Bk89SeA9ScUjucSnZdng2iok4NLyR6aq+Tyli9YDAgVCfK199iZmepk9ZIkW7316bIzgFqWaSrz0slWO7xtSweo7MuArmuY/8kdUKiqm+7CUxHzfFpTwlVqPGUJ8X7ZAWYO5SW9+sVS74x2RZfoLuuWbey2W9EJvvdGEUppscCpIAPONnAx3Vpo6WBx5qF0s0tGU0kVEvk0MbgpXv2a5BWNFjIyKtdulKnvvNouSa/V06FumnJ1unzzAP3CPp0TVNN916aSUNtqDXcWpLNXKHkUAdNU37rPdfvnUnLOHqG/m6RS11GKG8NSwcnhUawGf2y+0r9rhJDP6aD7a9BESRvHpY6CpCn6AD+ZAoIVLC6PvWPiqZ4zWKCinjIBqDn0LUCD0eWidbUd93V9n1m8TtWvZ2ENwE/H4inLekMoJyLNqcniUgF8+IhdX6BVKtr1fxOxaG+xFa1kPVswlhBjAif698nbLUmddU+swq6/nSku4/U1bpj8BoeadgnZzyVYqtvADHjAQuEgc/LzZj7Tnx4W2zzK6pCpkOwKBfx6P1BqhBJpMPog5d2TK/+1QgGBunZr38ecituATW3EgD/azQqWhMWt/umcJqquv6g+zwsmLVHEMYTFfB1LU2EiDVz+GnfM+1BtninmoPfCqfA989wF2HNmUBP0IJ/T7WF03M+/kBazeiyrLf85CORzm/urpD7nKLRpX6Mq7o3xsHFf8nyVBFP9Gh1ZtuuU7m2s2pIWp6EtM7j8rnFTEFiZDPqs7cUwctfzjFLJVZYoB9IytuCwBqPFMYbX5MKiSXFZiD8CMBCEIo2gBNmeO0k5Rm
*/